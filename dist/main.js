!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=7)}([function(t,e,n){"use strict";async function r(t="HIP.json"){try{let e=[];const n=await fetch(`./src/${t}`);try{if(e=await n.json(),0==risks.length)for(let t=0;t<e.length;t++)for(let n=0;n<e[t].values.length;n++)"risk"==e[t].values[n].type&&(risks[e[t].values[n].name]=e[t].values[n].value)}catch(t){console.error(`Parsing risks json failed: ${t}`)}}catch(t){console.error(`Risks loading failed: ${t}`)}}function s(t,e){let n=[],r=[],s=[],o=e.length,a=o-1,l=a-1;if(o<2)return!1;if(o<3)return r[0]=(e[1][1]-e[0][1])/(e[1][0]-e[0][0]),n[0]=0,s[0]=0,r[1]=r[0],n[1]=0,s[1]=0,MB[t]=r,MC[t]=n,void(MD[t]=s);s[0]=e[1][0]-e[0][0],n[1]=(e[1][1]-e[0][1])/s[0];for(let t=1;t<l+1;t++)s[t]=e[t+1][0]-e[t][0],r[t]=2*(s[t-1]+s[t]),n[t+1]=(e[t+1][1]-e[t][1])/s[t],n[t]=n[t+1]-n[t];if(r[0]=-s[0],r[a]=-s[a-1],n[0]=0,n[a]=0,3==o){for(let t=1;t<a+1;t++){let e=s[t-1]/r[t-1];r[t]=r[t]-e*s[t-1],n[t]=n[t]-e*n[t-1]}n[a]=n[a]/r[a];for(let t=1;t<a+1;i++){let e=a-t;n[e]=(n[e]-s[e]*n[e+1])/r[e]}r[a]=(e[a][1]-e[l][1])/s[l]+s[l]*(n[l]+2*n[a]);for(let t=0;t<l+1;t++)r[t]=(e[t+1][1]-e[t][1])/s[t]-s[t]*(n[t+1]+2*n[t]),s[t]=(n[t+1]-n[t])/s[t],n[t]=3*n[t];n[a]=3*n[a],s[a]=s[a-1],MB[t]=r,MC[t]=n,MD[t]=s}else{n[0]=n[2]/(e[3][0]-e[1][0])-n[1]/(e[2][0]-e[0][0]),n[a]=n[a-1]/(e[a][0]-e[a-2][0])-n[a-2]/(e[a-1][0]-e[a-3][0]),n[0]=n[0]*Math.pow(s[0],2)/(e[3][0]-e[0][0]),n[a]=-n[a]*Math.pow(s[a-1],2)/(e[a][0]-e[a-3][0]);for(let t=1;t<a+1;t++){let e=s[t-1]/r[t-1];r[t]=r[t]-e*s[t-1],n[t]=n[t]-e*n[t-1]}n[a]=n[a]/r[a];for(let t=1;t<a+1;t++){let e=a-t;n[e]=(n[e]-s[e]*n[e+1])/r[e]}r[a]=(e[a][1]-e[l][1])/s[l]+s[l]*(n[l]+2*n[a]);for(let t=0;t<l+1;t++)r[t]=(e[t+1][1]-e[t][1])/s[t]-s[t]*(n[t+1]+2*n[t]),s[t]=(n[t+1]-n[t])/s[t],n[t]=3*n[t];n[a]=3*n[a],s[a]=s[a-1],MB[t]=r,MC[t]=n,MD[t]=s}}function o(t,e,n){if(isNaN(t)||void 0===t)return console.error("Ошибка в вычислениях, необходимо обратиться к разработчику"),1;if(t>e[e.length-1][0])return alert("Стоимость превышает максимальное значение графика. Значение коэффициента взято с последней точки"),e[e.length-1][1];let i=e.length-1,r=0;if(r>=i+1&&(r=0),e[r][0]>t){r=0;let s,o=i+1;do{s=Math.round((r+o)/2),t<e[s][0]&&(o=s),t>=e[s][0]&&(r=s)}while(o>r+1);let a=t-e[r][0];return e[r][1]+a*(MB[n][r]+a*(MC[n][r]+a*MD[n][r]))}if(t<=e[r+1][0]){let i=t-e[r][0];return e[r][1]+i*(MB[n][r]+i*(MC[n][r]+i*MD[n][r]))}{r=0;let s,o=i+1;do{s=Math.round((r+o)/2),t<e[s][0]&&(o=s),t>=e[s][0]&&(r=s)}while(o>r+1);let a=t-e[r][0],l=e[r][1]+a*(MB[n][r]+a*(MC[n][r]+a*MD[n][r]));if(!function(t,n){let i=e[n][1],r=e[n+1][1];i>r&&([i,r]=[r,i]);return t>i&&t<r}(l,r)){const n=e[r+1][1]-e[r][1];l=(t-e[r][0])/(e[r+1][0]-e[r][0])*n+e[r][1]}return l}}function a(t,e){return e<t?1-Math.pow(e/t,.5):e>=t?0:void 0}function l(t){let e=[];for(let n in t)e.push(t[n]);let n=e.length;for(let t=0;t<n-1;t++)for(let i=0;i<n-1-t;i++)if(e[i+1][0]<e[i][0]){let t=e[i+1];e[i+1]=e[i],e[i]=t}return e}function c(t,e){return Math.pow(e/t,1/koef_pow)}function u(t){return!isNaN(parseFloat(t))&&isFinite(t)}function h(t){let e=(t+="").split("."),n=e[0],i=e.length>1?"."+e[1]:"",r=/(\d+)(\d{3})/;for(;r.test(n);)n=n.replace(r,"$1 $2");return n+i}function f(t){return parseInt(t.split(" ").join(""))}function d(t=100){return new Promise((e,n)=>{setTimeout(e,t)})}function p(t){let e=t.getDate(),n=t.getMonth()+1;return e<10&&(e=`0${e}`),n<10&&(n=`0${n}`),`${e}.${n}.${t.getFullYear()}`}function $(t){let e;switch(t){case"/profile":e="Карту компании";break;case"/calculation":e="Расчет";break;case"/":e="Основное меню";break;case"/polis":e="Проект документа";break;case"/company":e="Редактор карты клиента";break;default:console.error(`Неописанный случай, $location.path = ${t}`),e="прошлую вкладку"}return e}n.r(e),n.d(e,"loadRisks",function(){return r}),n.d(e,"SplineKoeff",function(){return s}),n.d(e,"Spline",function(){return o}),n.d(e,"Franchise",function(){return a}),n.d(e,"BubbleSort",function(){return l}),n.d(e,"Limit",function(){return c}),n.d(e,"isNumeric",function(){return u}),n.d(e,"addSpaces",function(){return h}),n.d(e,"intFromStr",function(){return f}),n.d(e,"delay",function(){return d}),n.d(e,"parseDate",function(){return p}),n.d(e,"getPathName",function(){return $}),window.Points={cost:[],amount:[],risk:[],payment:[]},window.MB=[[],[]],window.MC=[[],[]],window.MD=[[],[]],window.risks=[],window.koef_pow=null,window.BASENAME="CMR/TTH пакет",window.OLDBASENAMES=["Базовые риски"],async function(){(function(t){let e=t;for(let t=0;t<e.length;t++)1*e[t].number==1?Points.amount.push([1*e[t].x,1*e[t].y]):1*e[t].number==2?Points.cost.push([1*e[t].x,1*e[t].y]):1*e[t].number==3?Points.risk.push([1*e[t].x,1*e[t].y]):1*e[t].number==4?Points.payment.push([1*e[t].x,1*e[t].y]):1*e[t].number==999&&(koef_pow=1*e[t].x);s(0,Points.amount),s(1,Points.cost),s(2,Points.risk),s(3,Points.payment)})(await async function(){try{let t=await fetch("php/loadPoints.php");return t=await t.json()}catch(t){alert("Проблемы с загрузкой базы данных. Работа в тестовом режиме. Обратитесь к разработчику"),console.error(t);let e=await fetch("./src/fakeResponse.json");return e=await e.json()}}()),r()}()},function(t,e,n){"use strict";n.r(e),n.d(e,"Multi",function(){return r}),n.d(e,"Process",function(){return s}),n.d(e,"Park",function(){return o});var i=n(0);window.transportProp=["cost","amount","wrapping","risk","limit","franchise"],window.qwerty=["Q","W","E","R","T","Y","U","I","O","P"],window.TRACTOR=24,window.LimKoef=1,window.totalAmount=0;class r{constructor(t,e,n){let i=this;this.show=!1,this.processes=[],t.forEach(function(t){i.processes.push(t),t.multi=i}),e&&(this.packName=e,this.template=n),this.getValues()}removePackage(){if(this.packName){this.processes.filter(t=>t.package==this.packName).forEach(function(t){t.remove()})}}prepareForPackage(){this.processes.forEach(t=>{t.risk==BASENAME&&t.remove()});let t=[];this.template.forEach(e=>t.push(e.risk)),this.processes.filter(e=>-1!=t.indexOf(e.risk)).forEach(t=>t.remove())}getValues(){let t=[],e=[],n=[],i=[],r=[],s=[];if(this.processes.forEach(function(o,a){-1==t.indexOf(o.wrapping)&&t.push(o.wrapping),-1==e.indexOf(o.risk)&&e.push(o.risk),(!o.package||o.package&&0==a)&&(n.push(o.limit),i.push(o.franchise),r.push(o.cost),s.push(o.amount))}),1==r.length)this.cost=r[0];else{let t=r[0],e=r[0];for(let n=0;n<r.length;n++)r[n]>e&&(e=r[n]),r[n]<t&&(t=r[n]);this.cost=t==e?t:t+"-"+e}if(1==s.length)this.amount=s[0];else{let t=s[0],e=s[0];for(let n=0;n<s.length;n++)s[n]>e&&(e=s[n]),s[n]<t&&(t=s[n]);this.amount=t==e?t:t+"-"+e}if(this.wrapping=t,this.risk=e,1==n.length)this.limit=n[0];else{let t=n[0],e=n[0];for(let i=0;i<n.length;i++)n[i]>e&&(e=n[i]),n[i]<t&&(t=n[i]);this.limit=t==e?t:t+"-"+e}if(1==i.length)this.franchise=i[0];else{let t=i[0],e=i[0];for(let n=0;n<i.length;n++)i[n]>e&&(e=i[n]),i[n]<t&&(t=i[n]);this.franchise=t==e?t:t+"-"+e}if(this.packName){let t=[BASENAME];this.template.forEach(function(e){t.push(e.risk)});for(let e=0;e<t.length;e++)this.risk.splice(this.risk.indexOf(t[e]),1);this.risk.push(this.packName)}}calculatePrice(){this.getValues();let t=0;this.processes.forEach(function(e){t+=e.totalPrice}),this.price=t}open(t,e){!function(){const t=document.querySelector(".matrix_table .mi_selected");null!==t&&t.classList.toggle("mi_selected");document.querySelectorAll(".matrix_table .alreadySelected").forEach(t=>t.classList.toggle("alreadySelected"))}(),function(e){if((()=>{let t=!0;return 1===this.risk.length&&this.wrapping.length>1&&("Международные"===this.risk[0]||"Внутренние"===this.risk[0]||"Автомотив"===this.risk[0])||(this.risk.length>1&&this.wrapping.length>1&&this.processes.length===this.risk.length*this.wrapping.length||(t=!1),this.risk.forEach(n=>{"string"!=typeof n&&(t=!1);const i=this.processes.filter(t=>t[e]===n);i.lenght!==this.risk.lenght&&(t=!1)}),this.wrapping.forEach(n=>{"string"!=typeof n&&(t=!1);const i=this.processes.filter(t=>t[e]===n);i.lenght!==this.wrapping.lenght&&(t=!1)}),this.processes.forEach(n=>{n.oldMulti&&n.oldMulti.distructedByKey===e&&(t=!1)}),t)})()){const n=[];this.processes.forEach(t=>{n.includes(t[e])||n.push(t[e])});const i=[];n.forEach(t=>{this.processes.forEach(n=>{n[e]===t&&i.push(n)})});const s=this.processes[0].park.processes,o=[];return s.forEach((t,e)=>{i.includes(t)&&o.push(e)}),i.forEach((t,e)=>{s.splice(o[e],1,t)}),this.processes=i,n.forEach(n=>{const i=this.processes.filter(t=>t[e]===n);i.forEach(n=>{n.oldMulti&&n.oldMulti.distructedByKey!==e&&(t.includes(n.oldMulti)&&t.splice(t.indexOf(n.oldMulti),1),delete n.oldMulti)});const s=new r(i);let o=this.processes.indexOf(i[0]);i.forEach(t=>{this.processes.splice(this.processes.indexOf(t),1)}),s.multi=this,s.parent=this,s.show=!1,s.distructedByKey=e,this.processes.splice(o,0,s),t.push(s)}),!0}return!1}.call(this,e)||function(){const t=[];this.processes.forEach(e=>{e.oldMulti&&(e.oldMulti.processes.push(e),t.push(e),e.multi=e.oldMulti,delete e.oldMulti)}),t.forEach(t=>{const e=this.processes.indexOf(t);this.processes.splice(e,1),this.processes.includes(t.multi)||this.processes.splice(e,0,t.multi)})}.call(this),this.show=!0,t.forEach(t=>t.getValues())}close(t,e,n,i){if(i.removeCellSelection(),this.processes.forEach(t=>{"Multi"===t.constructor.name&&(e=!0)}),e){const t=[];this.processes.forEach((e,n)=>{"Multi"===e.constructor.name?(e.show=!1,e.processes.map((n,i)=>{n.oldMulti=e,n.multi=this,t.push(n)}),e.processes.splice(0,e.processes.length)):t.push(e)}),this.processes=t}this.show=!1,this.calculatePrice()}changeProperty(t,e){let n=this;this.processes.forEach(function(i){if(i.package)if(void 0===n.parent){if(!n.template)return i[t]=e,!0;let r=n.template.filter(function(t){return t.risk==i.risk});r=r[0];let s=!1;for(let n in r)n==t&&(i[t]=r[n]*e,s=!0);s||(i[t]=e)}else{const i=n.parent;delete i.packName,delete i.template,i.processes.forEach(t=>{t.processes.forEach(t=>delete t.package)}),n.processes.forEach(n=>n[t]=e)}else i[t]=e})}}class s{constructor(t,e){for(let e in t)this[e]="practicalPriceKoef"!==e?t[e]:0,"multi"===e&&(this[e]=void 0);e&&(this.multi=e)}calculateBase(){this.totalPrice=0;for(let t=0;t<transportProp.length;t++)if(void 0===this[transportProp[t]])return console.log("Объект не полный, не хватает свойства "+transportProp[t]),!1;const t=this.park.calculateAmount();let e;this.risk===BASENAME&&t!=this.amount&&(e=this.amount,this.amount=t),this.turnover=this.cost*this.amount;let n=Object(i.Spline)(this.cost,Points.cost,1)*(1+Object(i.Spline)(totalAmount,Points.amount,0)/100);if(n*=Object(i.Franchise)(this.cost,this.franchise),this.cost>=this.limit?n*=Object(i.Limit)(this.limit*this.park.amount*(1+(this.cost-this.limit)/this.limit),this.limit):n*=Object(i.Limit)(this.cost*this.park.amount*(1+(this.limit-this.cost)/this.limit),this.limit),this.baseRate=n,this.basePrice=this.turnover*n/100,-1!=this.park.wrappings.indexOf(this.wrapping)&&(this.park.wrappings.splice(this.park.wrappings.indexOf(this.wrapping),1),this.risk!=BASENAME)){let t=Object(i.Spline)(risks[this.wrapping]*this.park.riskKoef/2,Points.risk,2);this.totalPrice+=this.turnover*(this.baseRate*t/100)/100}const r=risks[this.wrapping]*this.park.riskKoef*(()=>{const t=this.park.processes.length;if(1===this.park.processes.length)return 1;const e=(()=>{const e=this.park.processes.reduce((t,e)=>t+e.limit,0);return t*(this.limit/e)})(),n=(()=>{let e=!0;if(this.park.processes.forEach(t=>{t.franchise!==this.park.processes[0].franchise&&(e=!1)}),e)return 1;const n=this.park.processes.reduce((t,e)=>t+e.franchise,0),i=1-this.franchise/n,r=this.park.processes.reduce((t,e)=>t+(1-e.franchise/n),0);return t*i/r})();return 1===e||1===n?e*n:e*n/2})();n*=1+Object(i.Spline)((r+risks[this.risk])/2,Points.risk,2)/100,this.riskRate=n,this.riskPrice=this.turnover*n/100,this.basePrice>this.park.base?(this.totalPrice+=this.riskPrice-this.park.base,this.park.base=this.basePrice):this.totalPrice+=this.riskPrice-this.basePrice,e&&(this.amount=e)}remove(){this.multi&&"deleted"!==this.multi&&this.multi.processes.splice(this.multi.processes.indexOf(this),1),-1!==this.park.processes.indexOf(this)&&this.park.processes.splice(this.park.processes.indexOf(this),1)}}class o{constructor(t){Array.isArray(t)?(this.processes=t,t=t[0],this.processes.forEach((t,e)=>{0!==e&&(t.park=this)})):this.processes=[t],"Process"==t.constructor.name&&(this.cost=t.cost,this.amount=t.amount,this.wrappings=[t.wrapping],this.risks=[t.risk],this.limit=t.limit,this.franchise=t.franchise,this.base=t.basePrice,this.show=!0,t.park=this)}copyPark(){let t=function t(e){let n=[];e.forEach(e=>{"Multi"!==e.constructor.name?n.push(e):t(e.processes)});let i=[];n.forEach(t=>{if(t.multi&&"deleted"!==t.multi){let e=new s(t);e.multi="create",i.push(e)}else i.push(new s(t))});return i}(this.processes);return{mass:t,park:new o(t[0])}}changeProperty(t,e,n){void 0===n&&(n=this.processes),n.forEach(function(n){if(n[t]=e,n.package)if("wrapping"!=t&&"risk"!=t){let i=n.multi.template.filter(function(t){return t.risk==n.risk});i=i[0];let r=!1;for(let s in i)s==t&&(n[t]=i[s]*e,r=!0);r||(n[t]=e)}else if("risk"==t){n.multi.processes.filter(function(t){return t.package==n.package}).forEach(function(t){delete t.package});let t=n.multi;t.processes.forEach(function(t){t.multi="deleted"}),t.processes=[]}})}getValues(){let t=[],e=[],n=[],i=[],r=[],s=[],o=0;if(this.processes.forEach(function(a,l){o+=a.totalPrice,-1==t.indexOf(a.wrapping)&&t.push(a.wrapping),-1==e.indexOf(a.risk)&&e.push(a.risk),(!a.package||a.package&&0==l)&&(n.push(a.limit),i.push(a.franchise),r.push(a.cost),s.push(a.amount))}),1==r.length)this.cost=r[0];else{let t=r[0],e=r[0];for(let n=0;n<r.length;n++)r[n]>e&&(e=r[n]),r[n]<t&&(t=r[n]);this.cost=t==e?t:t+"-"+e}if(1==s.length)this.amount=s[0];else{let t=s[0],e=s[0];for(let n=0;n<s.length;n++)s[n]>e&&(e=s[n]),s[n]<t&&(t=s[n]);this.amount=t==e?t:t+"-"+e}if(this.wrapping=t,this.risk=e,1==n.length)this.limit=n[0];else{let t=n[0],e=n[0];for(let i=0;i<n.length;i++)n[i]>e&&(e=n[i]),n[i]<t&&(t=n[i]);this.limit=t==e?t:t+"-"+e}if(1==i.length)this.franchise=i[0];else{let t=i[0],e=i[0];for(let n=0;n<i.length;n++)i[n]>e&&(e=i[n]),i[n]<t&&(t=i[n]);this.franchise=t==e?t:t+"-"+e}this.price=o}findMaxLimit(){let t=0;return this.processes.forEach(function(e){t=Math.max(e.limit,t)}),t}calculateAmount(){let t=0;return this.processes.forEach(function(e){t=Math.max(e.amount,t)}),this.amount=t,t}clear(){this.risks=[],this.wrappings=[],this.base=0,this.riskKoef=0}replaceBase(){if(0==this.processes.length)return!1;let t;if(this.processes[0].risk!=BASENAME)for(let e=0;e<this.processes.length;e++){if(this.processes[e].risk==BASENAME)return t=this.processes.splice(e,1),this.processes.splice(0,0,t[0]),!1}}check(t){this.clear();let e={},n=[],i=0,r=0,o=0,a=this.processes.filter(function(t){return void 0!==t.multi}),l=this;const c=l.calculateAmount();l.processes.map(t=>{t.risk===BASENAME&&(t.writtenAmount=t.amount,t.amount=c)}),a.forEach(function(t){-1==l.risks.indexOf(t.risk)&&l.risks.push(t.risk),e.hasOwnProperty(t.wrapping)?e.hasOwnProperty(t.wrapping)&&e[t.wrapping]<t.amount&&(e[t.wrapping]=t.amount):e[t.wrapping]=t.amount,i+=t.amount*risks[t.wrapping],r+=t.amount,o+=risks[t.wrapping],-1==l.wrappings.indexOf(t.wrapping)&&l.wrappings.push(t.wrapping)});for(let t=0;t<this.processes.length;t++)delete this.processes[t].changing,void 0===this.processes[t].multi&&(-1==this.risks.indexOf(this.processes[t].risk)?(this.risks.push(this.processes[t].risk),e.hasOwnProperty(this.processes[t].wrapping)?e.hasOwnProperty(this.processes[t].wrapping)&&e[this.processes[t].wrapping]<this.processes[t].amount&&(e[this.processes[t].wrapping]=this.processes[t].amount):e[this.processes[t].wrapping]=this.processes[t].amount,i+=this.processes[t].amount*risks[this.processes[t].wrapping],r+=this.processes[t].amount,o+=risks[this.processes[t].wrapping]):(n.push(new s(this.processes.splice(t,1)[0])),t>0&&t--),-1==this.wrappings.indexOf(this.processes[t].wrapping)&&this.wrappings.push(this.processes[t].wrapping));for(let t in e){let n=!0;this.processes.forEach(function(e){e.wrapping==t&&e.risk==BASENAME&&(n=!1)}),n&&(o+=risks[t],r+=e[t],i+=risks[t]*e[t])}this.riskKoef=0==r||0==o?0:i/(r*o);const u=this.processes.reduce((t,e)=>t+e.amount,0),h=this.processes.reduce((t,e)=>{return t+risks[e.wrapping]},0),f=this.processes.reduce((t,e)=>{const n=risks[e.wrapping];return t+e.amount*n},0);return this.newRiskKoef=0===h?0:f/(u*this.risks.length),void 0===t&&-1==this.risks.indexOf(BASENAME)&&1==this.processes.length&&(n=this.processes,this.processes=[]),l.processes.map(t=>{t.risk===BASENAME&&(t.amount=t.writtenAmount,delete t.writtenAmount)}),n}cutDownLimits(t){this.processes.forEach(function(e){if(e.limit>t&&(e.limit=t,e.package)){e.multi.processes.filter(function(t){return t.package==e.package}).forEach(function(t){delete t.package}),delete e.multi.packName,delete e.multi.template}})}calculateMatrixWithAlimit(t,e){let n=0;return this.processes.forEach(function(i){let r=i.cost,s=i.limit;e?i.limit*=.33*t:(i.cost<t&&(i.cost=t),i.limit=t),i.calculateBase(),n+=1*i.totalPrice,i.cost=r,i.limit=s,i.calculateBase()}),n}applyKoef(t){this.processes.forEach(function(e){e.totalPrice*=t})}applyPracticalPriceKoef(t){this.processes.forEach(function(e){"number"==typeof e.loadedPrice&&"load"===t&&(0!==e.loadedPrice?e.practicalPriceKoef=e.loadedPrice/e.totalPrice:e.practicalPriceKoef=0,delete e.loadedPrice),void 0!==e.practicalPriceKoef&&(e.totalPrice*=e.practicalPriceKoef)})}calculate(){this.processes.forEach(function(t){t.calculateBase(),t.multi&&"deleted"!=t.multi&&1==t.multi.processes.length&&delete t.multi})}getTotal(){let t=0;return this.processes.forEach(function(e){t+=e.totalPrice}),t}contains(t){let e=!1;const n=[];return this.processes.map(e=>{t.includes(e)||n.push(`${e.risk}-${e.wrapping}`)}),t.map(t=>{const i=`${t.risk}-${t.wrapping}`;n.includes(i)&&(e=!0)}),e}}},function(t,e,n){"use strict";n.d(e,"a",function(){return i});class i{constructor(){this.id=null,this.card=null,this.responses={},this.isLoaded=!1,this.isSaved=!1,this.links=null,this.name=null,this.factory=null,this._isFull=null}parseFromCompaniesResponse(t){this.id=t.id,this.responses.card=t,this.name=t.name,this.info={Communications:t.Communications,company_group:t.company_group,company_mail:t.company_mail,company_phone:t.company_phone,"company_url:":t.company_url,status:t.status}}markAsLoaded(){this.isLoaded=!0,this.isSaved=!0}savedAs({id:t,card:e,savedObj:n}){this.isSaved=!0,this.id=t,this.card=e,this.name=e["Данные компании"]["Наименование организации"],delete n.type,this.responses.card=n}set isFull(t){this._isFull=t}get isFull(){return this._isFull=this.getFullness(),this._isFull}getFullness(){const t=this.card;for(let e in t){const n=t[e];for(let t in n){if(""===n[t])return!1}}return!0}}},function(t,e,n){"use strict";n.d(e,"a",function(){return i});class i{constructor(t){this.div=document.querySelector("#loading_modal"),t&&this.show()}show(){this.div&&(this.div.style.display="block")}hide(){this.div&&(this.div.style.display="none")}}},function(t,e,n){"use strict";n.d(e,"a",function(){return i});class i{constructor(t){this.id=null,this.name=null,this.date=null,this.factory=t||null,this.companyID=null,this.links=null,this.isSaved=!1,this.isLoaded=!1,this.isLinked=!1,this.isInited=!0}parseFromMyFactory(t){this.name=t.calculationName,this.factory=t,t.calcObj=this}markAsLoaded(){this.isSaved=!0,this.isLoaded=!0}parseFromResponse(t){this.id=t.id,this.date=t.date,this.name=this.name||t.name,this.companyID=t.companyID||null}isEmpty(){return 0===this.factory.parks.length}refreshName(){this.name=this.factory.calculationName}async loadLink(){const t=await this.factory.loadLinks("calc_id",this.id);await this.bindLink(t)}bindLink(t){t.length&&(this.isLinked=t.length>0,this.links=t.length>0?t:null)}}},function(t,e,n){"use strict";function i(t){return{"Данные компании":{"Форма организации":r(t.OrganizationFormID),"Наименование организации":t.name,"Дата регистрации":s(t.registration_date),"Наименование рег. органа":t.who_registrate},"Генеральный директор":{"ФИО директора":t.director_name,"Серия и номер паспорта":t.general_director_passport,"Когда выдан":s(t.give_date),"Кем выдан":t.director_authority},"Продолжение":{"Место рождения":t.director_birth_place,"Адрес регистрации":t.director_address},"Реквизиты компании":{"ОГРН":t.OGRN,"ИНН":t.INN,"КПП":t.KPP,"ОКПО":t.OKPO,"ОКВЭД":t.OKVED},"Банковские реквизиты":{"р/счет":t.r_account,"к/счет":t.k_account,"Банк":t.bank,"БИК":t.bik},"Доп. информация":{"Телефон":t.company_phone,"Эл. почта":t.company_mail,"Юридический адрес":t.Legal_address,"Фактический адрес":t.Real_address}}}function r(t){if("0"===t)return"";return{1:"ЗАО",2:"ООО",3:"ОАО",4:"ИП"}[+t]}function s(t){return"0000-00-00"===t?"":t}n.d(e,"a",function(){return i})},function(t,e,n){"use strict";n.r(e),n.d(e,"PolisMaker",function(){return c});var i=n(0);const r=[!1,!1,!1,!1],s={text:"",border:[!1,!1,!1,!1]},o="№ HIP-0000000-00-17",a=10.5,l=a+1.5;class c{constructor(){this.carsTables=[],this.includedRisksOrder=new Set,Set.prototype._indexOf=function(t){return[...this].indexOf(t)},this.isOneCarGroup=!1,this.hipName=o}makeCarLists(t){let e=[];return t.parks.forEach((t,n)=>{t.processes.forEach((n,i)=>{let r,s=null;for(let r=0;r<i;r++)if(this.areEquivalent(n.cars,t.processes[r].cars)){s=e.findIndex(e=>e.processes.includes(t.processes[r]));break}0==i||null===s?(e.push({cars:n.cars,processes:[n],risks:[n.risk],wrappings:[n.wrapping],group:e.length}),r=e.length-1):(function(t,e){const n=["cost","franchise","limit","risk","turnover"];return t.some(t=>n.every(n=>t[n]===e[n]))}(e[s].processes,n)||(e[s].processes.push(n),e[s].risks.push(n.risk)),e[s].wrappings.includes(n.wrapping)||e[s].wrappings.push(n.wrapping),r=s),n.cars.forEach(t=>{t.tableGroup||(t.tableGroup=[r]),t.tableGroup.includes(r)||t.tableGroup.push(r),t.wrappings||(t.wrappings=[n.wrapping]),t.wrappings.includes(n.wrapping)||t.wrappings.push(n.wrapping)}),n.isFull&&(e[r].isFull=!0,e[r].groups=n.cars[0].tableGroup)})}),e}areEquivalent(t,e){if(t.length!==e.length)return!1;for(const n of t)if(!e.includes(n))return!1;return!0}makeTables(t){this.carsTables=[];const e=this.makeCarLists(t);this.isOneCarGroup=1===e.length;const n=[];let i=1;const o=["risk","cost","limit","franchise"],c=()=>o.length,u=t=>{const e=[];for(let n=0;n<t;n++)e.push(s);return e},h={group:0,risk:257,cost:81,amount:0,wrapping:0,limit:60,franchise:60},f=[];for(let t=0;t<o.length;t++){const e=o[t];f.push(h[e])}let d={style:"table",table:{headerRows:1,widths:f,body:[[{text:"Таблица 1 - Условия страхования",border:r,colSpan:c(),alignment:"left",fontSize:l},...u(c()-1)],[{text:"Застрахованные риски,\n согласно п. 1.1",style:"firstHeader",border:r,fontSize:l},{text:"Страховая стоимость, руб.",style:"firstHeader",border:r,fontSize:l},{text:"Лимит по случаю, руб.",style:"firstHeader",border:r,fontSize:l},{text:"Франшиза по случаю, руб.",style:"firstHeader",border:r,fontSize:l}]]}};return this.isOneCarGroup?d.layout={fillColor:function(t,e){return t%2==1&&t>2?"#e6e6e6":null}}:d.layout={fillColor:function(t,e){const n=e.table.body[t][0].text;return/Набор рисков \d+/.test(n)?"#e6e6e6":null}},e.forEach((e,n)=>{const s=n+1;let h=d.table.body;this.isOneCarGroup||h.push([{text:`Набор рисков ${s}:`,border:r,colSpan:c(),alignment:"left",bold:!0,fontSize:a},...u(c()-1)]);const f=t=>{const e=[0,0,0,0],n=e;return["Повреждение товарных автомобилей","Противоправные действия третьих лиц"].includes(t)?e:n};if(e.processes.forEach((n,i)=>{const a=[],c=f(n.risk),u=f(n.wrapping),d=f("");this.includedRisksOrder.add(n.risk),o.forEach((i,o)=>{let h;switch(i){case"amount":h="Тягачей"==t.amountType?{text:`${n[i]/24}`,margin:d,fontSize:l}:{text:`${n[i]}`,margin:d,fontSize:l};break;case"cost":case"limit":case"franchise":h={text:this.addSpaces(n[i]),margin:d,fontSize:l};break;case"risk":h={text:`"${n[i]}"`,margin:c,alignment:"left",fontSize:l};break;case"group":h={text:`${s}`,margin:d,fontSize:l};break;case"wrapping":h={text:e.wrappings.join(", "),margin:u,fontSize:l};break;default:h={text:n[i],margin:d,fontSize:l}}h.border=r,a.push(h)}),h.push(a)}),e.isFull){this.carsTables.push("\n");const t=this.isOneCarGroup?5:6,n=this.isOneCarGroup?"Список транспортных средств":`Список транспортных средств №${i} - Набор рисков: ${e.groups.map(t=>t+1).join(", ")}`,s=this.isOneCarGroup?[44,88,121,58,149]:[34,68,121,48,129,60],o=[{text:"п/п",style:"firstHeader",fontSize:a},{text:"Гос. знак",style:"firstHeader",fontSize:a},{text:"VIN",style:"firstHeader",fontSize:a},{text:"Год",style:"firstHeader",fontSize:a},{text:"Тип грузового отсека",style:"firstHeader",fontSize:a}];this.isOneCarGroup||o.push({text:"Набор рисков*",style:"firstHeader",fontSize:a});const l=(t,e)=>{const n=[{text:e+1,style:"carInfo"},{text:t.data.autNumber,style:"carInfo"},{text:t.data.VIN,style:"carInfo"},{text:t.data.prodYear,style:"carInfo"},{text:t.wrappings.join(", "),style:"carInfo"}];return this.isOneCarGroup||n.push({text:t.tableGroup.map(t=>t+1).join(", "),style:"carInfo"}),n},c={style:"table",table:{headerRows:2,widths:s,body:[[{text:n,border:r,colSpan:t,alignment:"left",fontSize:a},...u(t-1)],o]}},h=c.table.body;e.cars.forEach((t,e)=>{h.push(l(t,e))}),this.carsTables.push(c),i++}}),this.isOneCarGroup||this.carsTables.push({text:"* Транспортные средства застрахованы на условиях и рисках, соответствующих указанным наборам рисков в Таблице 1.",bold:!1,alignment:"justify",fontSize:10}),n.push(d),n.push({text:"Совокупные выплаты по всем застрахованным случаям не могут превышать агрегатный лимит отвественности страховщика по Полису.",bold:!0,alignment:"justify",fontSize:a},"\n"),n}addSpaces(t){let e=(t+="").split("."),n=e[0],i=e.length>1?"."+e[1]:"",r=/(\d+)(\d{3})/;for(;r.test(n);)n=n.replace(r,"$1 $2");return n+i}makeParagraphs(t){const e=[];let n=2;return t.polisObj.conditions.forEach(t=>{if(t.name===BASENAME)return;if(t.const)return;let i={widths:[30,457],keepWithHeaderRows:1};i.body=[[{text:`${n}. ${t.name}:`,style:"firstHeader",colSpan:2,border:r,fontSize:a},{}]];let s=t.values.filter(({checked:t})=>t);if(t.oneLine){const t=[{text:s.map(t=>t.text).join(", "),colSpan:2,border:r,alignment:"justify",fontSize:a}];i.body.push(t)}else s.forEach((t,e)=>{let s=[];s.push({text:`${n}.${e+1}`,border:r,fontSize:a},{text:t.text,border:r,fontSize:a}),i.body.push(s),i.headerRows=1});i.headerRows=1;e.push({table:i,layout:{fillColor:function(t,e){return t%2==0?"#e6e6e6":null}}},"\n"),n++}),e}makeRisksList(t,e){const n=({list:t,included:e,baseRisk:n})=>{const i={headerRows:1,widths:[1,486],body:[]};if(e){i.body.push([{text:"1.1 Определения застрахованных рисков",style:"firstHeader",colSpan:2,border:r},{}]);let e=1;n.ToPDFinclude&&(i.body.push([{text:n.ToPDFinclude[0].text,bold:n.ToPDFinclude[0].bold,border:r,colSpan:2,alignment:"justify",fontSize:a},s]),n.ToPDFinclude[1].ul.forEach(t=>{i.body.push([{text:" ",border:r},{text:`• ${t}`,border:r,alignment:"justify",fontSize:a}])}),i.body.push(),e++);for(const n of t)i.body.push([{text:[{text:`${n.name}`,bold:!0},{text:` - ${n.title}. `}],border:r,colSpan:2,alignment:"justify",fontSize:a},s]),e++}else{i.body.push([{text:"1.2 Определения не заявленных на страхование рисков:",style:"firstHeader",colSpan:2,border:r},{}]);let e=1;n.ToPDFnotInclude&&(i.body.push([{text:n.ToPDFnotInclude[0].text,bold:n.ToPDFnotInclude[0].bold,border:r,colSpan:2,alignment:"justify",fontSize:a},s]),n.ToPDFnotInclude[1].ul.forEach(t=>{i.body.push([{text:" ",border:r},{text:`• ${t}`,border:r,alignment:"justify",fontSize:a}])}),e++);for(const n of t)i.body.push([{text:[{text:`${n.name}`,bold:!0},{text:` - ${n.title}. `}],border:r,colSpan:2,alignment:"justify",fontSize:a},s]),e++}return{table:i,layout:{fillColor:function(t,e){return t%2==0?"#e6e6e6":null}}}};let i=[],o=Object.assign({},t.polisObj.conditions.filter(t=>t.name==BASENAME)[0]);const l={text:`${BASENAME}:`,bold:!0};if(o.ToPDFinclude=[l],o.ToPDFnotInclude=[l],o){e=e.filter(({name:t})=>t!==BASENAME);const t=[],n=[];o.values.forEach(e=>{e.checked?t.push(e.text):n.push(e.text)}),o.ToPDFinclude.push({type:"square",ul:t}),o.ToPDFnotInclude.push({type:"square",ul:n}),0===t.length&&delete o.ToPDFinclude,0===n.length&&delete o.ToPDFnotInclude}let c=this.makeCarLists(t);for(const t of e)t.list=[],c.forEach((e,n)=>{e.risks.includes(t.name)&&t.list.push(n+1)});const u=[...this.includedRisksOrder].map(t=>{if(t!==BASENAME)return e.find(e=>e.name===t)}).filter(t=>void 0!==t);i.push(n({list:u,included:!0,baseRisk:o}),"\n");const h=e.filter(t=>0==t.list.length);return i.push(n({list:h,included:!1,baseRisk:o}),"\n"),i}makeTerritory(t){const e=[];return t.polisObj.conditions.find(t=>"territory"===t.type).values.forEach(t=>{t.checked&&e.push(t.text.toUpperCase())}),e.join(", ")}makePDF(t,e){t.companyObj.card||(t.companyObj.card={"Данные компании":{"Форма организации":"","Наименование организации":"ОБРАЗЕЦ"},"Доп. информация":{"Юридический адрес":""},"Генеральный директор":{"ФИО директора":""}});const n={text:"",border:[!1,!1,!1,!1]},s=[0,10,0,10],o=[0,5,0,5],a=this.makeTerritory(t);let l=null;const c={pageSize:"A4",pageMargins:[50,115,50,65],content:[{table:{headerRows:1,widths:[150,150,175],body:[[{text:["ПОЛИС CMR/ТТН - СТРАХОВАНИЯ ПЕРЕВОЗЧИКА \n",`${this.hipName}`],colSpan:3,style:"firstHeader",fontSize:20,fillColor:"#e6e6e6"},{},{}],[{text:`Страхование действует в соответствии с Договором CMR/ТТН - страхования перевозчика ${this.hipName}.`,colSpan:3,fontSize:10,alignment:"center"},{},{}]],style:"table"},layout:{hLineColor:"#e6e6e6",vLineColor:"#e6e6e6"}},"\n",{table:{headerRows:1,widths:[150,150,175],body:[[{text:"СТРАХОВЩИК",style:"leftCellFirstTable",margin:s},{text:[{text:"ООО «СК «КАПИТАЛ-ПОЛИС»\n",bold:!0},{text:"Московский пр., д.22, лит. 3, Санкт-Петербург, 190013\n",fontSize:10}],colSpan:2,alignment:"center",margin:o},{}],[{text:"ПЕРИОД СТРАХОВАНИЯ",style:"leftCellFirstTable",margin:s},{text:`${t.polisObj.dates.start} - ${t.polisObj.dates.end}`,alignment:"center",bold:!0,colSpan:2,margin:s}]],style:"table"},layout:{hLineColor:"#e6e6e6",vLineColor:"#e6e6e6"}},"\n",{table:{headerRows:1,widths:[150,150,175],body:[[{text:"СТРАХОВАТЕЛЬ",style:"leftCellFirstTable",margin:s},{text:[{text:`${t.companyObj.card["Данные компании"]["Форма организации"]} ${t.companyObj.card["Данные компании"]["Наименование организации"].toUpperCase()}\n`,bold:!0},{text:`${t.companyObj.card["Доп. информация"]["Юридический адрес"]}`,fontSize:10}],colSpan:2,alignment:"center",margin:o}],[{text:"КОЛИЧЕСТВО ЗАСТРАХОВАННЫХ ТРАНСПОРТНЫХ СРЕДСТВ",style:"leftCellFirstTable",margin:o},{text:`${t.totalAmount/24}`,margin:s,bold:!0,colSpan:2,alignment:"center"}]]},layout:{hLineColor:"#e6e6e6",vLineColor:"#e6e6e6"}},"\n",{table:{headerRows:1,widths:[150,150,175],body:[[{text:"ТЕРРИТОРИЯ СТРАХОВАНИЯ",style:"leftCellFirstTable",margin:s.map((t,e)=>1===e?t+2:t)},{text:`${a}`,colSpan:2,alignment:"center",margin:a.length<65?s:o}],[{text:"АГРЕГАТНЫЙ ЛИМИТ ОТВЕТСТВЕННОСТИ СТРАХОВЩИКА ПО ПОЛИСУ",style:"leftCellFirstTable",margin:o},{text:`${this.addSpaces(t.a_limit.value)} ${{"Р":"₽",EUR:"€",USD:"$"}[t.document.currency]}`,margin:s,bold:!0,colSpan:2,alignment:"center"}],[{text:"ДАТА ВЫДАЧИ",style:"leftCellFirstTable",margin:s},{text:`${Object(i.parseDate)(new Date)}`,bold:!0,colSpan:2,alignment:"center",margin:s}]]},layout:{hLineColor:"#e6e6e6",vLineColor:"#e6e6e6"}},{table:{headerRows:1,widths:[493],body:[[{text:"Страхованием покрывается любой и каждый груз, с учетом исключений, предусмотренных полисом.",style:"leftCellFirstTable",alignment:"center",bold:!0}]]},layout:{hLineColor:"#e6e6e6",vLineColor:"#e6e6e6"}},"\n",{table:{headerRows:1,widths:[100,300,75],body:[[{text:[{text:"ООО «СК «КАПИТАЛ-ПОЛИС»\n",bold:!0},{text:"\n\n"},{text:"__________________________________________\n"},{text:"/Корпусов Д.В/\n",fontSize:7},{text:"Доверенность №74/2018 от 10.03.2018\n",fontSize:7},{text:"\n"}],alignment:"center",colSpan:3},{},{}]]},layout:{hLineColor:"#e6e6e6",vLineColor:"#e6e6e6"}},"\n",{table:{headerRows:1,widths:[100,300,75],body:[[{text:[{text:"ЦЕНТР СТРАХОВАНИЯ ТРАНСПОРТНЫХ РИСКОВ\n\n",bold:!0,fontSize:12},{text:"Телефон: +7 (812) 322-63-51\n",fontSize:10},{text:"E-mail: cargo@capitalpolis.ru, claims@capitalpolis.ru\n",fontSize:10},{text:"Московский пр., д.22, лит. 3, Санкт-Петербург, 190013, Россия",fontSize:10}],alignment:"center",colSpan:3},{},{}]]},layout:{hLineColor:"#e6e6e6",vLineColor:"#e6e6e6"}}],footer:(t,e,i,s)=>{return null===l&&(t=>{let e=null;t.forEach((t,n)=>{"line"===t.items[0].type&&"ПРИЛОЖЕНИЕ "===t.items[0].item.inlines[0].text&&"1 "===t.items[0].item.inlines[1].text&&(e=n)}),e?l=e:console.error("Не найдена страница с приложением 1")})(s),t===l?{table:{headerRows:0,widths:[50,70,150,70,150,50],body:[[{text:`Лист ${t.toString()}/${e.toString()} Полиса ${this.hipName}`,colSpan:6,border:r,alignment:"center",fontSize:7,margin:[0,40,0,0]}]],style:"table"}}:t>1?{table:{headerRows:0,widths:[50,70,150,70,150,50],body:[[{text:"",fontSize:12,border:r},n,n,n,n,n],[n,{text:"Cтрахователь:",fontSize:10,border:r},{text:"___________________________________",border:r},{text:"Cтраховщик:",fontSize:10,border:r},{text:"___________________________________",border:r},n],[n,n,{text:"подпись и печать",fontSize:7,alignment:"center",border:r},n,{text:"подпись и печать",fontSize:7,alignment:"center",border:r},n],[{text:`Лист ${t.toString()}/${e.toString()} Полиса ${this.hipName}`,colSpan:6,border:r,alignment:"center",fontSize:7}]],style:"table"}}:void 0},styles:{leftCellFirstTable:{fillColor:"#e6e6e6",fontSize:10},table:{fontStyle:"PT Sans Narrow",alignment:"center"},firstHeader:{bold:!0,fillColor:"#DBE5F1",alignment:"center"},carInfo:{fontSize:9}}};c.content.push({pageBreak:"before",text:"1. Риски и условия страхования для транспортных средств, перечисленных в Приложении 1",alignment:"center",margin:[0,0,0,5],style:"firstHeader"},...this.makeTables(t),...this.makeRisksList(t,e),...this.makeParagraphs(t),"\n",{table:{headerRows:1,widths:[245,245],dontBreakRows:!0,keepWithHeaderRows:1,body:[[{text:"СТРАХОВАТЕЛЬ:",style:"firstHeader",fontSize:12,fillColor:"#e6e6e6"},{text:"СТРАХОВЩИК:",style:"firstHeader",fontSize:12,fillColor:"#e6e6e6"}],[{text:[{text:`${t.companyObj.card["Данные компании"]["Форма организации"]} «${t.companyObj.card["Данные компании"]["Наименование организации"].toUpperCase()}»\n`,bold:!0},{text:"\n\n\n"},{text:"__________________________________\n"},{text:`${t.companyObj.card["Генеральный директор"]["ФИО директора"]}\n`,fontSize:7},{text:"На основании Устава",fontSize:7}],alignment:"center"},{text:[{text:"ООО «СК «КАПИТАЛ-ПОЛИС»\n",bold:!0},{text:"\n\n\n"},{text:"__________________________________\n"},{text:"/Корпусов Д.В./\n",fontSize:7},{text:"Доверенность №74/2018 от 10.03.2018",fontSize:7}],alignment:"center"}]]},layout:{hLineColor:"#e6e6e6",vLineColor:"#e6e6e6"}},{pageBreak:"before",text:`ПРИЛОЖЕНИЕ 1 - Списки транспортных средств подпадающих под страхование Полиса ${this.hipName}`,alignment:"justify",bold:!0},...this.carsTables),pdfMake.fonts={Roboto:{normal:"PTN.ttf",bold:"PTN-bold.ttf"}};const u=window.open("","_blank");Object(i.delay)(500).then(()=>pdfMake.createPdf(c).open({},u))}}new c},function(t,e,n){"use strict";n.r(e);n(8);n(9),n(1),n(0),n(10),n(11),n(12),n(13),n(14),n(15),n(16),n(19),n(17),n(18),n(20),n(6)},function(t,e){!function(t){"use strict";function e(t,e){return e=e||Error,function(){var n,i=arguments[0];for(n="["+(t?t+":":"")+i+"] http://errors.angularjs.org/1.6.3/"+(t?t+"/":"")+i,i=1;i<arguments.length;i++){var r;n=n+(1==i?"?":"&")+"p"+(i-1)+"=",n+=encodeURIComponent(r="function"==typeof(r=arguments[i])?r.toString().replace(/ \{[\s\S]*$/,""):void 0===r?"undefined":"string"!=typeof r?JSON.stringify(r):r)}return new e(n)}}function n(t){if(!w(t))return Gn;v(t.objectMaxDepth)&&(Gn.objectMaxDepth=i(t.objectMaxDepth)?t.objectMaxDepth:NaN)}function i(t){return O(t)&&0<t}function r(t){if(null==t||E(t))return!1;if(si(t)||x(t)||qn&&t instanceof qn)return!0;var e="length"in Object(t)&&t.length;return O(e)&&(0<=e&&(e-1 in t||t instanceof Array)||"function"==typeof t.item)}function s(t,e,n){var i,o;if(t)if(C(t))for(i in t)"prototype"!==i&&"length"!==i&&"name"!==i&&t.hasOwnProperty(i)&&e.call(n,t[i],i,t);else if(si(t)||r(t)){var a="object"!=typeof t;for(i=0,o=t.length;i<o;i++)(a||i in t)&&e.call(n,t[i],i,t)}else if(t.forEach&&t.forEach!==s)t.forEach(e,n,t);else if(b(t))for(i in t)e.call(n,t[i],i,t);else if("function"==typeof t.hasOwnProperty)for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t);else for(i in t)Bn.call(t,i)&&e.call(n,t[i],i,t);return t}function o(t,e,n){for(var i=Object.keys(t).sort(),r=0;r<i.length;r++)e.call(n,t[i[r]],i[r]);return i}function a(t){return function(e,n){t(n,e)}}function l(t,e,n){for(var i=t.$$hashKey,r=0,s=e.length;r<s;++r){var o=e[r];if(w(o)||C(o))for(var a=Object.keys(o),c=0,u=a.length;c<u;c++){var h=a[c],f=o[h];n&&w(f)?S(f)?t[h]=new Date(f.valueOf()):k(f)?t[h]=new RegExp(f):f.nodeName?t[h]=f.cloneNode(!0):j(f)?t[h]=f.clone():(w(t[h])||(t[h]=si(f)?[]:{}),l(t[h],[f],!0)):t[h]=f}}return i?t.$$hashKey=i:delete t.$$hashKey,t}function c(t){return l(t,Yn.call(arguments,1),!1)}function u(t){return l(t,Yn.call(arguments,1),!0)}function h(t){return parseInt(t,10)}function f(t,e){return c(Object.create(t),e)}function d(){}function p(t){return t}function $(t){return function(){return t}}function m(t){return C(t.toString)&&t.toString!==Zn}function g(t){return void 0===t}function v(t){return void 0!==t}function w(t){return null!==t&&"object"==typeof t}function b(t){return null!==t&&"object"==typeof t&&!Qn(t)}function x(t){return"string"==typeof t}function O(t){return"number"==typeof t}function S(t){return"[object Date]"===Zn.call(t)}function C(t){return"function"==typeof t}function k(t){return"[object RegExp]"===Zn.call(t)}function E(t){return t&&t.window===t}function P(t){return t&&t.$evalAsync&&t.$watch}function A(t){return"boolean"==typeof t}function j(t){return!(!t||!(t.nodeName||t.prop&&t.attr&&t.find))}function N(t){return Jn(t.nodeName||t[0]&&t[0].nodeName)}function y(t,e){var n=t.indexOf(e);return 0<=n&&t.splice(n,1),n}function T(t,e,n){function r(t,e,n){if(0>--n)return"...";var i,r=e.$$hashKey;if(si(t)){i=0;for(var s=t.length;i<s;i++)e.push(o(t[i],n))}else if(b(t))for(i in t)e[i]=o(t[i],n);else if(t&&"function"==typeof t.hasOwnProperty)for(i in t)t.hasOwnProperty(i)&&(e[i]=o(t[i],n));else for(i in t)Bn.call(t,i)&&(e[i]=o(t[i],n));return r?e.$$hashKey=r:delete e.$$hashKey,e}function o(t,e){if(!w(t))return t;if(-1!==(n=l.indexOf(t)))return c[n];if(E(t)||P(t))throw Fn("cpws");var n=!1,i=a(t);return void 0===i&&(i=si(t)?[]:Object.create(Qn(t)),n=!0),l.push(t),c.push(i),n?r(t,i,e):i}function a(t){switch(Zn.call(t)){case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return new t.constructor(o(t.buffer),t.byteOffset,t.length);case"[object ArrayBuffer]":if(!t.slice){var e=new ArrayBuffer(t.byteLength);return new Uint8Array(e).set(new Uint8Array(t)),e}return t.slice(0);case"[object Boolean]":case"[object Number]":case"[object String]":case"[object Date]":return new t.constructor(t.valueOf());case"[object RegExp]":return(e=new RegExp(t.source,t.toString().match(/[^\/]*$/)[0])).lastIndex=t.lastIndex,e;case"[object Blob]":return new t.constructor([t],{type:t.type})}if(C(t.cloneNode))return t.cloneNode(!0)}var l=[],c=[];if(n=i(n)?n:NaN,e){if(function(t){return t&&O(t.length)&&oi.test(Zn.call(t))}(e)||"[object ArrayBuffer]"===Zn.call(e))throw Fn("cpta");if(t===e)throw Fn("cpi");return si(e)?e.length=0:s(e,function(t,n){"$$hashKey"!==n&&delete e[n]}),l.push(t),c.push(e),r(t,e,n)}return o(t,n)}function M(t,e){if(t===e)return!0;if(null===t||null===e)return!1;if(t!=t&&e!=e)return!0;var n,i=typeof t;if(i===typeof e&&"object"===i){if(!si(t)){if(S(t))return!!S(e)&&M(t.getTime(),e.getTime());if(k(t))return!!k(e)&&t.toString()===e.toString();if(P(t)||P(e)||E(t)||E(e)||si(e)||S(e)||k(e))return!1;for(n in i=it(),t)if("$"!==n.charAt(0)&&!C(t[n])){if(!M(t[n],e[n]))return!1;i[n]=!0}for(n in e)if(!(n in i)&&"$"!==n.charAt(0)&&v(e[n])&&!C(e[n]))return!1;return!0}if(!si(e))return!1;if((i=t.length)===e.length){for(n=0;n<i;n++)if(!M(t[n],e[n]))return!1;return!0}}return!1}function V(t,e,n){return t.concat(Yn.call(e,n))}function D(t,e){var n=2<arguments.length?Yn.call(arguments,2):[];return!C(e)||e instanceof RegExp?e:n.length?function(){return arguments.length?e.apply(t,V(n,arguments,0)):e.apply(t,n)}:function(){return arguments.length?e.apply(t,arguments):e.call(t)}}function L(e,n){var i=n;return"string"==typeof e&&"$"===e.charAt(0)&&"$"===e.charAt(1)?i=void 0:E(n)?i="$WINDOW":n&&t.document===n?i="$DOCUMENT":P(n)&&(i="$SCOPE"),i}function I(t,e){if(!g(t))return O(e)||(e=e?2:null),JSON.stringify(t,L,e)}function H(t){return x(t)?JSON.parse(t):t}function _(t,e){t=t.replace(hi,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return ni(n)?e:n}function q(t,e,n){n=n?-1:1;var i=t.getTimezoneOffset();return n*=(e=_(e,i))-i,(t=new Date(t.getTime())).setMinutes(t.getMinutes()+n),t}function U(t){t=qn(t).clone();try{t.empty()}catch(t){}var e=qn("<div>").append(t).html();try{return t[0].nodeType===mi?Jn(e):e.match(/^(<[^>]+>)/)[1].replace(/^<([\w-]+)/,function(t,e){return"<"+Jn(e)})}catch(t){return Jn(e)}}function R(t){try{return decodeURIComponent(t)}catch(t){}}function z(t){var e={};return s((t||"").split("&"),function(t){var n,i,r;t&&(i=t=t.replace(/\+/g,"%20"),-1!==(n=t.indexOf("="))&&(i=t.substring(0,n),r=t.substring(n+1)),v(i=R(i))&&(r=!v(r)||R(r),Bn.call(e,i)?si(e[i])?e[i].push(r):e[i]=[e[i],r]:e[i]=r))}),e}function B(t){var e=[];return s(t,function(t,n){si(t)?s(t,function(t){e.push(J(n,!0)+(!0===t?"":"="+J(t,!0)))}):e.push(J(n,!0)+(!0===t?"":"="+J(t,!0)))}),e.length?e.join("&"):""}function G(t){return J(t,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function J(t,e){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,e?"%20":"+")}function W(e,n){var i,r,o={};s(fi,function(t){t+="app",!i&&e.hasAttribute&&e.hasAttribute(t)&&(i=e,r=e.getAttribute(t))}),s(fi,function(t){var n;t+="app",!i&&(n=e.querySelector("["+t.replace(":","\\:")+"]"))&&(i=n,r=n.getAttribute(t))}),i&&(di?(o.strictDi=null!==function(t,e){var n,i,r=fi.length;for(i=0;i<r;++i)if(n=fi[i]+e,x(n=t.getAttribute(n)))return n;return null}(i,"strict-di"),n(i,r?[r]:[],o)):t.console.error("Angular: disabling automatic bootstrap. <script> protocol indicates an extension, document.location.href does not match."))}function Y(e,n,i){w(i)||(i={}),i=c({strictDi:!1},i);var r=function(){if((e=qn(e)).injector()){var r=e[0]===t.document?"document":U(e);throw Fn("btstrpd",r.replace(/</,"&lt;").replace(/>/,"&gt;"))}return(n=n||[]).unshift(["$provide",function(t){t.value("$rootElement",e)}]),i.debugInfoEnabled&&n.push(["$compileProvider",function(t){t.debugInfoEnabled(!0)}]),n.unshift("ng"),(r=Vt(n,i.strictDi)).invoke(["$rootScope","$rootElement","$compile","$injector",function(t,e,n,i){t.$apply(function(){e.data("$injector",i),n(e)(t)})}]),r},o=/^NG_ENABLE_DEBUG_INFO!/,a=/^NG_DEFER_BOOTSTRAP!/;if(t&&o.test(t.name)&&(i.debugInfoEnabled=!0,t.name=t.name.replace(o,"")),t&&!a.test(t.name))return r();t.name=t.name.replace(a,""),ti.resumeBootstrap=function(t){return s(t,function(t){n.push(t)}),r()},C(ti.resumeDeferredBootstrap)&&ti.resumeDeferredBootstrap()}function K(){t.name="NG_ENABLE_DEBUG_INFO!"+t.name,t.location.reload()}function X(t){if(!(t=ti.element(t).injector()))throw Fn("test");return t.get("$$testability")}function Z(t,e){return e=e||"_",t.replace(pi,function(t,n){return(n?e:"")+t.toLowerCase()})}function Q(t,e,n){if(!t)throw Fn("areq",e||"?",n||"required");return t}function F(t,e,n){return n&&si(t)&&(t=t[t.length-1]),Q(C(t),e,"not a function, got "+(t&&"object"==typeof t?t.constructor.name||"Object":typeof t)),t}function tt(t,e){if("hasOwnProperty"===t)throw Fn("badname",e)}function et(t,e,n){if(!e)return t;for(var i,r=t,s=(e=e.split(".")).length,o=0;o<s;o++)i=e[o],t&&(t=(r=t)[i]);return!n&&C(t)?D(r,t):t}function nt(t){for(var e,n=t[0],i=t[t.length-1],r=1;n!==i&&(n=n.nextSibling);r++)(e||t[r]!==n)&&(e||(e=qn(Yn.call(t,0,r))),e.push(n));return e||t}function it(){return Object.create(null)}function rt(t){if(null==t)return"";switch(typeof t){case"string":break;case"number":t=""+t;break;default:t=!m(t)||si(t)||S(t)?I(t):t.toString()}return t}function st(t,e){if(si(t)){e=e||[];for(var n=0,i=t.length;n<i;n++)e[n]=t[n]}else if(w(t))for(n in e=e||{},t)"$"===n.charAt(0)&&"$"===n.charAt(1)||(e[n]=t[n]);return e||t}function ot(t,e){var n=[];return i(e)&&(t=T(t,null,e)),JSON.stringify(t,function(t,e){if(w(e=L(t,e))){if(0<=n.indexOf(e))return"...";n.push(e)}return e})}function at(t,e){return e.toUpperCase()}function lt(t){return t.replace(bi,at)}function ct(t){return 1===(t=t.nodeType)||!t||9===t}function ut(t,e){var n,i,r=e.createDocumentFragment(),o=[];if(ki.test(t)){for(n=r.appendChild(e.createElement("div")),i=(Ei.exec(t)||["",""])[1].toLowerCase(),i=Ai[i]||Ai._default,n.innerHTML=i[1]+t.replace(Pi,"<$1></$2>")+i[2],i=i[0];i--;)n=n.lastChild;o=V(o,n.childNodes),(n=r.firstChild).textContent=""}else o.push(e.createTextNode(t));return r.textContent="",r.innerHTML="",s(o,function(t){r.appendChild(t)}),r}function ht(e){if(e instanceof ht)return e;var n,i;if(x(e)&&(e=ai(e),n=!0),!(this instanceof ht)){if(n&&"<"!==e.charAt(0))throw Si("nosel");return new ht(e)}n?(n=t.document,xt(this,e=(i=Ci.exec(e))?[n.createElement(i[1])]:(i=ut(e,n))?i.childNodes:[])):C(e)?Et(e):xt(this,e)}function ft(t){return t.cloneNode(!0)}function dt(t,e){if(e||$t(t),t.querySelectorAll)for(var n=t.querySelectorAll("*"),i=0,r=n.length;i<r;i++)$t(n[i])}function pt(t,e,n,i){if(v(i))throw Si("offargs");var r=(i=mt(t))&&i.events,o=i&&i.handle;if(o)if(e){var a=function(e){var i=r[e];v(n)&&y(i||[],n),v(n)&&i&&0<i.length||(t.removeEventListener(e,o),delete r[e])};s(e.split(" "),function(t){a(t),Oi[t]&&a(Oi[t])})}else for(e in r)"$destroy"!==e&&t.removeEventListener(e,o),delete r[e]}function $t(t,e){var n=t.ng339,i=n&&vi[n];i&&(e?delete i.data[e]:(i.handle&&(i.events.$destroy&&i.handle({},"$destroy"),pt(t)),delete vi[n],t.ng339=void 0))}function mt(t,e){var n=(n=t.ng339)&&vi[n];return e&&!n&&(t.ng339=n=++wi,n=vi[n]={events:{},data:{},handle:void 0}),n}function gt(t,e,n){if(ct(t)){var i,r=v(n),s=!r&&e&&!w(e),o=!e;if(t=(t=mt(t,!s))&&t.data,r)t[lt(e)]=n;else{if(o)return t;if(s)return t&&t[lt(e)];for(i in e)t[lt(i)]=e[i]}}}function vt(t,e){return!!t.getAttribute&&-1<(" "+(t.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+e+" ")}function wt(t,e){e&&t.setAttribute&&s(e.split(" "),function(e){t.setAttribute("class",ai((" "+(t.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+ai(e)+" "," ")))})}function bt(t,e){if(e&&t.setAttribute){var n=(" "+(t.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");s(e.split(" "),function(t){t=ai(t),-1===n.indexOf(" "+t+" ")&&(n+=t+" ")}),t.setAttribute("class",ai(n))}}function xt(t,e){if(e)if(e.nodeType)t[t.length++]=e;else{var n=e.length;if("number"==typeof n&&e.window!==e){if(n)for(var i=0;i<n;i++)t[t.length++]=e[i]}else t[t.length++]=e}}function Ot(t,e){return St(t,"$"+(e||"ngController")+"Controller")}function St(t,e,n){for(9===t.nodeType&&(t=t.documentElement),e=si(e)?e:[e];t;){for(var i=0,r=e.length;i<r;i++)if(v(n=qn.data(t,e[i])))return n;t=t.parentNode||11===t.nodeType&&t.host}}function Ct(t){for(dt(t,!0);t.firstChild;)t.removeChild(t.firstChild)}function kt(t,e){e||dt(t);var n=t.parentNode;n&&n.removeChild(t)}function Et(e){function n(){t.document.removeEventListener("DOMContentLoaded",n),t.removeEventListener("load",n),e()}"complete"===t.document.readyState?t.setTimeout(e):(t.document.addEventListener("DOMContentLoaded",n),t.addEventListener("load",n))}function Pt(t,e){var n=yi[e.toLowerCase()];return n&&Ti[N(t)]&&n}function At(t,e,n){n.call(t,e)}function jt(t,e,n){var i=e.relatedTarget;i&&(i===t||ji.call(t,i))||n.call(t,e)}function Nt(){this.$get=function(){return c(ht,{hasClass:function(t,e){return t.attr&&(t=t[0]),vt(t,e)},addClass:function(t,e){return t.attr&&(t=t[0]),bt(t,e)},removeClass:function(t,e){return t.attr&&(t=t[0]),wt(t,e)}})}}function yt(t,e){var n=t&&t.$$hashKey;return n?("function"==typeof n&&(n=t.$$hashKey()),n):"function"===(n=typeof t)||"object"===n&&null!==t?t.$$hashKey=n+":"+(e||function(){return++ei})():n+":"+t}function Tt(){this._keys=[],this._values=[],this._lastKey=NaN,this._lastIndex=-1}function Mt(t){return(t=Function.prototype.toString.call(t).replace(Ui,"")).match(Ii)||t.match(Hi)}function Vt(t,e){function n(t){return function(e,n){if(!w(e))return t(e,n);s(e,a(t))}}function i(t,e){if(tt(t,"service"),(C(e)||si(e))&&(e=d.instantiate(e)),!e.$get)throw Ri("pget",t);return f[t+"Provider"]=e}function r(t,e){return function(){var n=v.invoke(e,this);if(g(n))throw Ri("undef",t);return n}}function o(t,e,n){return i(t,{$get:!1!==n?r(t,e):e})}function l(t,n){function i(e,i){if(t.hasOwnProperty(e)){if(t[e]===c)throw Ri("cdep",e+" <- "+u.join(" <- "));return t[e]}try{return u.unshift(e),t[e]=c,t[e]=n(e,i),t[e]}catch(n){throw t[e]===c&&delete t[e],n}finally{u.shift()}}function r(t,n,r){for(var s=[],o=0,a=(t=Vt.$$annotate(t,e,r)).length;o<a;o++){var l=t[o];if("string"!=typeof l)throw Ri("itkn",l);s.push(n&&n.hasOwnProperty(l)?n[l]:i(l,r))}return s}return{invoke:function(t,e,n,i){if("string"==typeof n&&(i=n,n=null),n=r(t,n,i),si(t)&&(t=t[t.length-1]),i=t,_n||"function"!=typeof i)i=!1;else{var s=i.$$ngIsClass;A(s)||(s=i.$$ngIsClass=/^(?:class\b|constructor\()/.test(Function.prototype.toString.call(i))),i=s}return i?(n.unshift(null),new(Function.prototype.bind.apply(t,n))):t.apply(e,n)},instantiate:function(t,e,n){var i=si(t)?t[t.length-1]:t;return(t=r(t,e,n)).unshift(null),new(Function.prototype.bind.apply(i,t))},get:i,annotate:Vt.$$annotate,has:function(e){return f.hasOwnProperty(e+"Provider")||t.hasOwnProperty(e)}}}e=!0===e;var c={},u=[],h=new Di,f={$provide:{provider:n(i),factory:n(o),service:n(function(t,e){return o(t,["$injector",function(t){return t.instantiate(e)}])}),value:n(function(t,e){return o(t,$(e),!1)}),constant:n(function(t,e){tt(t,"constant"),f[t]=e,p[t]=e}),decorator:function(t,e){var n=d.get(t+"Provider"),i=n.$get;n.$get=function(){var t=v.invoke(i,n);return v.invoke(e,null,{$delegate:t})}}}},d=f.$injector=l(f,function(t,e){throw ti.isString(e)&&u.push(e),Ri("unpr",u.join(" <- "))}),p={},m=l(p,function(t,e){var n=d.get(t+"Provider",e);return v.invoke(n.$get,n,void 0,t)}),v=m;f.$injectorProvider={$get:$(m)},v.modules=d.modules=it();var b=function t(e){Q(g(e)||si(e),"modulesToLoad","not an array");var n,i=[];return s(e,function(e){function r(t){var e,n;for(e=0,n=t.length;e<n;e++){var i=t[e],r=d.get(i[0]);r[i[1]].apply(r,i[2])}}if(!h.get(e)){h.set(e,!0);try{x(e)?(n=Rn(e),v.modules[e]=n,i=i.concat(t(n.requires)).concat(n._runBlocks),r(n._invokeQueue),r(n._configBlocks)):C(e)?i.push(d.invoke(e)):si(e)?i.push(d.invoke(e)):F(e,"module")}catch(t){throw si(e)&&(e=e[e.length-1]),t.message&&t.stack&&-1===t.stack.indexOf(t.message)&&(t=t.message+"\n"+t.stack),Ri("modulerr",e,t.stack||t.message||t)}}}),i}(t);return(v=m.get("$injector")).strictDi=e,s(b,function(t){t&&v.invoke(t)}),v}function Dt(){var e=!0;this.disableAutoScrolling=function(){e=!1},this.$get=["$window","$location","$rootScope",function(n,i,r){function s(t){var e;t?(t.scrollIntoView(),C(e=o.yOffset)?e=e():j(e)?(e=e[0],e="fixed"!==n.getComputedStyle(e).position?0:e.getBoundingClientRect().bottom):O(e)||(e=0),e&&(t=t.getBoundingClientRect().top,n.scrollBy(0,t-e))):n.scrollTo(0,0)}function o(t){var e;(t=x(t)?t:O(t)?t.toString():i.hash())?(e=a.getElementById(t))?s(e):(e=function(t){var e=null;return Array.prototype.some.call(t,function(t){if("a"===N(t))return e=t,!0}),e}(a.getElementsByName(t)))?s(e):"top"===t&&s(null):s(null)}var a=n.document;return e&&r.$watch(function(){return i.hash()},function(e,n){e===n&&""===e||function(e,n){"complete"===(n=n||t).document.readyState?n.setTimeout(e):qn(n).on("load",e)}(function(){r.$evalAsync(o)})}),o}]}function Lt(t,e){return t||e?t?e?(si(t)&&(t=t.join(" ")),si(e)&&(e=e.join(" ")),t+" "+e):t:e:""}function It(t){return w(t)?t:{}}function Ht(t,e,n,i){function r(t){try{t.apply(null,Yn.call(arguments,1))}finally{if(0===--m)for(;v.length;)try{v.pop()()}catch(t){n.error(t)}}}function o(){S=null,l()}function a(){M(w=g(w=C())?null:w,P)&&(w=P),b=P=w}function l(){var t=b;a(),x===c.url()&&t===w||(x=c.url(),b=w,s(k,function(t){t(c.url(),w)}))}var c=this,u=t.location,h=t.history,f=t.setTimeout,p=t.clearTimeout,$={};c.isMock=!1;var m=0,v=[];c.$$completeOutstandingRequest=r,c.$$incOutstandingRequestCount=function(){m++},c.notifyWhenNoOutstandingRequests=function(t){0===m?t():v.push(t)};var w,b,x=u.href,O=e.find("base"),S=null,C=i.history?function(){try{return h.state}catch(t){}}:d;a(),c.url=function(e,n,r){if(g(r)&&(r=null),u!==t.location&&(u=t.location),h!==t.history&&(h=t.history),e){var s=b===r;if(x===e&&(!i.history||s))return c;var o=x&&$e(x)===$e(e);return x=e,b=r,!i.history||o&&s?(o||(S=e),n?u.replace(e):o?(n=u,r=-1===(r=e.indexOf("#"))?"":e.substr(r),n.hash=r):u.href=e,u.href!==e&&(S=e)):(h[n?"replaceState":"pushState"](r,"",e),a()),S&&(S=e),c}return S||u.href.replace(/%27/g,"'")},c.state=function(){return w};var k=[],E=!1,P=null;c.onUrlChange=function(e){return E||(i.history&&qn(t).on("popstate",o),qn(t).on("hashchange",o),E=!0),k.push(e),e},c.$$applicationDestroyed=function(){qn(t).off("hashchange popstate",o)},c.$$checkUrlChange=l,c.baseHref=function(){var t=O.attr("href");return t?t.replace(/^(https?:)?\/\/[^\/]*/,""):""},c.defer=function(t,e){var n;return m++,n=f(function(){delete $[n],r(t)},e||0),$[n]=!0,n},c.defer.cancel=function(t){return!!$[t]&&(delete $[t],p(t),r(d),!0)}}function _t(){this.$get=["$window","$log","$sniffer","$document",function(t,e,n,i){return new Ht(t,i,e,n)}]}function qt(){this.$get=function(){function t(t,i){function r(t){t!==f&&(d?d===t&&(d=t.n):d=t,s(t.n,t.p),s(t,f),(f=t).n=null)}function s(t,e){t!==e&&(t&&(t.p=e),e&&(e.n=t))}if(t in n)throw e("$cacheFactory")("iid",t);var o=0,a=c({},i,{id:t}),l=it(),u=i&&i.capacity||Number.MAX_VALUE,h=it(),f=null,d=null;return n[t]={put:function(t,e){if(!g(e)){if(u<Number.MAX_VALUE)r(h[t]||(h[t]={key:t}));return t in l||o++,l[t]=e,o>u&&this.remove(d.key),e}},get:function(t){if(u<Number.MAX_VALUE){var e=h[t];if(!e)return;r(e)}return l[t]},remove:function(t){if(u<Number.MAX_VALUE){var e=h[t];if(!e)return;e===f&&(f=e.p),e===d&&(d=e.n),s(e.n,e.p),delete h[t]}t in l&&(delete l[t],o--)},removeAll:function(){l=it(),o=0,h=it(),f=d=null},destroy:function(){h=a=l=null,delete n[t]},info:function(){return c({},a,{size:o})}}}var n={};return t.info=function(){var t={};return s(n,function(e,n){t[n]=e.info()}),t},t.get=function(t){return n[t]},t}}function Ut(){this.$get=["$cacheFactory",function(t){return t("templates")}]}function Rt(e,n){function i(t,e,n){var i=/^\s*([@&<]|=(\*?))(\??)\s*([\w$]*)\s*$/,r=it();return s(t,function(t,s){if(t in O)r[s]=O[t];else{var o=t.match(i);if(!o)throw Xi("iscp",e,s,t,n?"controller bindings definition":"isolate scope definition");r[s]={mode:o[1][0],collection:"*"===o[2],optional:"?"===o[3],attrName:o[4]||s},o[4]&&(O[t]=r[s])}}),r}function r(t){var e=t.require||t.controller&&t.name;return!si(e)&&w(e)&&s(e,function(t,n){var i=t.match(m);t.substring(i[0].length)||(e[n]=i[0]+n)}),e}var o={},l=/^\s*directive:\s*([\w-]+)\s+(.*)$/,u=/(([\w-]+)(?::([^;]+))?;?)/,h=function(t){var e,n={};for(t=t.split(","),e=0;e<t.length;e++)n[t[e]]=!0;return n}("ngSrc,ngSrcset,src,srcset"),m=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,b=/^(on[a-z]+|formaction)$/,O=it();this.directive=function t(n,i){return Q(n,"name"),tt(n,"directive"),x(n)?(function(t){var e=t.charAt(0);if(!e||e!==Jn(e))throw Xi("baddir",t);if(t!==t.trim())throw Xi("baddir",t)}(n),Q(i,"directiveFactory"),o.hasOwnProperty(n)||(o[n]=[],e.factory(n+"Directive",["$injector","$exceptionHandler",function(t,e){var i=[];return s(o[n],function(s,o){try{var a=t.invoke(s);C(a)?a={compile:$(a)}:!a.compile&&a.link&&(a.compile=$(a.link)),a.priority=a.priority||0,a.index=o,a.name=a.name||n,a.require=r(a);var l=a,c=a.restrict;if(c&&(!x(c)||!/[EACM]/.test(c)))throw Xi("badrestrict",c,n);l.restrict=c||"EA",a.$$moduleName=s.$$moduleName,i.push(a)}catch(t){e(t)}}),i}])),o[n].push(i)):s(n,a(t)),this},this.component=function(t,e){function n(t){function n(e){return C(e)||si(e)?function(n,i){return t.invoke(e,this,{$element:n,$attrs:i})}:e}var r=e.template||e.templateUrl?e.template:"",o={controller:i,controllerAs:Wt(e.controller)||e.controllerAs||"$ctrl",template:n(r),templateUrl:n(e.templateUrl),transclude:e.transclude,scope:{},bindToController:e.bindings||{},restrict:"E",require:e.require};return s(e,function(t,e){"$"===e.charAt(0)&&(o[e]=t)}),o}var i=e.controller||function(){};return s(e,function(t,e){"$"===e.charAt(0)&&(n[e]=t,C(i)&&(i[e]=t))}),n.$inject=["$injector"],this.directive(t,n)},this.aHrefSanitizationWhitelist=function(t){return v(t)?(n.aHrefSanitizationWhitelist(t),this):n.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(t){return v(t)?(n.imgSrcSanitizationWhitelist(t),this):n.imgSrcSanitizationWhitelist()};var S=!0;this.debugInfoEnabled=function(t){return v(t)?(S=t,this):S};var k=!1;this.preAssignBindingsEnabled=function(t){return v(t)?(k=t,this):k};var E=10;this.onChangesTtl=function(t){return arguments.length?(E=t,this):E};var j=!0;this.commentDirectivesEnabled=function(t){return arguments.length?(j=t,this):j};var T=!0;this.cssClassDirectivesEnabled=function(t){return arguments.length?(T=t,this):T},this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$sce","$animate","$$sanitizeUri",function(e,n,r,a,$,O,V,L,I,H){function _(){try{if(!--Ct)throw wt=void 0,Xi("infchng",E);V.$apply(function(){for(var t=[],e=0,n=wt.length;e<n;++e)try{wt[e]()}catch(e){t.push(e)}if(wt=void 0,t.length)throw t})}finally{Ct++}}function q(t,e){if(e){var n,i,r,s=Object.keys(e);for(n=0,i=s.length;n<i;n++)this[r=s[n]]=e[r]}else this.$attr={};this.$$element=t}function R(t,e){try{t.addClass(e)}catch(t){}}function z(t,e,n,i,r){t instanceof qn||(t=qn(t));var s=B(t,e,t,n,i,r);z.$$addScopeClass(t);var o=null;return function(e,n,i){if(!t)throw Xi("multilink");Q(e,"scope"),r&&r.needsNewScope&&(e=e.$parent.$new());var a=(i=i||{}).parentBoundTranscludeFn,l=i.transcludeControllers;if(i=i.futureParentElement,a&&a.$$boundTransclude&&(a=a.$$boundTransclude),o||(o=(i=i&&i[0])&&"foreignobject"!==N(i)&&Zn.call(i).match(/SVG/)?"svg":"html"),i="html"!==o?qn(dt(o,qn("<div>").append(t).html())):n?Ni.clone.call(t):t,l)for(var c in l)i.data("$"+c+"Controller",l[c].instance);return z.$$addScopeInfo(i,e),n&&n(i,e),s&&s(e,i,i,a),n||(t=s=null),i}}function B(t,e,n,i,r,s){for(var o,a,l,c,u,h=[],f=si(t)||t instanceof qn,d=0;d<t.length;d++)o=new q,11===_n&&G(t,d,f),(s=(a=W(t[d],[],o,0===d?i:void 0,r)).length?tt(a,t[d],o,e,n,null,[],[],s):null)&&s.scope&&z.$$addScopeClass(o.$$element),o=s&&s.terminal||!(l=t[d].childNodes)||!l.length?null:B(l,s?(s.transcludeOnThisElement||!s.templateOnThisElement)&&s.transclude:e),(s||o)&&(h.push(d,s,o),c=!0,u=u||s),s=null;return c?function(t,n,i,r){var s,o,a,l,c,f;if(u)for(f=Array(n.length),l=0;l<h.length;l+=3)f[s=h[l]]=n[s];else f=n;for(l=0,c=h.length;l<c;)o=f[h[l++]],n=h[l++],s=h[l++],n?(n.scope?(a=t.$new(),z.$$addScopeInfo(qn(o),a)):a=t,n(s,a,o,i,n.transcludeOnThisElement?J(t,n.transclude,r):!n.templateOnThisElement&&r?r:!r&&e?J(t,e):null)):s&&s(t,o.childNodes,void 0,r)}:null}function G(t,e,n){var i,r=t[e],s=r.parentNode;if(r.nodeType===mi)for(;(i=s?r.nextSibling:t[e+1])&&i.nodeType===mi;)r.nodeValue+=i.nodeValue,i.parentNode&&i.parentNode.removeChild(i),n&&i===t[e+1]&&t.splice(e+1,1)}function J(t,e,n){function i(i,r,s,o,a){return i||((i=t.$new(!1,a)).$$transcluded=!0),e(i,r,{parentBoundTranscludeFn:n,transcludeControllers:s,futureParentElement:o})}var r,s=i.$$slots=it();for(r in e.$$slots)s[r]=e.$$slots[r]?J(t,e.$$slots[r],n):null;return i}function W(t,e,n,i,r){var s,o=n.$attr;switch(t.nodeType){case 1:st(e,Bt(s=N(t)),"E",i,r);for(var a,l,c,h,f=t.attributes,d=0,p=f&&f.length;d<p;d++){var $=!1,m=!1;l=(a=f[d]).name,c=a.value,a=Bt(l),(h=jt.test(a))&&(l=l.replace(Qi,"").substr(8).replace(/_(.)/g,function(t,e){return e.toUpperCase()})),(a=a.match(Nt))&&ot(a[1])&&($=l,m=l.substr(0,l.length-5)+"end",l=l.substr(0,l.length-6)),o[a=Bt(l.toLowerCase())]=l,!h&&n.hasOwnProperty(a)||(n[a]=c,Pt(t,a)&&(n[a]=!0)),pt(t,e,c,a,h),st(e,a,"A",i,r,$,m)}if("input"===s&&"hidden"===t.getAttribute("type")&&t.setAttribute("autocomplete","off"),!St)break;if(w(o=t.className)&&(o=o.animVal),x(o)&&""!==o)for(;t=u.exec(o);)st(e,a=Bt(t[2]),"C",i,r)&&(n[a]=ai(t[3])),o=o.substr(t.index+t[0].length);break;case mi:ht(e,t.nodeValue);break;case 8:if(!Ot)break;Y(t,e,n,i,r)}return e.sort(ct),e}function Y(t,e,n,i,r){try{var s=l.exec(t.nodeValue);if(s){var o=Bt(s[1]);st(e,o,"M",i,r)&&(n[o]=ai(s[2]))}}catch(t){}}function K(t,e,n){var i=[],r=0;if(e&&t.hasAttribute&&t.hasAttribute(e))do{if(!t)throw Xi("uterdir",e,n);1===t.nodeType&&(t.hasAttribute(e)&&r++,t.hasAttribute(n)&&r--),i.push(t),t=t.nextSibling}while(0<r);else i.push(t);return qn(i)}function X(t,e,n){return function(i,r,s,o,a){return r=K(r[0],e,n),t(i,r,s,o,a)}}function F(t,e,n,i,r,s){var o;return t?z(e,n,i,r,s):function(){return o||(o=z(e,n,i,r,s),e=n=s=null),o.apply(this,arguments)}}function tt(t,e,n,i,o,a,l,u,h){function f(t,e,n,i){t&&(n&&(t=X(t,n,i)),t.require=p.require,t.directiveName=$,(E===p||p.$$isolateScope)&&(t=mt(t,{isolateScope:!0})),l.push(t)),e&&(n&&(e=X(e,n,i)),e.require=p.require,e.directiveName=$,(E===p||p.$$isolateScope)&&(e=mt(e,{isolateScope:!0})),u.push(e))}function d(t,i,o,a,h){var f,d,p,$,m,v,b,x;for(f in e===o?(a=n,x=n.$$element):a=new q(x=qn(o),n),m=i,E?$=i.$new(!0):O&&(m=i.$parent),h&&((b=function(t,e,n,i){var r;if(P(t)||(i=n,n=e,e=t,t=void 0),M&&(r=v),n||(n=M?x.parent():x),!i)return h(t,e,r,n,y);var s=h.$$slots[i];if(s)return s(t,e,r,n,y);if(g(s))throw Xi("noslot",i,U(x))}).$$boundTransclude=h,b.isSlotFilled=function(t){return!!h.$$slots[t]}),S&&(v=nt(x,a,b,S,$,i,E)),E&&(z.$$addScopeInfo(x,$,!0,!(A&&(A===E||A===E.$$originalDirective))),z.$$addScopeClass(x,!0),$.$$isolateBindings=E.$$isolateBindings,(d=vt(i,a,$,$.$$isolateBindings,E)).removeWatches&&$.$on("$destroy",d.removeWatches)),v){d=S[f],p=v[f];var j=d.$$bindings.bindToController;if(k){p.bindingInfo=j?vt(m,a,p.instance,j,d):{};var N=p();N!==p.instance&&(p.instance=N,x.data("$"+d.name+"Controller",N),p.bindingInfo.removeWatches&&p.bindingInfo.removeWatches(),p.bindingInfo=vt(m,a,p.instance,j,d))}else p.instance=p(),x.data("$"+d.name+"Controller",p.instance),p.bindingInfo=vt(m,a,p.instance,j,d)}for(s(S,function(t,e){var n=t.require;t.bindToController&&!si(n)&&w(n)&&c(v[e].instance,et(e,n,x,v))}),s(v,function(t){var e=t.instance;if(C(e.$onChanges))try{e.$onChanges(t.bindingInfo.initialChanges)}catch(t){r(t)}if(C(e.$onInit))try{e.$onInit()}catch(t){r(t)}C(e.$doCheck)&&(m.$watch(function(){e.$doCheck()}),e.$doCheck()),C(e.$onDestroy)&&m.$on("$destroy",function(){e.$onDestroy()})}),f=0,d=l.length;f<d;f++)gt(p=l[f],p.isolateScope?$:i,x,a,p.require&&et(p.directiveName,p.require,x,v),b);var y=i;for(E&&(E.template||null===E.templateUrl)&&(y=$),t&&t(y,o.childNodes,void 0,h),f=u.length-1;0<=f;f--)gt(p=u[f],p.isolateScope?$:i,x,a,p.require&&et(p.directiveName,p.require,x,v),b);s(v,function(t){C((t=t.instance).$postLink)&&t.$postLink()})}h=h||{};for(var p,$,m,v,b,x=-Number.MAX_VALUE,O=h.newScopeDirective,S=h.controllerDirectives,E=h.newIsolateScopeDirective,A=h.templateDirective,j=h.nonTlbTranscludeDirective,y=!1,T=!1,M=h.hasElementTranscludeDirective,V=n.$$element=qn(e),L=i,I=!1,H=!1,_=0,R=t.length;_<R;_++){var B=(p=t[_]).$$start,G=p.$$end;if(B&&(V=K(e,B,G)),m=void 0,x>p.priority)break;if((b=p.scope)&&(p.templateUrl||(w(b)?(ut("new/isolated scope",E||O,p,V),E=p):ut("new/isolated scope",E,p,V)),O=O||p),$=p.name,!I&&(p.replace&&(p.templateUrl||p.template)||p.transclude&&!p.$$tlb)){for(b=_+1;I=t[b++];)if(I.transclude&&!I.$$tlb||I.replace&&(I.templateUrl||I.template)){H=!0;break}I=!0}if(!p.templateUrl&&p.controller&&(S=S||it(),ut("'"+$+"' controller",S[$],p,V),S[$]=p),b=p.transclude)if(y=!0,p.$$tlb||(ut("transclusion",j,p,V),j=p),"element"===b)M=!0,x=p.priority,m=V,V=n.$$element=qn(z.$$createComment($,n[$])),e=V[0],$t(o,Yn.call(m,0),e),m[0].$$parentNode=m[0].parentNode,L=F(H,m,i,x,a&&a.name,{nonTlbTranscludeDirective:j});else{var J=it();if(w(b)){m=[];var Y=it(),Z=it();for(var Q in s(b,function(t,e){var n="?"===t.charAt(0);t=n?t.substring(1):t,Y[t]=e,J[e]=null,Z[e]=n}),s(V.contents(),function(t){var e=Y[Bt(N(t))];e?(Z[e]=!0,J[e]=J[e]||[],J[e].push(t)):m.push(t)}),s(Z,function(t,e){if(!t)throw Xi("reqslot",e)}),J)J[Q]&&(J[Q]=F(H,J[Q],i))}else m=qn(ft(e)).contents();V.empty(),(L=F(H,m,i,void 0,void 0,{needsNewScope:p.$$isolateScope||p.$$newScope})).$$slots=J}if(p.template)if(T=!0,ut("template",A,p,V),A=p,b=C(p.template)?p.template(V,n):p.template,b=At(b),p.replace){if(a=p,m=ki.test(b)?Jt(dt(p.templateNamespace,ai(b))):[],e=m[0],1!==m.length||1!==e.nodeType)throw Xi("tplrt",$,"");$t(o,V,e),b=W(e,[],R={$attr:{}});var tt=t.splice(_+1,t.length-(_+1));(E||O)&&rt(b,E,O),t=t.concat(b).concat(tt),at(n,R),R=t.length}else V.html(b);if(p.templateUrl)T=!0,ut("template",A,p,V),A=p,p.replace&&(a=p),d=lt(t.splice(_,t.length-_),V,n,o,y&&L,l,u,{controllerDirectives:S,newScopeDirective:O!==p&&O,newIsolateScopeDirective:E,templateDirective:A,nonTlbTranscludeDirective:j}),R=t.length;else if(p.compile)try{v=p.compile(V,n,L);var st=p.$$originalDirective||p;C(v)?f(null,D(st,v),B,G):v&&f(D(st,v.pre),D(st,v.post),B,G)}catch(t){r(t,U(V))}p.terminal&&(d.terminal=!0,x=Math.max(x,p.priority))}return d.scope=O&&!0===O.scope,d.transcludeOnThisElement=y,d.templateOnThisElement=T,d.transclude=L,h.hasElementTranscludeDirective=M,d}function et(t,e,n,i){var r;if(x(e)){var o=e.match(m);e=e.substring(o[0].length);var a=o[1]||o[3];o="?"===o[2];if("^^"===a?n=n.parent():r=(r=i&&i[e])&&r.instance,!r){var l="$"+e+"Controller";r=a?n.inheritedData(l):n.data(l)}if(!r&&!o)throw Xi("ctreq",e,t)}else if(si(e))for(r=[],a=0,o=e.length;a<o;a++)r[a]=et(t,e[a],n,i);else w(e)&&(r={},s(e,function(e,s){r[s]=et(t,e,n,i)}));return r||null}function nt(t,e,n,i,r,s,o){var a,l=it();for(a in i){var c=i[a],u={$scope:c===o||c.$$isolateScope?r:s,$element:t,$attrs:e,$transclude:n},h=c.controller;"@"===h&&(h=e[c.name]),u=O(h,u,!0,c.controllerAs),l[c.name]=u,t.data("$"+c.name+"Controller",u.instance)}return l}function rt(t,e,n){for(var i=0,r=t.length;i<r;i++)t[i]=f(t[i],{$$isolateScope:e,$$newScope:n})}function st(t,n,r,s,a,l,c){if(n===a)return null;var u=null;if(o.hasOwnProperty(n))for(var h=0,d=(a=e.get(n+"Directive")).length;h<d;h++)if(n=a[h],(g(s)||s>n.priority)&&-1!==n.restrict.indexOf(r)){if(l&&(n=f(n,{$$start:l,$$end:c})),!n.$$bindings){var p=u=n,$=n.name,m={isolateScope:null,bindToController:null};if(w(p.scope)&&(!0===p.bindToController?(m.bindToController=i(p.scope,$,!0),m.isolateScope={}):m.isolateScope=i(p.scope,$,!1)),w(p.bindToController)&&(m.bindToController=i(p.bindToController,$,!0)),m.bindToController&&!p.controller)throw Xi("noctrl",$);w((u=u.$$bindings=m).isolateScope)&&(n.$$isolateBindings=u.isolateScope)}t.push(n),u=n}return u}function ot(t){if(o.hasOwnProperty(t))for(var n=e.get(t+"Directive"),i=0,r=n.length;i<r;i++)if((t=n[i]).multiElement)return!0;return!1}function at(t,e){var n=e.$attr,i=t.$attr;s(t,function(i,r){"$"!==r.charAt(0)&&(e[r]&&e[r]!==i&&(i=i.length?i+("style"===r?";":" ")+e[r]:e[r]),t.$set(r,i,!0,n[r]))}),s(e,function(e,r){t.hasOwnProperty(r)||"$"===r.charAt(0)||(t[r]=e,"class"!==r&&"style"!==r&&(i[r]=n[r]))})}function lt(t,e,n,i,o,l,c,u){var h,d,p=[],$=e[0],m=t.shift(),g=f(m,{templateUrl:null,transclude:null,replace:null,$$originalDirective:m}),v=C(m.templateUrl)?m.templateUrl(e,n):m.templateUrl,b=m.templateNamespace;return e.empty(),a(v).then(function(r){var a,f;if(r=At(r),m.replace){if(r=ki.test(r)?Jt(dt(b,ai(r))):[],a=r[0],1!==r.length||1!==a.nodeType)throw Xi("tplrt",m.name,v);r={$attr:{}},$t(i,e,a);var x=W(a,[],r);w(m.scope)&&rt(x,!0),t=x.concat(t),at(n,r)}else a=$,e.html(r);for(t.unshift(g),h=tt(t,a,n,o,e,m,l,c,u),s(i,function(t,n){t===a&&(i[n]=e[0])}),d=B(e[0].childNodes,o);p.length;){r=p.shift(),f=p.shift();var O=p.shift(),S=p.shift();x=e[0];if(!r.$$destroyed){if(f!==$){var C=f.className;u.hasElementTranscludeDirective&&m.replace||(x=ft(a)),$t(O,qn(f),x),R(qn(x),C)}f=h.transcludeOnThisElement?J(r,h.transclude,S):S,h(d,r,x,i,f)}}p=null}).catch(function(t){t instanceof Error&&r(t)}),function(t,e,n,i,r){t=r,e.$$destroyed||(p?p.push(e,n,i,t):(h.transcludeOnThisElement&&(t=J(e,h.transclude,r)),h(d,e,n,i,t)))}}function ct(t,e){var n=e.priority-t.priority;return 0!==n?n:t.name!==e.name?t.name<e.name?-1:1:t.index-e.index}function ut(t,e,n,i){function r(t){return t?" (module: "+t+")":""}if(e)throw Xi("multidir",e.name,r(e.$$moduleName),n.name,r(n.$$moduleName),t,U(i))}function ht(t,e){var i=n(e,!0);i&&t.push({priority:0,compile:function(t){var e=!!(t=t.parent()).length;return e&&z.$$addBindingClass(t),function(t,n){var r=n.parent();e||z.$$addBindingClass(r),z.$$addBindingInfo(r,i.expressions),t.$watch(i,function(t){n[0].nodeValue=t})}}})}function dt(e,n){switch(e=Jn(e||"html")){case"svg":case"math":var i=t.document.createElement("div");return i.innerHTML="<"+e+">"+n+"</"+e+">",i.childNodes[0].childNodes;default:return n}}function pt(t,e,i,r,s){var o=function(t,e){if("srcdoc"===e)return L.HTML;var n=N(t);if("src"===e||"ngSrc"===e){if(-1===["img","video","audio","source","track"].indexOf(n))return L.RESOURCE_URL}else if("xlinkHref"===e||"form"===n&&"action"===e||"link"===n&&"href"===e)return L.RESOURCE_URL}(t,r),a=h[r]||s,l=n(i,!s,o,a);if(l){if("multiple"===r&&"select"===N(t))throw Xi("selmulti",U(t));if(b.test(r))throw Xi("nodomevents");e.push({priority:100,compile:function(){return{pre:function(t,e,s){e=s.$$observers||(s.$$observers=it());var c=s[r];c!==i&&(l=c&&n(c,!0,o,a),i=c),l&&(s[r]=l(t),(e[r]||(e[r]=[])).$$inter=!0,(s.$$observers&&s.$$observers[r].$$scope||t).$watch(l,function(t,e){"class"===r&&t!==e?s.$updateClass(t,e):s.$set(r,t)}))}}}})}}function $t(e,n,i){var r,s,o=n[0],a=n.length,l=o.parentNode;if(e)for(r=0,s=e.length;r<s;r++)if(e[r]===o){e[r++]=i,s=r+a-1;for(var c=e.length;r<c;r++,s++)s<c?e[r]=e[s]:delete e[r];e.length-=a-1,e.context===o&&(e.context=i);break}for(l&&l.replaceChild(i,o),e=t.document.createDocumentFragment(),r=0;r<a;r++)e.appendChild(n[r]);for(qn.hasData(o)&&(qn.data(i,qn.data(o)),qn(o).off("$destroy")),qn.cleanData(e.querySelectorAll("*")),r=1;r<a;r++)delete n[r];n[0]=i,n.length=1}function mt(t,e){return c(function(){return t.apply(null,arguments)},t,e)}function gt(t,e,n,i,s,o){try{t(e,n,i,s,o)}catch(t){r(t,U(n))}}function vt(t,e,i,r,o){function a(e,n,r){!C(i.$onChanges)||n===r||n!=n&&r!=r||(wt||(t.$$postDigest(_),wt=[]),c||(c={},wt.push(l)),c[e]&&(r=c[e].previousValue),c[e]=new zt(r,n))}function l(){i.$onChanges(c),c=void 0}var c,u=[],h={};return s(r,function(r,s){var l,c,f,p,m=r.attrName,g=r.optional;switch(r.mode){case"@":g||Bn.call(e,m)||(i[s]=e[m]=void 0),g=e.$observe(m,function(t){(x(t)||A(t))&&(a(s,t,i[s]),i[s]=t)}),e.$$observers[m].$$scope=t,x(l=e[m])?i[s]=n(l)(t):A(l)&&(i[s]=l),h[s]=new zt(Zi,i[s]),u.push(g);break;case"=":if(!Bn.call(e,m)){if(g)break;e[m]=void 0}if(g&&!e[m])break;c=$(e[m]),p=c.literal?M:function(t,e){return t===e||t!=t&&e!=e},f=c.assign||function(){throw l=i[s]=c(t),Xi("nonassign",e[m],m,o.name)},l=i[s]=c(t),(g=function(e){return p(e,i[s])||(p(e,l)?f(t,e=i[s]):i[s]=e),l=e}).$stateful=!0,g=r.collection?t.$watchCollection(e[m],g):t.$watch($(e[m],g),null,c.literal),u.push(g);break;case"<":if(!Bn.call(e,m)){if(g)break;e[m]=void 0}if(g&&!e[m])break;var v=(c=$(e[m])).literal,w=i[s]=c(t);h[s]=new zt(Zi,i[s]),g=t.$watch(c,function(t,e){if(e===t){if(e===w||v&&M(e,w))return;e=w}a(s,t,e),i[s]=t},v),u.push(g);break;case"&":if((c=e.hasOwnProperty(m)?$(e[m]):d)===d&&g)break;i[s]=function(e){return c(t,e)}}}),{initialChanges:h,removeWatches:u.length&&function(){for(var t=0,e=u.length;t<e;++t)u[t]()}}}var wt,bt=/^\w/,xt=t.document.createElement("div"),Ot=j,St=T,Ct=E;q.prototype={$normalize:Bt,$addClass:function(t){t&&0<t.length&&I.addClass(this.$$element,t)},$removeClass:function(t){t&&0<t.length&&I.removeClass(this.$$element,t)},$updateClass:function(t,e){var n=Gt(t,e);n&&n.length&&I.addClass(this.$$element,n),(n=Gt(e,t))&&n.length&&I.removeClass(this.$$element,n)},$set:function(t,e,n,i){var o=Pt(this.$$element[0],t),a=Mi[t],l=t;if(o?(this.$$element.prop(t,e),i=o):a&&(this[a]=e,l=a),this[t]=e,i?this.$attr[t]=i:(i=this.$attr[t])||(this.$attr[t]=i=Z(t,"-")),"a"===(o=N(this.$$element))&&("href"===t||"xlinkHref"===t)||"img"===o&&"src"===t)this[t]=e=H(e,"src"===t);else if("img"===o&&"srcset"===t&&v(e)){o="",a=ai(e);for(var c=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,u=(c=/\s/.test(a)?c:/(,)/,a=a.split(c),c=Math.floor(a.length/2),0);u<c;u++){var h=2*u;o=(o=o+H(ai(a[h]),!0))+" "+ai(a[h+1])}a=ai(a[2*u]).split(/\s/),o+=H(ai(a[0]),!0),2===a.length&&(o+=" "+ai(a[1])),this[t]=e=o}!1!==n&&(null===e||g(e)?this.$$element.removeAttr(i):bt.test(i)?this.$$element.attr(i,e):function(t,e,n){xt.innerHTML="<span "+e+">";var i=(e=xt.firstChild.attributes)[0];e.removeNamedItem(i.name),i.value=n,t.attributes.setNamedItem(i)}(this.$$element[0],i,e)),(t=this.$$observers)&&s(t[l],function(t){try{t(e)}catch(t){r(t)}})},$observe:function(t,e){var n=this,i=n.$$observers||(n.$$observers=it()),r=i[t]||(i[t]=[]);return r.push(e),V.$evalAsync(function(){r.$$inter||!n.hasOwnProperty(t)||g(n[t])||e(n[t])}),function(){y(r,e)}}};var kt=n.startSymbol(),Et=n.endSymbol(),At="{{"===kt&&"}}"===Et?p:function(t){return t.replace(/\{\{/g,kt).replace(/}}/g,Et)},jt=/^ngAttr[A-Z]/,Nt=/^(.+)Start$/;return z.$$addBindingInfo=S?function(t,e){var n=t.data("$binding")||[];si(e)?n=n.concat(e):n.push(e),t.data("$binding",n)}:d,z.$$addBindingClass=S?function(t){R(t,"ng-binding")}:d,z.$$addScopeInfo=S?function(t,e,n,i){t.data(n?i?"$isolateScopeNoTemplate":"$isolateScope":"$scope",e)}:d,z.$$addScopeClass=S?function(t,e){R(t,e?"ng-isolate-scope":"ng-scope")}:d,z.$$createComment=function(e,n){var i="";return S&&(i=" "+(e||"")+": ",n&&(i+=n+" ")),t.document.createComment(i)},z}]}function zt(t,e){this.previousValue=t,this.currentValue=e}function Bt(t){return t.replace(Qi,"").replace(Fi,at)}function Gt(t,e){var n="",i=t.split(/\s+/),r=e.split(/\s+/),s=0;t:for(;s<i.length;s++){for(var o=i[s],a=0;a<r.length;a++)if(o===r[a])continue t;n+=(0<n.length?" ":"")+o}return n}function Jt(t){var e=(t=qn(t)).length;if(1>=e)return t;for(;e--;){var n=t[e];(8===n.nodeType||n.nodeType===mi&&""===n.nodeValue.trim())&&Kn.call(t,e,1)}return t}function Wt(t,e){if(e&&x(e))return e;if(x(t)){var n=er.exec(t);if(n)return n[3]}}function Yt(){var t={},n=!1;this.has=function(e){return t.hasOwnProperty(e)},this.register=function(e,n){tt(e,"controller"),w(e)?c(t,e):t[e]=n},this.allowGlobals=function(){n=!0},this.$get=["$injector","$window",function(i,r){function s(t,n,i,r){if(!t||!w(t.$scope))throw e("$controller")("noscp",r,n);t.$scope[n]=i}return function(e,o,a,l){var u,h,f;if(a=!0===a,l&&x(l)&&(f=l),x(e)){if(!(l=e.match(er)))throw tr("ctrlfmt",e);if(h=l[1],f=f||l[3],!(e=t.hasOwnProperty(h)?t[h]:et(o.$scope,h,!0)||(n?et(r,h,!0):void 0)))throw tr("ctrlreg",h);F(e,h,!0)}return a?(a=(si(e)?e[e.length-1]:e).prototype,u=Object.create(a||null),f&&s(o,f,u,h||e.name),c(function(){var t=i.invoke(e,u,o,h);return t!==u&&(w(t)||C(t))&&(u=t,f&&s(o,f,u,h||e.name)),u},{instance:u,identifier:f})):(u=i.instantiate(e,o,h),f&&s(o,f,u,h||e.name),u)}}]}function Kt(){this.$get=["$window",function(t){return qn(t.document)}]}function Xt(){this.$get=["$document","$rootScope",function(t,e){function n(){r=i.hidden}var i=t[0],r=i&&i.hidden;return t.on("visibilitychange",n),e.$on("$destroy",function(){t.off("visibilitychange",n)}),function(){return r}}]}function Zt(){this.$get=["$log",function(t){return function(e,n){t.error.apply(t,arguments)}}]}function Qt(t){return w(t)?S(t)?t.toISOString():I(t):t}function Ft(){this.$get=function(){return function(t){if(!t)return"";var e=[];return o(t,function(t,n){null===t||g(t)||(si(t)?s(t,function(t){e.push(J(n)+"="+J(Qt(t)))}):e.push(J(n)+"="+J(Qt(t))))}),e.join("&")}}}function te(){this.$get=function(){return function(t){if(!t)return"";var e=[];return function t(n,i,r){null===n||g(n)||(si(n)?s(n,function(e,n){t(e,i+"["+(w(e)?n:"")+"]")}):w(n)&&!S(n)?o(n,function(e,n){t(e,i+(r?"":"[")+n+(r?"":"]"))}):e.push(J(i)+"="+J(Qt(n))))}(t,"",!0),e.join("&")}}}function ee(t,e){if(x(t)){var n=t.replace(ar,"").trim();if(n){var i=e("Content-Type");(i=i&&0===i.indexOf(ir))||(i=(i=n.match(sr))&&or[i[0]].test(n)),i&&(t=H(n))}}return t}function ne(t){var e,n=it();return x(t)?s(t.split("\n"),function(t){e=t.indexOf(":");var i=Jn(ai(t.substr(0,e)));t=ai(t.substr(e+1)),i&&(n[i]=n[i]?n[i]+", "+t:t)}):w(t)&&s(t,function(t,e){var i=Jn(e),r=ai(t);i&&(n[i]=n[i]?n[i]+", "+r:r)}),n}function ie(t){var e;return function(n){return e||(e=ne(t)),n?(void 0===(n=e[Jn(n)])&&(n=null),n):e}}function re(t,e,n,i){return C(i)?i(t,e,n):(s(i,function(i){t=i(t,e,n)}),t)}function se(){var t=this.defaults={transformResponse:[ee],transformRequest:[function(t){return w(t)&&"[object File]"!==Zn.call(t)&&"[object Blob]"!==Zn.call(t)&&"[object FormData]"!==Zn.call(t)?I(t):t}],headers:{common:{Accept:"application/json, text/plain, */*"},post:st(rr),put:st(rr),patch:st(rr)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer",jsonpCallbackParam:"callback"},n=!1;this.useApplyAsync=function(t){return v(t)?(n=!!t,this):n};var i=this.interceptors=[];this.$get=["$browser","$httpBackend","$$cookieReader","$cacheFactory","$rootScope","$q","$injector","$sce",function(r,o,a,l,u,h,f,p){function $(n){function i(t,e){for(var n=0,i=e.length;n<i;){var r=e[n++],s=e[n++];t=t.then(r,s)}return e.length=0,t}function o(t){var e=c({},t);return e.data=re(t.data,t.headers,t.status,a.transformResponse),200<=(t=t.status)&&300>t?e:h.reject(e)}if(!w(n))throw e("$http")("badreq",n);if(!x(p.valueOf(n.url)))throw e("$http")("badreq",n.url);var a=c({method:"get",transformRequest:t.transformRequest,transformResponse:t.transformResponse,paramSerializer:t.paramSerializer,jsonpCallbackParam:t.jsonpCallbackParam},n);a.headers=function(e){var n,i,r,o=t.headers,a=c({},e.headers);o=c({},o.common,o[Jn(e.method)]);t:for(n in o){for(r in i=Jn(n),a)if(Jn(r)===i)continue t;a[n]=o[n]}return function(t,e){var n,i={};return s(t,function(t,r){C(t)?null!=(n=t(e))&&(i[r]=n):i[r]=t}),i}(a,st(e))}(n),a.method=Wn(a.method),a.paramSerializer=x(a.paramSerializer)?f.get(a.paramSerializer):a.paramSerializer,r.$$incOutstandingRequestCount();var l=[],u=[];return n=h.resolve(a),s(O,function(t){(t.request||t.requestError)&&l.unshift(t.request,t.requestError),(t.response||t.responseError)&&u.push(t.response,t.responseError)}),n=i(n,l),(n=i(n=n.then(function(e){var n=e.headers,i=re(e.data,ie(n),void 0,e.transformRequest);return g(i)&&s(n,function(t,e){"content-type"===Jn(e)&&delete n[e]}),g(e.withCredentials)&&!g(t.withCredentials)&&(e.withCredentials=t.withCredentials),m(e,i).then(o,o)}),u)).finally(function(){r.$$completeOutstandingRequest(d)})}function m(e,i){function r(t){if(t){var e={};return s(t,function(t,i){e[i]=function(e){function i(){t(e)}n?u.$applyAsync(i):u.$$phase?i():u.$apply(i)}}),e}}function l(t,n,i,r){(200<=(n=-1<=n?n:0)&&300>n?O.resolve:O.reject)({data:t,status:n,headers:ie(i),config:e,statusText:r})}function c(t){l(t.data,t.status,st(t.headers()),t.statusText)}function f(){var t=$.pendingRequests.indexOf(e);-1!==t&&$.pendingRequests.splice(t,1)}var d,m,O=h.defer(),S=O.promise,k=e.headers,E="jsonp"===Jn(e.method),P=e.url;return E?P=p.getTrustedResourceUrl(P):x(P)||(P=p.valueOf(P)),P=function(t,e){return 0<e.length&&(t+=(-1===t.indexOf("?")?"?":"&")+e),t}(P,e.paramSerializer(e.params)),E&&(P=function(t,e){if(/[&?][^=]+=JSON_CALLBACK/.test(t))throw lr("badjsonp",t);if(new RegExp("[&?]"+e+"=").test(t))throw lr("badjsonp",e,t);return t+=(-1===t.indexOf("?")?"?":"&")+e+"=JSON_CALLBACK"}(P,e.jsonpCallbackParam)),$.pendingRequests.push(e),S.then(f,f),!e.cache&&!t.cache||!1===e.cache||"GET"!==e.method&&"JSONP"!==e.method||(d=w(e.cache)?e.cache:w(t.cache)?t.cache:b),d&&(v(m=d.get(P))?m&&C(m.then)?m.then(c,c):si(m)?l(m[1],m[0],st(m[2]),m[3]):l(m,200,{},"OK"):d.put(P,S)),g(m)&&((m=Xe(e.url)?a()[e.xsrfCookieName||t.xsrfCookieName]:void 0)&&(k[e.xsrfHeaderName||t.xsrfHeaderName]=m),o(e.method,P,i,function(t,e,i,r){function s(){l(e,t,i,r)}d&&(200<=t&&300>t?d.put(P,[t,e,ne(i),r]):d.remove(P)),n?u.$applyAsync(s):(s(),u.$$phase||u.$apply())},k,e.timeout,e.withCredentials,e.responseType,r(e.eventHandlers),r(e.uploadEventHandlers))),S}var b=l("$http");t.paramSerializer=x(t.paramSerializer)?f.get(t.paramSerializer):t.paramSerializer;var O=[];return s(i,function(t){O.unshift(x(t)?f.get(t):f.invoke(t))}),$.pendingRequests=[],function(t){s(arguments,function(t){$[t]=function(e,n){return $(c({},n||{},{method:t,url:e}))}})}("get","delete","head","jsonp"),function(t){s(arguments,function(t){$[t]=function(e,n,i){return $(c({},i||{},{method:t,url:e,data:n}))}})}("post","put","patch"),$.defaults=t,$}]}function oe(){this.$get=function(){return function(){return new t.XMLHttpRequest}}}function ae(){this.$get=["$browser","$jsonpCallbacks","$document","$xhrFactory",function(t,e,n,i){return function(t,e,n,i,r){function o(t,e,n){t=t.replace("JSON_CALLBACK",e);var s=r.createElement("script"),o=null;return s.type="text/javascript",s.src=t,s.async=!0,o=function(t){s.removeEventListener("load",o),s.removeEventListener("error",o),r.body.removeChild(s),s=null;var a=-1,l="unknown";t&&("load"!==t.type||i.wasCalled(e)||(t={type:"error"}),l=t.type,a="error"===t.type?404:200),n&&n(a,l)},s.addEventListener("load",o),s.addEventListener("error",o),r.body.appendChild(s),o}return function(r,a,l,c,u,h,f,d,p,$){function m(){b&&b(),x&&x.abort()}if(a=a||t.url(),"jsonp"===Jn(r))var w=i.createCallback(a),b=o(a,w,function(t,e){var r=200===t&&i.getResponse(w);v(O)&&n.cancel(O),b=x=null,c(t,r,"",e),i.removeCallback(w)});else{var x=e(r,a);if(x.open(r,a,!0),s(u,function(t,e){v(t)&&x.setRequestHeader(e,t)}),x.onload=function(){var t=x.statusText||"",e="response"in x?x.response:x.responseText,i=1223===x.status?204:x.status;0===i&&(i=e?200:"file"===Ke(a).protocol?404:0);var r=x.getAllResponseHeaders();v(O)&&n.cancel(O),b=x=null,c(i,e,r,t)},r=function(){v(O)&&n.cancel(O),b=x=null,c(-1,null,null,"")},x.onerror=r,x.onabort=r,x.ontimeout=r,s(p,function(t,e){x.addEventListener(e,t)}),s($,function(t,e){x.upload.addEventListener(e,t)}),f&&(x.withCredentials=!0),d)try{x.responseType=d}catch(t){if("json"!==d)throw t}x.send(g(l)?null:l)}if(0<h)var O=n(m,h);else h&&C(h.then)&&h.then(m)}}(t,i,t.defer,e,n[0])}]}function le(){var t="{{",e="}}";this.startSymbol=function(e){return e?(t=e,this):t},this.endSymbol=function(t){return t?(e=t,this):e},this.$get=["$parse","$exceptionHandler","$sce",function(n,i,r){function s(t){return"\\\\\\"+t}function o(n){return n.replace(f,t).replace(d,e)}function a(t,e,n,i){var r=t.$watch(function(t){return r(),i(t)},e,n);return r}function l(s,l,f,d){function p(t){try{var e=t;return t=f?r.getTrusted(f,e):r.valueOf(e),d&&!v(t)?t:rt(t)}catch(t){i(cr.interr(s,t))}}var m;if(!s.length||-1===s.indexOf(t))return l||((m=$(l=o(s))).exp=s,m.expressions=[],m.$$watchDelegate=a),m;d=!!d;var w,b,x=0,O=[],S=[];m=s.length;for(var k=[],E=[];x<m;){if(-1===(w=s.indexOf(t,x))||-1===(b=s.indexOf(e,w+u))){x!==m&&k.push(o(s.substring(x)));break}x!==w&&k.push(o(s.substring(x,w))),x=s.substring(w+u,b),O.push(x),S.push(n(x,p)),x=b+h,E.push(k.length),k.push("")}if(f&&1<k.length&&cr.throwNoconcat(s),!l||O.length){var P=function(t){for(var e=0,n=O.length;e<n;e++){if(d&&g(t[e]))return;k[E[e]]=t[e]}return k.join("")};return c(function(t){var e=0,n=O.length,r=Array(n);try{for(;e<n;e++)r[e]=S[e](t);return P(r)}catch(t){i(cr.interr(s,t))}},{exp:s,expressions:O,$$watchDelegate:function(t,e){var n;return t.$watchGroup(S,function(i,r){var s=P(i);C(e)&&e.call(this,s,i!==r?n:s,t),n=s})}})}}var u=t.length,h=e.length,f=new RegExp(t.replace(/./g,s),"g"),d=new RegExp(e.replace(/./g,s),"g");return l.startSymbol=function(){return t},l.endSymbol=function(){return e},l}]}function ce(){this.$get=["$rootScope","$window","$q","$$q","$browser",function(t,e,n,i,r){function s(s,a,l,c){function u(){h?s.apply(null,f):s($)}var h=4<arguments.length,f=h?Yn.call(arguments,4):[],d=e.setInterval,p=e.clearInterval,$=0,m=v(c)&&!c,g=(m?i:n).defer(),w=g.promise;return l=v(l)?l:0,w.$$intervalId=d(function(){m?r.defer(u):t.$evalAsync(u),g.notify($++),0<l&&$>=l&&(g.resolve($),p(w.$$intervalId),delete o[w.$$intervalId]),m||t.$apply()},a),o[w.$$intervalId]=g,w}var o={};return s.cancel=function(t){return!!(t&&t.$$intervalId in o)&&(o[t.$$intervalId].promise.catch(d),o[t.$$intervalId].reject("canceled"),e.clearInterval(t.$$intervalId),delete o[t.$$intervalId],!0)},s}]}function ue(t){for(var e=(t=t.split("/")).length;e--;)t[e]=G(t[e]);return t.join("/")}function he(t,e){var n=Ke(t);e.$$protocol=n.protocol,e.$$host=n.hostname,e.$$port=h(n.port)||fr[n.protocol]||null}function fe(t,e){if(pr.test(t))throw dr("badpath",t);var n="/"!==t.charAt(0);n&&(t="/"+t);var i=Ke(t);e.$$path=decodeURIComponent(n&&"/"===i.pathname.charAt(0)?i.pathname.substring(1):i.pathname),e.$$search=z(i.search),e.$$hash=decodeURIComponent(i.hash),e.$$path&&"/"!==e.$$path.charAt(0)&&(e.$$path="/"+e.$$path)}function de(t,e){return t.slice(0,e.length)===e}function pe(t,e){if(de(e,t))return e.substr(t.length)}function $e(t){var e=t.indexOf("#");return-1===e?t:t.substr(0,e)}function me(t){return t.replace(/(#.+)|#$/,"$1")}function ge(t,e,n){this.$$html5=!0,n=n||"",he(t,this),this.$$parse=function(t){var n=pe(e,t);if(!x(n))throw dr("ipthprfx",t,e);fe(n,this),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var t=B(this.$$search),n=this.$$hash?"#"+G(this.$$hash):"";this.$$url=ue(this.$$path)+(t?"?"+t:"")+n,this.$$absUrl=e+this.$$url.substr(1),this.$$urlUpdatedByLocation=!0},this.$$parseLinkUrl=function(i,r){return r&&"#"===r[0]?(this.hash(r.slice(1)),!0):(v(s=pe(t,i))?(o=s,o=n&&v(s=pe(n,s))?e+(pe("/",s)||s):t+o):v(s=pe(e,i))?o=e+s:e===i+"/"&&(o=e),o&&this.$$parse(o),!!o);var s,o}}function ve(t,e,n){he(t,this),this.$$parse=function(i){var r;g(s=pe(t,i)||pe(e,i))||"#"!==s.charAt(0)?this.$$html5?r=s:(r="",g(s)&&(t=i,this.replace())):g(r=pe(n,s))&&(r=s),fe(r,this),i=this.$$path;var s,o=/^\/[A-Z]:(\/.*)/;de(r,s=t)&&(r=r.replace(s,"")),o.exec(r)||(i=(r=o.exec(i))?r[1]:i),this.$$path=i,this.$$compose()},this.$$compose=function(){var e=B(this.$$search),i=this.$$hash?"#"+G(this.$$hash):"";this.$$url=ue(this.$$path)+(e?"?"+e:"")+i,this.$$absUrl=t+(this.$$url?n+this.$$url:""),this.$$urlUpdatedByLocation=!0},this.$$parseLinkUrl=function(e,n){return $e(t)===$e(e)&&(this.$$parse(e),!0)}}function we(t,e,n){this.$$html5=!0,ve.apply(this,arguments),this.$$parseLinkUrl=function(i,r){return r&&"#"===r[0]?(this.hash(r.slice(1)),!0):(t===$e(i)?s=i:(o=pe(e,i))?s=t+n+o:e===i+"/"&&(s=e),s&&this.$$parse(s),!!s);var s,o},this.$$compose=function(){var e=B(this.$$search),i=this.$$hash?"#"+G(this.$$hash):"";this.$$url=ue(this.$$path)+(e?"?"+e:"")+i,this.$$absUrl=t+n+this.$$url,this.$$urlUpdatedByLocation=!0}}function be(t){return function(){return this[t]}}function xe(t,e){return function(n){return g(n)?this[t]:(this[t]=e(n),this.$$compose(),this)}}function Oe(){var t="!",e={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(e){return v(e)?(t=e,this):t},this.html5Mode=function(t){return A(t)?(e.enabled=t,this):w(t)?(A(t.enabled)&&(e.enabled=t.enabled),A(t.requireBase)&&(e.requireBase=t.requireBase),(A(t.rewriteLinks)||x(t.rewriteLinks))&&(e.rewriteLinks=t.rewriteLinks),this):e},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function(n,i,r,s,o){function a(t,e,n){var r=c.url(),s=c.$$state;try{i.url(t,e,n),c.$$state=i.state()}catch(t){throw c.url(r),c.$$state=s,t}}function l(t,e){n.$broadcast("$locationChangeSuccess",c.absUrl(),t,c.$$state,e)}var c,u;u=i.baseHref();var h,f=i.url();if(e.enabled){if(!u&&e.requireBase)throw dr("nobase");h=f.substring(0,f.indexOf("/",f.indexOf("//")+2))+(u||"/"),u=r.history?ge:we}else h=$e(f),u=ve;var d=h.substr(0,$e(h).lastIndexOf("/")+1);(c=new u(h,d,"#"+t)).$$parseLinkUrl(f,f),c.$$state=i.state();var p=/^\s*(javascript|mailto):/i;s.on("click",function(t){if((a=e.rewriteLinks)&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&2!==t.which&&2!==t.button){for(var r=qn(t.target);"a"!==N(r[0]);)if(r[0]===s[0]||!(r=r.parent())[0])return;if(!x(a)||!g(r.attr(a))){var a=r.prop("href"),l=r.attr("href")||r.attr("xlink:href");w(a)&&"[object SVGAnimatedString]"===a.toString()&&(a=Ke(a.animVal).href),p.test(a)||!a||r.attr("target")||t.isDefaultPrevented()||!c.$$parseLinkUrl(a,l)||(t.preventDefault(),c.absUrl()!==i.url()&&(n.$apply(),o.angular["ff-684208-preventDefault"]=!0))}}}),me(c.absUrl())!==me(f)&&i.url(c.absUrl(),!0);var $=!0;return i.onUrlChange(function(t,e){de(t,d)?(n.$evalAsync(function(){var i,r=c.absUrl(),s=c.$$state;t=me(t),c.$$parse(t),c.$$state=e,i=n.$broadcast("$locationChangeStart",t,r,e,s).defaultPrevented,c.absUrl()===t&&(i?(c.$$parse(r),c.$$state=s,a(r,!1,s)):($=!1,l(r,s)))}),n.$$phase||n.$digest()):o.location.href=t}),n.$watch(function(){if($||c.$$urlUpdatedByLocation){c.$$urlUpdatedByLocation=!1;var t=me(i.url()),e=me(c.absUrl()),s=i.state(),o=c.$$replace,u=t!==e||c.$$html5&&r.history&&s!==c.$$state;($||u)&&($=!1,n.$evalAsync(function(){var e=c.absUrl(),i=n.$broadcast("$locationChangeStart",e,t,c.$$state,s).defaultPrevented;c.absUrl()===e&&(i?(c.$$parse(t),c.$$state=s):(u&&a(e,o,s===c.$$state?null:c.$$state),l(t,s)))}))}c.$$replace=!1}),c}]}function Se(){var t=!0,e=this;this.debugEnabled=function(e){return v(e)?(t=e,this):t},this.$get=["$window",function(n){function i(t){var e=n.console||{},i=e[t]||e.log||d;t=!1;try{t=!!i.apply}catch(t){}return t?function(){var t=[];return s(arguments,function(e){t.push(function(t){return t instanceof Error&&(t.stack&&r?t=t.message&&-1===t.stack.indexOf(t.message)?"Error: "+t.message+"\n"+t.stack:t.stack:t.sourceURL&&(t=t.message+"\n"+t.sourceURL+":"+t.line)),t}(e))}),i.apply(e,t)}:function(t,e){i(t,null==e?"":e)}}var r=_n||/\bEdge\//.test(n.navigator&&n.navigator.userAgent);return{log:i("log"),info:i("info"),warn:i("warn"),error:i("error"),debug:function(){var n=i("debug");return function(){t&&n.apply(e,arguments)}}()}}]}function Ce(t){return t+""}function ke(t,e){return void 0!==t?t:e}function Ee(t,e){return void 0===t?e:void 0===e?t:t+e}function Pe(t,e){var n,i,r;switch(t.type){case xr.Program:n=!0,s(t.body,function(t){Pe(t.expression,e),n=n&&t.expression.constant}),t.constant=n;break;case xr.Literal:t.constant=!0,t.toWatch=[];break;case xr.UnaryExpression:Pe(t.argument,e),t.constant=t.argument.constant,t.toWatch=t.argument.toWatch;break;case xr.BinaryExpression:Pe(t.left,e),Pe(t.right,e),t.constant=t.left.constant&&t.right.constant,t.toWatch=t.left.toWatch.concat(t.right.toWatch);break;case xr.LogicalExpression:Pe(t.left,e),Pe(t.right,e),t.constant=t.left.constant&&t.right.constant,t.toWatch=t.constant?[]:[t];break;case xr.ConditionalExpression:Pe(t.test,e),Pe(t.alternate,e),Pe(t.consequent,e),t.constant=t.test.constant&&t.alternate.constant&&t.consequent.constant,t.toWatch=t.constant?[]:[t];break;case xr.Identifier:t.constant=!1,t.toWatch=[t];break;case xr.MemberExpression:Pe(t.object,e),t.computed&&Pe(t.property,e),t.constant=t.object.constant&&(!t.computed||t.property.constant),t.toWatch=[t];break;case xr.CallExpression:n=r=!!t.filter&&!e(t.callee.name).$stateful,i=[],s(t.arguments,function(t){Pe(t,e),n=n&&t.constant,t.constant||i.push.apply(i,t.toWatch)}),t.constant=n,t.toWatch=r?i:[t];break;case xr.AssignmentExpression:Pe(t.left,e),Pe(t.right,e),t.constant=t.left.constant&&t.right.constant,t.toWatch=[t];break;case xr.ArrayExpression:n=!0,i=[],s(t.elements,function(t){Pe(t,e),n=n&&t.constant,t.constant||i.push.apply(i,t.toWatch)}),t.constant=n,t.toWatch=i;break;case xr.ObjectExpression:n=!0,i=[],s(t.properties,function(t){Pe(t.value,e),n=n&&t.value.constant&&!t.computed,t.value.constant||i.push.apply(i,t.value.toWatch),t.computed&&(Pe(t.key,e),t.key.constant||i.push.apply(i,t.key.toWatch))}),t.constant=n,t.toWatch=i;break;case xr.ThisExpression:t.constant=!1,t.toWatch=[];break;case xr.LocalsExpression:t.constant=!1,t.toWatch=[]}}function Ae(t){if(1===t.length){var e=(t=t[0].expression).toWatch;return 1!==e.length?e:e[0]!==t?e:void 0}}function je(t){return t.type===xr.Identifier||t.type===xr.MemberExpression}function Ne(t){if(1===t.body.length&&je(t.body[0].expression))return{type:xr.AssignmentExpression,left:t.body[0].expression,right:{type:xr.NGValueParameter},operator:"="}}function ye(t){return 0===t.body.length||1===t.body.length&&(t.body[0].expression.type===xr.Literal||t.body[0].expression.type===xr.ArrayExpression||t.body[0].expression.type===xr.ObjectExpression)}function Te(t,e){this.astBuilder=t,this.$filter=e}function Me(t,e){this.astBuilder=t,this.$filter=e}function Ve(t){return C(t.valueOf)?t.valueOf():gr.call(t)}function De(){var t,e,n=it(),i={true:!0,false:!1,null:null,undefined:void 0};this.addLiteral=function(t,e){i[t]=e},this.setIdentifierFns=function(n,i){return t=n,e=i,this},this.$get=["$filter",function(r){function o(t,e,n){return null==t||null==e?t===e:!("object"==typeof t&&!n&&(t=Ve(t),"object"==typeof t))&&(t===e||t!=t&&e!=e)}function a(t,e,n,i,r){var s;if(1===(l=i.inputs).length){var a=o,l=l[0];return t.$watch(function(t){var e=l(t);return o(e,a,i.literal)||(s=i(t,void 0,void 0,[e]),a=e&&Ve(e)),s},e,n,r)}for(var c=[],u=[],h=0,f=l.length;h<f;h++)c[h]=o,u[h]=null;return t.$watch(function(t){for(var e=!1,n=0,r=l.length;n<r;n++){var a=l[n](t);(e||(e=!o(a,c[n],i.literal)))&&(u[n]=a,c[n]=a&&Ve(a))}return e&&(s=i(t,void 0,void 0,u)),s},e,n,r)}function l(t,e,n,i,r){function s(t,n,i){l=t,C(e)&&e(t,n,i),v(t)&&i.$$postDigest(function(){v(l)&&o()})}var o,l;return o=i.inputs?a(t,s,n,i,r):t.$watch(function(t){return i(t)},s,n)}function c(t,e,n,i){function r(t){var e=!0;return s(t,function(t){v(t)||(e=!1)}),e}var o,a;return o=t.$watch(function(t){return i(t)},function(t,n,i){a=t,C(e)&&e(t,n,i),r(t)&&i.$$postDigest(function(){r(a)&&o()})},n)}function u(t,e,n,i){var r=t.$watch(function(t){return r(),i(t)},e,n);return r}function h(t,e){if(!e)return t;var n=t.$$watchDelegate,i=!1;n=n!==c&&n!==l?function(n,r,s,o){return s=i&&o?o[0]:t(n,r,s,o),e(s,n,r)}:function(n,i,r,s){return r=t(n,i,r,s),n=e(r,n,i),v(r)?n:r},i=!t.inputs;return t.$$watchDelegate&&t.$$watchDelegate!==a?(n.$$watchDelegate=t.$$watchDelegate,n.inputs=t.inputs):e.$stateful||(n.$$watchDelegate=a,n.inputs=t.inputs?t.inputs:[t]),n}var f={csp:ci().noUnsafeEval,literals:T(i),isIdentifierStart:C(t)&&t,isIdentifierContinue:C(e)&&e};return function(t,e){var i,s,o;switch(typeof t){case"string":return o=t=t.trim(),(i=n[o])||(":"===t.charAt(0)&&":"===t.charAt(1)&&(s=!0,t=t.substring(2)),i=new br(f),(i=new Or(i,r,f).parse(t)).constant?i.$$watchDelegate=u:s?i.$$watchDelegate=i.literal?c:l:i.inputs&&(i.$$watchDelegate=a),n[o]=i),h(i,e);case"function":return h(t,e);default:return h(d,e)}}}]}function Le(){var t=!0;this.$get=["$rootScope","$exceptionHandler",function(e,n){return He(function(t){e.$evalAsync(t)},n,t)}],this.errorOnUnhandledRejections=function(e){return v(e)?(t=e,this):t}}function Ie(){var t=!0;this.$get=["$browser","$exceptionHandler",function(e,n){return He(function(t){e.defer(t)},n,t)}],this.errorOnUnhandledRejections=function(e){return v(e)?(t=e,this):t}}function He(t,n,i){function r(){return new o}function o(){var t=this.promise=new a;this.resolve=function(e){h(t,e)},this.reject=function(e){f(t,e)},this.notify=function(e){p(t,e)}}function a(){this.$$state={status:0}}function l(){for(;!O&&S.length;){var t=S.shift();if(!t.pur){t.pur=!0;var e="Possibly unhandled rejection: "+("function"==typeof(e=t.value)?e.toString().replace(/ \{[\s\S]*$/,""):g(e)?"undefined":"string"!=typeof e?ot(e,void 0):e);t.value instanceof Error?n(t.value,e):n(e)}}}function u(e){!i||e.pending||2!==e.status||e.pur||(0===O&&0===S.length&&t(l),S.push(e)),!e.processScheduled&&e.pending&&(e.processScheduled=!0,++O,t(function(){var n,r,s;s=e.pending,e.processScheduled=!1,e.pending=void 0;try{for(var o=0,a=s.length;o<a;++o){e.pur=!0,r=s[o][0],n=s[o][e.status];try{C(n)?h(r,n(e.value)):1===e.status?h(r,e.value):f(r,e.value)}catch(t){f(r,t)}}}finally{--O,i&&0===O&&t(l)}}))}function h(t,e){t.$$state.status||(e===t?d(t,x("qcycle",e)):function t(e,n){function i(n){o||(o=!0,t(e,n))}function r(t){o||(o=!0,d(e,t))}var s,o=!1;try{(w(n)||C(n))&&(s=n.then),C(s)?(e.$$state.status=-1,s.call(n,function i(t){o||(o=!0,function t(e,n){function i(n){o||(o=!0,t(e,n))}function r(t){o||(o=!0,d(e,t))}var s,o=!1;try{(w(n)||C(n))&&(s=n.then),C(s)?(e.$$state.status=-1,s.call(n,i,r,function(t){p(e,t)})):(e.$$state.value=n,e.$$state.status=1,u(e.$$state))}catch(t){r(t)}}(e,t))},r,function(t){p(e,t)})):(e.$$state.value=n,e.$$state.status=1,u(e.$$state))}catch(t){r(t)}}(t,e))}function f(t,e){t.$$state.status||d(t,e)}function d(t,e){t.$$state.value=e,t.$$state.status=2,u(t.$$state)}function p(e,i){var r=e.$$state.pending;0>=e.$$state.status&&r&&r.length&&t(function(){for(var t,e,s=0,o=r.length;s<o;s++){e=r[s][0],t=r[s][3];try{p(e,C(t)?t(i):i)}catch(t){n(t)}}})}function $(t){var e=new a;return f(e,t),e}function m(t,e,n){var i=null;try{C(n)&&(i=n())}catch(t){return $(t)}return i&&C(i.then)?i.then(function(){return e(t)},$):e(t)}function v(t,e,n,i){var r=new a;return h(r,t),r.then(e,n,i)}function b(t){if(!C(t))throw x("norslvr",t);var e=new a;return t(function(t){h(e,t)},function(t){f(e,t)}),e}var x=e("$q",TypeError),O=0,S=[];c(a.prototype,{then:function(t,e,n){if(g(t)&&g(e)&&g(n))return this;var i=new a;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([i,t,e,n]),0<this.$$state.status&&u(this.$$state),i},catch:function(t){return this.then(null,t)},finally:function(t,e){return this.then(function(e){return m(e,k,t)},function(e){return m(e,$,t)},e)}});var k=v;return b.prototype=a.prototype,b.defer=r,b.reject=$,b.when=v,b.resolve=k,b.all=function(t){var e=new a,n=0,i=si(t)?[]:{};return s(t,function(t,r){n++,v(t).then(function(t){i[r]=t,--n||h(e,i)},function(t){f(e,t)})}),0===n&&h(e,i),e},b.race=function(t){var e=r();return s(t,function(t){v(t).then(e.resolve,e.reject)}),e.promise},b}function _e(){this.$get=["$window","$timeout",function(t,e){var n=t.requestAnimationFrame||t.webkitRequestAnimationFrame,i=t.cancelAnimationFrame||t.webkitCancelAnimationFrame||t.webkitCancelRequestAnimationFrame,r=!!n,s=r?function(t){var e=n(t);return function(){i(e)}}:function(t){var n=e(t,16.66,!1);return function(){e.cancel(n)}};return s.supported=r,s}]}function qe(){var t=10,n=e("$rootScope"),i=null,o=null;this.digestTtl=function(e){return arguments.length&&(t=e),t},this.$get=["$exceptionHandler","$parse","$browser",function(e,a,l){function c(t){t.currentScope.$$destroyed=!0}function u(){this.$id=++ei,this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.$root=this,this.$$destroyed=!1,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$$isolateBindings=null}function h(t){if(v.$$phase)throw n("inprog",v.$$phase);v.$$phase=t}function f(t,e){do{t.$$watchersCount+=e}while(t=t.$parent)}function p(t,e,n){do{t.$$listenerCount[n]-=e,0===t.$$listenerCount[n]&&delete t.$$listenerCount[n]}while(t=t.$parent)}function $(){}function m(){for(;O.length;)try{O.shift()()}catch(t){e(t)}o=null}u.prototype={constructor:u,$new:function(t,e){var n;return e=e||this,t?(n=new u).$root=this.$root:(this.$$ChildScope||(this.$$ChildScope=function(t){function e(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$id=++ei,this.$$ChildScope=null}return e.prototype=t,e}(this)),n=new this.$$ChildScope),n.$parent=e,n.$$prevSibling=e.$$childTail,e.$$childHead?(e.$$childTail.$$nextSibling=n,e.$$childTail=n):e.$$childHead=e.$$childTail=n,(t||e!==this)&&n.$on("$destroy",c),n},$watch:function(t,e,n,r){var s=a(t);if(s.$$watchDelegate)return s.$$watchDelegate(this,e,n,s,t);var o=this,l=o.$$watchers,c={fn:e,last:$,get:s,exp:r||t,eq:!!n};return i=null,C(e)||(c.fn=d),l||((l=o.$$watchers=[]).$$digestWatchIndex=-1),l.unshift(c),l.$$digestWatchIndex++,f(this,1),function(){var t=y(l,c);0<=t&&(f(o,-1),t<l.$$digestWatchIndex&&l.$$digestWatchIndex--),i=null}},$watchGroup:function(t,e){function n(){l=!1,c?(c=!1,e(r,r,a)):e(r,i,a)}var i=Array(t.length),r=Array(t.length),o=[],a=this,l=!1,c=!0;if(!t.length){var u=!0;return a.$evalAsync(function(){u&&e(r,r,a)}),function(){u=!1}}return 1===t.length?this.$watch(t[0],function(t,n,s){r[0]=t,i[0]=n,e(r,t===n?r:i,s)}):(s(t,function(t,e){var s=a.$watch(t,function(t,s){r[e]=t,i[e]=s,l||(l=!0,a.$evalAsync(n))});o.push(s)}),function(){for(;o.length;)o.shift()()})},$watchCollection:function(t,e){function n(t){var e,n,o;if(!g(i=t)){if(w(i))if(r(i))for(s!==f&&($=(s=f).length=0,u++),t=i.length,$!==t&&(u++,s.length=$=t),e=0;e<t;e++)o=s[e],n=i[e],o!=o&&n!=n||o===n||(u++,s[e]=n);else{for(e in s!==d&&(s=d={},$=0,u++),t=0,i)Bn.call(i,e)&&(t++,n=i[e],o=s[e],e in s?o!=o&&n!=n||o===n||(u++,s[e]=n):($++,s[e]=n,u++));if($>t)for(e in u++,s)Bn.call(i,e)||($--,delete s[e])}else s!==i&&(s=i,u++);return u}}n.$stateful=!0;var i,s,o,l=this,c=1<e.length,u=0,h=a(t,n),f=[],d={},p=!0,$=0;return this.$watch(h,function(){if(p?(p=!1,e(i,i,l)):e(i,o,l),c)if(w(i))if(r(i)){o=Array(i.length);for(var t=0;t<i.length;t++)o[t]=i[t]}else for(t in o={},i)Bn.call(i,t)&&(o[t]=i[t]);else o=i})},$digest:function(){var r,s,a,c,u,f,d,p,g=t,w=[];h("$digest"),l.$$checkUrlChange(),this===v&&null!==o&&(l.defer.cancel(o),m()),i=null;do{for(u=!1,f=this,c=0;c<b.length;c++){try{(0,(p=b[c]).fn)(p.scope,p.locals)}catch(t){e(t)}i=null}b.length=0;t:do{if(c=f.$$watchers)for(c.$$digestWatchIndex=c.length;c.$$digestWatchIndex--;)try{if(r=c[c.$$digestWatchIndex])if((s=(0,r.get)(f))===(a=r.last)||(r.eq?M(s,a):ni(s)&&ni(a))){if(r===i){u=!1;break t}}else u=!0,i=r,r.last=r.eq?T(s,null):s,(0,r.fn)(s,a===$?s:a,f),5>g&&(w[d=4-g]||(w[d]=[]),w[d].push({msg:C(r.exp)?"fn: "+(r.exp.name||r.exp.toString()):r.exp,newVal:s,oldVal:a}))}catch(t){e(t)}if(!(c=f.$$watchersCount&&f.$$childHead||f!==this&&f.$$nextSibling))for(;f!==this&&!(c=f.$$nextSibling);)f=f.$parent}while(f=c);if((u||b.length)&&!g--)throw v.$$phase=null,n("infdig",t,w)}while(u||b.length);for(v.$$phase=null;S<x.length;)try{x[S++]()}catch(t){e(t)}x.length=S=0,l.$$checkUrlChange()},$destroy:function(){if(!this.$$destroyed){var t=this.$parent;for(var e in this.$broadcast("$destroy"),this.$$destroyed=!0,this===v&&l.$$applicationDestroyed(),f(this,-this.$$watchersCount),this.$$listenerCount)p(this,this.$$listenerCount[e],e);t&&t.$$childHead===this&&(t.$$childHead=this.$$nextSibling),t&&t.$$childTail===this&&(t.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=d,this.$on=this.$watch=this.$watchGroup=function(){return d},this.$$listeners={},this.$$nextSibling=null,function t(e){9===_n&&(e.$$childHead&&t(e.$$childHead),e.$$nextSibling&&t(e.$$nextSibling)),e.$parent=e.$$nextSibling=e.$$prevSibling=e.$$childHead=e.$$childTail=e.$root=e.$$watchers=null}(this)}},$eval:function(t,e){return a(t)(this,e)},$evalAsync:function(t,e){v.$$phase||b.length||l.defer(function(){b.length&&v.$digest()}),b.push({scope:this,fn:a(t),locals:e})},$$postDigest:function(t){x.push(t)},$apply:function(t){try{h("$apply");try{return this.$eval(t)}finally{v.$$phase=null}}catch(t){e(t)}finally{try{v.$digest()}catch(t){throw e(t),t}}},$applyAsync:function(t){var e=this;t&&O.push(function(){e.$eval(t)}),t=a(t),null===o&&(o=l.defer(function(){v.$apply(m)}))},$on:function(t,e){var n=this.$$listeners[t];n||(this.$$listeners[t]=n=[]),n.push(e);var i=this;do{i.$$listenerCount[t]||(i.$$listenerCount[t]=0),i.$$listenerCount[t]++}while(i=i.$parent);var r=this;return function(){var i=n.indexOf(e);-1!==i&&(n[i]=null,p(r,1,t))}},$emit:function(t,n){var i,r,s,o=[],a=this,l=!1,c={name:t,targetScope:a,stopPropagation:function(){l=!0},preventDefault:function(){c.defaultPrevented=!0},defaultPrevented:!1},u=V([c],arguments,1);do{for(i=a.$$listeners[t]||o,c.currentScope=a,r=0,s=i.length;r<s;r++)if(i[r])try{i[r].apply(null,u)}catch(t){e(t)}else i.splice(r,1),r--,s--;if(l)return c.currentScope=null,c;a=a.$parent}while(a);return c.currentScope=null,c},$broadcast:function(t,n){var i=this,r=this,s={name:t,targetScope:this,preventDefault:function(){s.defaultPrevented=!0},defaultPrevented:!1};if(!this.$$listenerCount[t])return s;for(var o,a,l=V([s],arguments,1);i=r;){for(s.currentScope=i,o=0,a=(r=i.$$listeners[t]||[]).length;o<a;o++)if(r[o])try{r[o].apply(null,l)}catch(t){e(t)}else r.splice(o,1),o--,a--;if(!(r=i.$$listenerCount[t]&&i.$$childHead||i!==this&&i.$$nextSibling))for(;i!==this&&!(r=i.$$nextSibling);)i=i.$parent}return s.currentScope=null,s}};var v=new u,b=v.$$asyncQueue=[],x=v.$$postDigestQueue=[],O=v.$$applyAsyncQueue=[],S=0;return v}]}function Ue(){var t=/^\s*(https?|ftp|mailto|tel|file):/,e=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(e){return v(e)?(t=e,this):t},this.imgSrcSanitizationWhitelist=function(t){return v(t)?(e=t,this):e},this.$get=function(){return function(n,i){var r,s=i?e:t;return""===(r=Ke(n).href)||r.match(s)?n:"unsafe:"+r}}}function Re(t){var e=[];return v(t)&&s(t,function(t){e.push(function(t){if("self"===t)return t;if(x(t)){if(-1<t.indexOf("***"))throw Sr("iwcard",t);return t=li(t).replace(/\\\*\\\*/g,".*").replace(/\\\*/g,"[^:/.?&;]*"),new RegExp("^"+t+"$")}if(k(t))return new RegExp("^"+t.source+"$");throw Sr("imatcher")}(t))}),e}function ze(){this.SCE_CONTEXTS=Cr;var t=["self"],e=[];this.resourceUrlWhitelist=function(e){return arguments.length&&(t=Re(e)),t},this.resourceUrlBlacklist=function(t){return arguments.length&&(e=Re(t)),e},this.$get=["$injector",function(n){function i(t,e){return"self"===t?Xe(e):!!t.exec(e.href)}function r(t){var e=function(t){this.$$unwrapTrustedValue=function(){return t}};return t&&(e.prototype=new t),e.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},e.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},e}var s=function(t){throw Sr("unsafe")};n.has("$sanitize")&&(s=n.get("$sanitize"));var o=r(),a={};return a[Cr.HTML]=r(o),a[Cr.CSS]=r(o),a[Cr.URL]=r(o),a[Cr.JS]=r(o),a[Cr.RESOURCE_URL]=r(a[Cr.URL]),{trustAs:function(t,e){var n=a.hasOwnProperty(t)?a[t]:null;if(!n)throw Sr("icontext",t,e);if(null===e||g(e)||""===e)return e;if("string"!=typeof e)throw Sr("itype",t);return new n(e)},getTrusted:function(n,r){if(null===r||g(r)||""===r)return r;if((c=a.hasOwnProperty(n)?a[n]:null)&&r instanceof c)return r.$$unwrapTrustedValue();if(n===Cr.RESOURCE_URL){var o,l,c=Ke(r.toString()),u=!1;for(o=0,l=t.length;o<l;o++)if(i(t[o],c)){u=!0;break}if(u)for(o=0,l=e.length;o<l;o++)if(i(e[o],c)){u=!1;break}if(u)return r;throw Sr("insecurl",r.toString())}if(n===Cr.HTML)return s(r);throw Sr("unsafe")},valueOf:function(t){return t instanceof o?t.$$unwrapTrustedValue():t}}}]}function Be(){var t=!0;this.enabled=function(e){return arguments.length&&(t=!!e),t},this.$get=["$parse","$sceDelegate",function(e,n){if(t&&8>_n)throw Sr("iequirks");var i=st(Cr);i.isEnabled=function(){return t},i.trustAs=n.trustAs,i.getTrusted=n.getTrusted,i.valueOf=n.valueOf,t||(i.trustAs=i.getTrusted=function(t,e){return e},i.valueOf=p),i.parseAs=function(t,n){var r=e(n);return r.literal&&r.constant?r:e(n,function(e){return i.getTrusted(t,e)})};var r=i.parseAs,o=i.getTrusted,a=i.trustAs;return s(Cr,function(t,e){var n=Jn(e);i[("parse_as_"+n).replace(kr,at)]=function(e){return r(t,e)},i[("get_trusted_"+n).replace(kr,at)]=function(e){return o(t,e)},i[("trust_as_"+n).replace(kr,at)]=function(e){return a(t,e)}}),i}]}function Ge(){this.$get=["$window","$document",function(t,e){var n={},i=!((!t.nw||!t.nw.process)&&t.chrome&&(t.chrome.app&&t.chrome.app.runtime||!t.chrome.app&&t.chrome.runtime&&t.chrome.runtime.id))&&t.history&&t.history.pushState,r=h((/android (\d+)/.exec(Jn((t.navigator||{}).userAgent))||[])[1]),s=/Boxee/i.test((t.navigator||{}).userAgent),o=e[0]||{},a=o.body&&o.body.style,l=!1,c=!1;return a&&(l=!!("transition"in a||"webkitTransition"in a),c=!!("animation"in a||"webkitAnimation"in a)),{history:!(!i||4>r||s),hasEvent:function(t){if("input"===t&&_n)return!1;if(g(n[t])){var e=o.createElement("div");n[t]="on"+t in e}return n[t]},csp:ci(),transitions:l,animations:c,android:r}}]}function Je(){var t;this.httpOptions=function(e){return e?(t=e,this):t},this.$get=["$exceptionHandler","$templateCache","$http","$q","$sce",function(e,n,i,r,s){function o(a,l){o.totalPendingRequests++,x(a)&&!g(n.get(a))||(a=s.getTrustedResourceUrl(a));var u=i.defaults&&i.defaults.transformResponse;return si(u)?u=u.filter(function(t){return t!==ee}):u===ee&&(u=null),i.get(a,c({cache:n,transformResponse:u},t)).finally(function(){o.totalPendingRequests--}).then(function(t){return n.put(a,t.data),t.data},function(t){return l||(t=Er("tpload",a,t.status,t.statusText),e(t)),r.reject(t)})}return o.totalPendingRequests=0,o}]}function We(){this.$get=["$rootScope","$browser","$location",function(t,e,n){return{findBindings:function(t,e,n){t=t.getElementsByClassName("ng-binding");var i=[];return s(t,function(t){var r=ti.element(t).data("$binding");r&&s(r,function(r){n?new RegExp("(^|\\s)"+li(e)+"(\\s|\\||$)").test(r)&&i.push(t):-1!==r.indexOf(e)&&i.push(t)})}),i},findModels:function(t,e,n){for(var i=["ng-","data-ng-","ng\\:"],r=0;r<i.length;++r){var s=t.querySelectorAll("["+i[r]+"model"+(n?"=":"*=")+'"'+e+'"]');if(s.length)return s}},getLocation:function(){return n.url()},setLocation:function(e){e!==n.url()&&(n.url(e),t.$digest())},whenStable:function(t){e.notifyWhenNoOutstandingRequests(t)}}}]}function Ye(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function(t,e,n,i,r){function s(s,a,l){C(s)||(l=a,a=s,s=d);var c,u=Yn.call(arguments,3),h=v(l)&&!l,f=(h?i:n).defer(),p=f.promise;return c=e.defer(function(){try{f.resolve(s.apply(null,u))}catch(t){f.reject(t),r(t)}finally{delete o[p.$$timeoutId]}h||t.$apply()},a),p.$$timeoutId=c,o[c]=f,p}var o={};return s.cancel=function(t){return!!(t&&t.$$timeoutId in o)&&(o[t.$$timeoutId].promise.catch(d),o[t.$$timeoutId].reject("canceled"),delete o[t.$$timeoutId],e.defer.cancel(t.$$timeoutId))},s}]}function Ke(t){return _n&&(Pr.setAttribute("href",t),t=Pr.href),Pr.setAttribute("href",t),{href:Pr.href,protocol:Pr.protocol?Pr.protocol.replace(/:$/,""):"",host:Pr.host,search:Pr.search?Pr.search.replace(/^\?/,""):"",hash:Pr.hash?Pr.hash.replace(/^#/,""):"",hostname:Pr.hostname,port:Pr.port,pathname:"/"===Pr.pathname.charAt(0)?Pr.pathname:"/"+Pr.pathname}}function Xe(t){return(t=x(t)?Ke(t):t).protocol===Ar.protocol&&t.host===Ar.host}function Ze(){this.$get=$(t)}function Qe(t){function e(t){try{return decodeURIComponent(t)}catch(e){return t}}var n=t[0]||{},i={},r="";return function(){var t,s,o,a,l;try{t=n.cookie||""}catch(e){t=""}if(t!==r)for(t=(r=t).split("; "),i={},o=0;o<t.length;o++)0<(a=(s=t[o]).indexOf("="))&&(l=e(s.substring(0,a)),g(i[l])&&(i[l]=e(s.substring(a+1))));return i}}function Fe(){this.$get=Qe}function tn(t){function e(n,i){if(w(n)){var r={};return s(n,function(t,n){r[n]=e(n,t)}),r}return t.factory(n+"Filter",i)}this.register=e,this.$get=["$injector",function(t){return function(e){return t.get(e+"Filter")}}],e("currency",sn),e("date",pn),e("filter",en),e("json",$n),e("limitTo",mn),e("lowercase",Dr),e("number",on),e("orderBy",vn),e("uppercase",Lr)}function en(){return function(t,n,i,s){if(!r(t)){if(null==t)return t;throw e("filter")("notarray",t)}var o;switch(s=s||"$",rn(n)){case"function":break;case"boolean":case"null":case"number":case"string":o=!0;case"object":n=function(t,e,n,i){var r=w(t)&&n in t;return!0===e?e=M:C(e)||(e=function(t,e){return!(g(t)||(null===t||null===e?t!==e:w(e)||w(t)&&!m(t)||(t=Jn(""+t),e=Jn(""+e),-1===t.indexOf(e))))}),function(s){return r&&!w(s)?nn(s,t[n],e,n,!1):nn(s,t,e,n,i)}}(n,i,s,o);break;default:return t}return Array.prototype.filter.call(t,n)}}function nn(t,e,n,i,r,s){var o=rn(t),a=rn(e);if("string"===a&&"!"===e.charAt(0))return!nn(t,e.substring(1),n,i,r);if(si(t))return t.some(function(t){return nn(t,e,n,i,r)});switch(o){case"object":var l;if(r){for(l in t)if(l.charAt&&"$"!==l.charAt(0)&&nn(t[l],e,n,i,!0))return!0;return!s&&nn(t,e,n,i,!1)}if("object"===a){for(l in e)if(!C(s=e[l])&&!g(s)&&!nn((o=l===i)?t:t[l],s,n,i,o,o))return!1;return!0}return n(t,e);case"function":return!1;default:return n(t,e)}}function rn(t){return null===t?"null":typeof t}function sn(t){var e=t.NUMBER_FORMATS;return function(t,n,i){return g(n)&&(n=e.CURRENCY_SYM),g(i)&&(i=e.PATTERNS[1].maxFrac),null==t?t:an(t,e.PATTERNS[1],e.GROUP_SEP,e.DECIMAL_SEP,i).replace(/\u00A4/g,n)}}function on(t){var e=t.NUMBER_FORMATS;return function(t,n){return null==t?t:an(t,e.PATTERNS[0],e.GROUP_SEP,e.DECIMAL_SEP,n)}}function an(t,e,n,i,r){if(!x(t)&&!O(t)||isNaN(t))return"";var s=!isFinite(t),o=!1,a=Math.abs(t)+"",l="";if(s)l="∞";else{for(function(t,e,n,i){var r=t.d,s=r.length-t.i;if(i=r[n=(e=g(e)?Math.min(Math.max(n,s),i):+e)+t.i],0<n){r.splice(Math.max(t.i,n));for(var o=n;o<r.length;o++)r[o]=0}else for(s=Math.max(0,s),t.i=1,r.length=Math.max(1,n=e+1),r[0]=0,o=1;o<n;o++)r[o]=0;if(5<=i)if(0>n-1){for(i=0;i>n;i--)r.unshift(0),t.i++;r.unshift(1),t.i++}else r[n-1]++;for(;s<Math.max(0,e);s++)r.push(0);(e=r.reduceRight(function(t,e,n,i){return e+=t,i[n]=e%10,Math.floor(e/10)},0))&&(r.unshift(e),t.i++)}(o=function(t){var e,n,i,r,s,o=0;for(-1<(n=t.indexOf(Nr))&&(t=t.replace(Nr,"")),0<(i=t.search(/e/i))?(0>n&&(n=i),n+=+t.slice(i+1),t=t.substring(0,i)):0>n&&(n=t.length),i=0;t.charAt(i)===yr;i++);if(i===(s=t.length))e=[0],n=1;else{for(s--;t.charAt(s)===yr;)s--;for(n-=i,e=[],r=0;i<=s;i++,r++)e[r]=+t.charAt(i)}return n>jr&&(e=e.splice(0,jr-1),o=n-1,n=1),{d:e,e:o,i:n}}(a),r,e.minFrac,e.maxFrac),l=o.d,a=o.i,r=o.e,s=[],o=l.reduce(function(t,e){return t&&!e},!0);0>a;)l.unshift(0),a++;for(0<a?s=l.splice(a,l.length):(s=l,l=[0]),a=[],l.length>=e.lgSize&&a.unshift(l.splice(-e.lgSize,l.length).join(""));l.length>e.gSize;)a.unshift(l.splice(-e.gSize,l.length).join(""));l.length&&a.unshift(l.join("")),l=a.join(n),s.length&&(l+=i+s.join("")),r&&(l+="e+"+r)}return 0>t&&!o?e.negPre+l+e.negSuf:e.posPre+l+e.posSuf}function ln(t,e,n,i){var r="";for((0>t||i&&0>=t)&&(i?t=1-t:(t=-t,r="-")),t=""+t;t.length<e;)t=yr+t;return n&&(t=t.substr(t.length-e)),r+t}function cn(t,e,n,i,r){return n=n||0,function(s){return s=s["get"+t](),(0<n||s>-n)&&(s+=n),0===s&&-12===n&&(s=12),ln(s,e,i,r)}}function un(t,e,n){return function(i,r){var s=i["get"+t]();return r[Wn((n?"STANDALONE":"")+(e?"SHORT":"")+t)][s]}}function hn(t){var e=new Date(t,0,1).getDay();return new Date(t,0,(4>=e?5:12)-e)}function fn(t){return function(e){var n=hn(e.getFullYear());return e=+new Date(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))-+n,ln(e=1+Math.round(e/6048e5),t)}}function dn(t,e){return 0>=t.getFullYear()?e.ERAS[0]:e.ERAS[1]}function pn(t){function e(t){var e;if(e=t.match(n)){t=new Date(0);var i=0,r=0,s=e[8]?t.setUTCFullYear:t.setFullYear,o=e[8]?t.setUTCHours:t.setHours;e[9]&&(i=h(e[9]+e[10]),r=h(e[9]+e[11])),s.call(t,h(e[1]),h(e[2])-1,h(e[3])),i=h(e[4]||0)-i,r=h(e[5]||0)-r,s=h(e[6]||0),e=Math.round(1e3*parseFloat("0."+(e[7]||0))),o.call(t,i,r,s,e)}return t}var n=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(n,i,r){var o,a,l="",c=[];if(i=i||"mediumDate",i=t.DATETIME_FORMATS[i]||i,x(n)&&(n=Vr.test(n)?h(n):e(n)),O(n)&&(n=new Date(n)),!S(n)||!isFinite(n.getTime()))return n;for(;i;)(a=Mr.exec(i))?i=(c=V(c,a,1)).pop():(c.push(i),i=null);var u=n.getTimezoneOffset();return r&&(u=_(r,u),n=q(n,r,!0)),s(c,function(e){o=Tr[e],l+=o?o(n,t.DATETIME_FORMATS,u):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}}function $n(){return function(t,e){return g(e)&&(e=2),I(t,e)}}function mn(){return function(t,e,n){return e=1/0===Math.abs(Number(e))?Number(e):h(e),ni(e)?t:(O(t)&&(t=t.toString()),r(t)?(n=0>(n=!n||isNaN(n)?0:h(n))?Math.max(0,t.length+n):n,0<=e?gn(t,n,n+e):0===n?gn(t,e,t.length):gn(t,Math.max(0,n+e),n)):t)}}function gn(t,e,n){return x(t)?t.slice(e,n):Yn.call(t,e,n)}function vn(t){function n(e){return e.map(function(e){var n=1,i=p;if(C(e))i=e;else if(x(e)&&("+"!==e.charAt(0)&&"-"!==e.charAt(0)||(n="-"===e.charAt(0)?-1:1,e=e.substring(1)),""!==e&&(i=t(e)).constant)){var r=i();i=function(t){return t[r]}}return{get:i,descending:n}})}function i(t){switch(typeof t){case"number":case"boolean":case"string":return!0;default:return!1}}function s(t,e){var n=0,i=t.type;if(i===(r=e.type)){var r=t.value,s=e.value;"string"===i?(r=r.toLowerCase(),s=s.toLowerCase()):"object"===i&&(w(r)&&(r=t.index),w(s)&&(s=e.index)),r!==s&&(n=r<s?-1:1)}else n=i<r?-1:1;return n}return function(t,o,a,l){if(null==t)return t;if(!r(t))throw e("orderBy")("notarray",t);si(o)||(o=[o]),0===o.length&&(o=["+"]);var c=n(o),u=a?-1:1,h=C(l)?l:s;return(t=Array.prototype.map.call(t,function(t,e){return{value:t,tieBreaker:{value:e,type:"number",index:e},predicateValues:c.map(function(n){var r=n.get(t);return n=typeof r,null===r?(n="string",r="null"):"object"===n&&(C(r.valueOf)&&i(r=r.valueOf())||m(r)&&i(r=r.toString())),{value:r,type:n,index:e}})}})).sort(function(t,e){for(var n=0,i=c.length;n<i;n++){var r=h(t.predicateValues[n],e.predicateValues[n]);if(r)return r*c[n].descending*u}return h(t.tieBreaker,e.tieBreaker)*u}),t.map(function(t){return t.value})}}function wn(t){return C(t)&&(t={link:t}),t.restrict=t.restrict||"AC",$(t)}function bn(t,e,n,i,r){this.$$controls=[],this.$error={},this.$$success={},this.$pending=void 0,this.$name=r(e.name||e.ngForm||"")(n),this.$dirty=!1,this.$valid=this.$pristine=!0,this.$submitted=this.$invalid=!1,this.$$parentForm=_r,this.$$element=t,this.$$animate=i,xn(this)}function xn(t){t.$$classCache={},t.$$classCache[bs]=!(t.$$classCache[ws]=t.$$element.hasClass(ws))}function On(t){function e(t,e,n){n&&!t.$$classCache[e]?(t.$$animate.addClass(t.$$element,e),t.$$classCache[e]=!0):!n&&t.$$classCache[e]&&(t.$$animate.removeClass(t.$$element,e),t.$$classCache[e]=!1)}function n(t,n,i){n=n?"-"+Z(n,"-"):"",e(t,ws+n,!0===i),e(t,bs+n,!1===i)}var i=t.set,r=t.unset;t.clazz.prototype.$setValidity=function(t,s,o){g(s)?(this.$pending||(this.$pending={}),i(this.$pending,t,o)):(this.$pending&&r(this.$pending,t,o),Sn(this.$pending)&&(this.$pending=void 0)),A(s)?s?(r(this.$error,t,o),i(this.$$success,t,o)):(i(this.$error,t,o),r(this.$$success,t,o)):(r(this.$error,t,o),r(this.$$success,t,o)),this.$pending?(e(this,"ng-pending",!0),this.$valid=this.$invalid=void 0,n(this,"",null)):(e(this,"ng-pending",!1),this.$valid=Sn(this.$error),this.$invalid=!this.$valid,n(this,"",this.$valid)),n(this,t,s=this.$pending&&this.$pending[t]?void 0:!this.$error[t]&&(!!this.$$success[t]||null)),this.$$parentForm.$setValidity(t,s,this)}}function Sn(t){if(t)for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function Cn(t){t.$formatters.push(function(e){return t.$isEmpty(e)?e:e.toString()})}function kn(t,e,n,i,r,s){var o=Jn(e[0].type);if(!r.android){var a=!1;e.on("compositionstart",function(){a=!0}),e.on("compositionend",function(){a=!1,c()})}var l,c=function(t){if(l&&(s.defer.cancel(l),l=null),!a){var r=e.val();t=t&&t.type,"password"===o||n.ngTrim&&"false"===n.ngTrim||(r=ai(r)),(i.$viewValue!==r||""===r&&i.$$hasNativeValidators)&&i.$setViewValue(r,t)}};if(r.hasEvent("input"))e.on("input",c);else{var u=function(t,e,n){l||(l=s.defer(function(){l=null,e&&e.value===n||c(t)}))};e.on("keydown",function(t){var e=t.keyCode;91===e||15<e&&19>e||37<=e&&40>=e||u(t,this,this.value)}),r.hasEvent("paste")&&e.on("paste cut",u)}e.on("change",c),Qr[o]&&i.$$hasNativeValidators&&o===n.type&&e.on("keydown wheel mousedown",function(t){if(!l){var e=this.validity,n=e.badInput,i=e.typeMismatch;l=s.defer(function(){l=null,e.badInput===n&&e.typeMismatch===i||c(t)})}}),i.$render=function(){var t=i.$isEmpty(i.$viewValue)?"":i.$viewValue;e.val()!==t&&e.val(t)}}function En(t,e){return function(n,i){var r,o;if(S(n))return n;if(x(n)){if('"'===n.charAt(0)&&'"'===n.charAt(n.length-1)&&(n=n.substring(1,n.length-1)),zr.test(n))return new Date(n);if(t.lastIndex=0,r=t.exec(n))return r.shift(),o=i?{yyyy:i.getFullYear(),MM:i.getMonth()+1,dd:i.getDate(),HH:i.getHours(),mm:i.getMinutes(),ss:i.getSeconds(),sss:i.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},s(r,function(t,n){n<e.length&&(o[e[n]]=+t)}),new Date(o.yyyy,o.MM-1,o.dd,o.HH,o.mm,o.ss||0,1e3*o.sss||0)}return NaN}}function Pn(t,e,n,i){return function(r,s,o,a,l,c,u){function h(t){return t&&!(t.getTime&&t.getTime()!=t.getTime())}function f(t){return v(t)&&!S(t)?n(t)||void 0:t}An(r,s,o,a),kn(0,s,o,a,l,c);var d,p,$,m=a&&a.$options.getOption("timezone");(a.$$parserName=t,a.$parsers.push(function(t){return a.$isEmpty(t)?null:e.test(t)?(t=n(t,d),m&&(t=q(t,m)),t):void 0}),a.$formatters.push(function(t){if(t&&!S(t))throw Ss("datefmt",t);return h(t)?((d=t)&&m&&(d=q(d,m,!0)),u("date")(t,i,m)):(d=null,"")}),v(o.min)||o.ngMin)&&(a.$validators.min=function(t){return!h(t)||g(p)||n(t)>=p},o.$observe("min",function(t){p=f(t),a.$validate()}));(v(o.max)||o.ngMax)&&(a.$validators.max=function(t){return!h(t)||g($)||n(t)<=$},o.$observe("max",function(t){$=f(t),a.$validate()}))}}function An(t,e,n,i){(i.$$hasNativeValidators=w(e[0].validity))&&i.$parsers.push(function(t){var n=e.prop("validity")||{};return n.badInput||n.typeMismatch?void 0:t})}function jn(t){t.$$parserName="number",t.$parsers.push(function(e){return t.$isEmpty(e)?null:Jr.test(e)?parseFloat(e):void 0}),t.$formatters.push(function(e){if(!t.$isEmpty(e)){if(!O(e))throw Ss("numfmt",e);e=e.toString()}return e})}function Nn(t){return v(t)&&!O(t)&&(t=parseFloat(t)),ni(t)?void 0:t}function yn(t){var e=t.toString(),n=e.indexOf(".");return-1===n?-1<t&&1>t&&(t=/e-(\d+)$/.exec(e))?Number(t[1]):0:e.length-n-1}function Tn(t,e,n){var i=(0|(t=Number(t)))!==t,r=(0|e)!==e,s=(0|n)!==n;if(i||r||s){var o=i?yn(t):0,a=r?yn(e):0,l=s?yn(n):0;o=Math.max(o,a,l);t*=o=Math.pow(10,o),e*=o,n*=o,i&&(t=Math.round(t)),r&&(e=Math.round(e)),s&&(n=Math.round(n))}return 0==(t-e)%n}function Mn(t,e,n,i,r){if(v(i)){if(!(t=t(i)).constant)throw Ss("constexpr",n,i);return t(e)}return r}function Vn(t,e){function n(t,e){if(!t||!t.length)return[];if(!e||!e.length)return t;var n=[],i=0;t:for(;i<t.length;i++){for(var r=t[i],s=0;s<e.length;s++)if(r===e[s])continue t;n.push(r)}return n}function i(t){var e=t;return si(t)?e=t.map(i).join(" "):w(t)&&(e=Object.keys(t).filter(function(e){return t[e]}).join(" ")),e}function r(t){var e=t;if(si(t))e=t.map(r);else if(w(t)){var n=!1;e=Object.keys(t).filter(function(e){return e=t[e],!n&&g(e)&&(n=!0),e});n&&e.push(void 0)}return e}var o;return t="ngClass"+t,["$parse",function(a){return{restrict:"AC",link:function(l,c,u){function h(t,e){var n=[];return s(t,function(t){(0<e||g[t])&&(g[t]=(g[t]||0)+e,g[t]===+(0<e)&&n.push(t))}),n.join(" ")}function f(t){if(v===e){var i=d&&d.split(" "),r=t&&t.split(" "),s=n(i,r);i=n(r,i),s=h(s,-1),i=h(i,1);u.$addClass(i),u.$removeClass(s)}d=t}var d,p=":"===($=u[t].trim()).charAt(0)&&":"===$.charAt(1),$=a($,p?r:i),m=p?function(t){(t=i(t))!==d&&f(t)}:f,g=c.data("$classCounts"),v=!0;g||(g=it(),c.data("$classCounts",g)),"ngClass"!==t&&(o||(o=a("$index",function(t){return 1&t})),l.$watch(o,function(t){if(t===e){var n=h((n=d)&&n.split(" "),1);u.$addClass(n)}else n=h((n=d)&&n.split(" "),-1),u.$removeClass(n);v=t})),l.$watch($,m,p)}}}]}function Dn(t,e,n,i,r,s,o,a,l){this.$modelValue=this.$viewValue=Number.NaN,this.$$rawModelValue=void 0,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=void 0,this.$name=l(n.name||"",!1)(t),this.$$parentForm=_r,this.$options=Cs,this.$$parsedNgModel=r(n.ngModel),this.$$parsedNgModelAssign=this.$$parsedNgModel.assign,this.$$ngModelGet=this.$$parsedNgModel,this.$$ngModelSet=this.$$parsedNgModelAssign,this.$$pendingDebounce=null,this.$$parserValid=void 0,this.$$currentValidationRunId=0,this.$$scope=t,this.$$attr=n,this.$$element=i,this.$$animate=s,this.$$timeout=o,this.$$parse=r,this.$$q=a,this.$$exceptionHandler=e,xn(this),function(t){t.$$scope.$watch(function(){var e=t.$$ngModelGet(t.$$scope);if(e!==t.$modelValue&&(t.$modelValue==t.$modelValue||e==e)){t.$modelValue=t.$$rawModelValue=e,t.$$parserValid=void 0;for(var n=t.$formatters,i=n.length,r=e;i--;)r=n[i](r);t.$viewValue!==r&&(t.$$updateEmptyClasses(r),t.$viewValue=t.$$lastCommittedViewValue=r,t.$render(),t.$$runValidators(t.$modelValue,t.$viewValue,d))}return e})}(this)}function Ln(t){this.$$options=t}function In(t,e){s(e,function(e,n){v(t[n])||(t[n]=e)})}function Hn(t,e){t.prop("selected",e),t.attr("selected",e)}var _n,qn,Un,Rn,zn=/^\/(.+)\/([a-z]*)$/,Bn=Object.prototype.hasOwnProperty,Gn={objectMaxDepth:5},Jn=function(t){return x(t)?t.toLowerCase():t},Wn=function(t){return x(t)?t.toUpperCase():t},Yn=[].slice,Kn=[].splice,Xn=[].push,Zn=Object.prototype.toString,Qn=Object.getPrototypeOf,Fn=e("ng"),ti=t.angular||(t.angular={}),ei=0;_n=t.document.documentMode;var ni=Number.isNaN||function(t){return t!=t};d.$inject=[],p.$inject=[];var ii,ri,si=Array.isArray,oi=/^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array]$/,ai=function(t){return x(t)?t.trim():t},li=function(t){return t.replace(/([-()[\]{}+?*.$^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},ci=function(){if(!v(ci.rules)){var e=t.document.querySelector("[ng-csp]")||t.document.querySelector("[data-ng-csp]");if(e){var n=e.getAttribute("ng-csp")||e.getAttribute("data-ng-csp");ci.rules={noUnsafeEval:!n||-1!==n.indexOf("no-unsafe-eval"),noInlineStyle:!n||-1!==n.indexOf("no-inline-style")}}else{e=ci;try{new Function(""),n=!1}catch(t){n=!0}e.rules={noUnsafeEval:n,noInlineStyle:!1}}}return ci.rules},ui=function(){if(v(ui.name_))return ui.name_;var e,n,i,r,s=fi.length;for(n=0;n<s;++n)if(i=fi[n],e=t.document.querySelector("["+i.replace(":","\\:")+"jq]")){r=e.getAttribute(i+"jq");break}return ui.name_=r},hi=/:/g,fi=["ng-","data-ng-","ng:","x-ng-"],di=(ii=t.document,!(ri=ii.currentScript)||(ri instanceof t.HTMLScriptElement||ri instanceof t.SVGScriptElement)&&[(ri=ri.attributes).getNamedItem("src"),ri.getNamedItem("href"),ri.getNamedItem("xlink:href")].every(function(t){if(!t)return!0;if(!t.value)return!1;var e=ii.createElement("a");if(e.href=t.value,ii.location.origin===e.origin)return!0;switch(e.protocol){case"http:":case"https:":case"ftp:":case"blob:":case"file:":case"data:":return!0;default:return!1}})),pi=/[A-Z]/g,$i=!1,mi=3,gi={full:"1.6.3",major:1,minor:6,dot:3,codeName:"scriptalicious-bootstrapping"};ht.expando="ng339";var vi=ht.cache={},wi=1;ht._data=function(t){return this.cache[t[this.expando]]||{}};var bi=/-([a-z])/g,xi=/^-ms-/,Oi={mouseleave:"mouseout",mouseenter:"mouseover"},Si=e("jqLite"),Ci=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,ki=/<|&#?\w+;/,Ei=/<([\w:-]+)/,Pi=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,Ai={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ai.optgroup=Ai.option,Ai.tbody=Ai.tfoot=Ai.colgroup=Ai.caption=Ai.thead,Ai.th=Ai.td;var ji=t.Node.prototype.contains||function(t){return!!(16&this.compareDocumentPosition(t))},Ni=ht.prototype={ready:Et,toString:function(){var t=[];return s(this,function(e){t.push(""+e)}),"["+t.join(", ")+"]"},eq:function(t){return qn(0<=t?this[t]:this[this.length+t])},length:0,push:Xn,sort:[].sort,splice:[].splice},yi={};s("multiple selected checked disabled readOnly required open".split(" "),function(t){yi[Jn(t)]=t});var Ti={};s("input select option textarea button form details".split(" "),function(t){Ti[t]=!0});var Mi={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern",ngStep:"step"};s({data:gt,removeData:$t,hasData:function(t){for(var e in vi[t.ng339])return!0;return!1},cleanData:function(t){for(var e=0,n=t.length;e<n;e++)$t(t[e])}},function(t,e){ht[e]=t}),s({data:gt,inheritedData:St,scope:function(t){return qn.data(t,"$scope")||St(t.parentNode||t,["$isolateScope","$scope"])},isolateScope:function(t){return qn.data(t,"$isolateScope")||qn.data(t,"$isolateScopeNoTemplate")},controller:Ot,injector:function(t){return St(t,"$injector")},removeAttr:function(t,e){t.removeAttribute(e)},hasClass:vt,css:function(t,e,n){if(e=lt(e.replace(xi,"ms-")),!v(n))return t.style[e];t.style[e]=n},attr:function(t,e,n){if((i=t.nodeType)!==mi&&2!==i&&8!==i&&t.getAttribute){var i=Jn(e),r=yi[i];if(!v(n))return t=t.getAttribute(e),r&&null!==t&&(t=i),null===t?void 0:t;null===n||!1===n&&r?t.removeAttribute(e):t.setAttribute(e,r?i:n)}},prop:function(t,e,n){if(!v(n))return t[e];t[e]=n},text:function(){function t(t,e){if(g(e)){var n=t.nodeType;return 1===n||n===mi?t.textContent:""}t.textContent=e}return t.$dv="",t}(),val:function(t,e){if(g(e)){if(t.multiple&&"select"===N(t)){var n=[];return s(t.options,function(t){t.selected&&n.push(t.value||t.text)}),n}return t.value}t.value=e},html:function(t,e){if(g(e))return t.innerHTML;dt(t,!0),t.innerHTML=e},empty:Ct},function(t,e){ht.prototype[e]=function(e,n){var i,r,s=this.length;if(t!==Ct&&g(2===t.length&&t!==vt&&t!==Ot?e:n)){if(w(e)){for(i=0;i<s;i++)if(t===gt)t(this[i],e);else for(r in e)t(this[i],r,e[r]);return this}for(s=g(i=t.$dv)?Math.min(s,1):s,r=0;r<s;r++){var o=t(this[r],e,n);i=i?i+o:o}return i}for(i=0;i<s;i++)t(this[i],e,n);return this}}),s({removeData:$t,on:function(t,e,n,i){if(v(i))throw Si("onargs");if(ct(t)){var r=(i=mt(t,!0)).events,s=i.handle;s||(s=i.handle=function(t,e){var n=function(n,i){n.isDefaultPrevented=function(){return n.defaultPrevented};var r=e[i||n.type],s=r?r.length:0;if(s){if(g(n.immediatePropagationStopped)){var o=n.stopImmediatePropagation;n.stopImmediatePropagation=function(){n.immediatePropagationStopped=!0,n.stopPropagation&&n.stopPropagation(),o&&o.call(n)}}n.isImmediatePropagationStopped=function(){return!0===n.immediatePropagationStopped};var a=r.specialHandlerWrapper||At;1<s&&(r=st(r));for(var l=0;l<s;l++)n.isImmediatePropagationStopped()||a(t,n,r[l])}};return n.elem=t,n}(t,r));for(var o=(i=0<=e.indexOf(" ")?e.split(" "):[e]).length,a=function(e,i,o){var a=r[e];a||((a=r[e]=[]).specialHandlerWrapper=i,"$destroy"===e||o||t.addEventListener(e,s)),a.push(n)};o--;)e=i[o],Oi[e]?(a(Oi[e],jt),a(e,void 0,!0)):a(e)}},off:pt,one:function(t,e,n){(t=qn(t)).on(e,function i(){t.off(e,n),t.off(e,i)}),t.on(e,n)},replaceWith:function(t,e){var n,i=t.parentNode;dt(t),s(new ht(e),function(e){n?i.insertBefore(e,n.nextSibling):i.replaceChild(e,t),n=e})},children:function(t){var e=[];return s(t.childNodes,function(t){1===t.nodeType&&e.push(t)}),e},contents:function(t){return t.contentDocument||t.childNodes||[]},append:function(t,e){if(1===(n=t.nodeType)||11===n)for(var n=0,i=(e=new ht(e)).length;n<i;n++)t.appendChild(e[n])},prepend:function(t,e){if(1===t.nodeType){var n=t.firstChild;s(new ht(e),function(e){t.insertBefore(e,n)})}},wrap:function(t,e){var n=qn(e).eq(0).clone()[0],i=t.parentNode;i&&i.replaceChild(n,t),n.appendChild(t)},remove:kt,detach:function(t){kt(t,!0)},after:function(t,e){var n=t,i=t.parentNode;if(i)for(var r=0,s=(e=new ht(e)).length;r<s;r++){var o=e[r];i.insertBefore(o,n.nextSibling),n=o}},addClass:bt,removeClass:wt,toggleClass:function(t,e,n){e&&s(e.split(" "),function(e){var i=n;g(i)&&(i=!vt(t,e)),(i?bt:wt)(t,e)})},parent:function(t){return(t=t.parentNode)&&11!==t.nodeType?t:null},next:function(t){return t.nextElementSibling},find:function(t,e){return t.getElementsByTagName?t.getElementsByTagName(e):[]},clone:ft,triggerHandler:function(t,e,n){var i,r,o=e.type||e,a=mt(t);(a=(a=a&&a.events)&&a[o])&&(i={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return!0===this.defaultPrevented},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return!0===this.immediatePropagationStopped},stopPropagation:d,type:o,target:t},e.type&&(i=c(i,e)),e=st(a),r=n?[i].concat(n):[i],s(e,function(e){i.isImmediatePropagationStopped()||e.apply(t,r)}))}},function(t,e){ht.prototype[e]=function(e,n,i){for(var r,s=0,o=this.length;s<o;s++)g(r)?v(r=t(this[s],e,n,i))&&(r=qn(r)):xt(r,t(this[s],e,n,i));return v(r)?r:this}}),ht.prototype.bind=ht.prototype.on,ht.prototype.unbind=ht.prototype.off;var Vi=Object.create(null);Tt.prototype={_idx:function(t){return t===this._lastKey?this._lastIndex:(this._lastKey=t,this._lastIndex=this._keys.indexOf(t))},_transformKey:function(t){return ni(t)?Vi:t},get:function(t){if(t=this._transformKey(t),-1!==(t=this._idx(t)))return this._values[t]},set:function(t,e){t=this._transformKey(t);var n=this._idx(t);-1===n&&(n=this._lastIndex=this._keys.length),this._keys[n]=t,this._values[n]=e},delete:function(t){return t=this._transformKey(t),-1!==(t=this._idx(t))&&(this._keys.splice(t,1),this._values.splice(t,1),this._lastKey=NaN,this._lastIndex=-1,!0)}};var Di=Tt,Li=[function(){this.$get=[function(){return Di}]}],Ii=/^([^(]+?)=>/,Hi=/^[^(]*\(\s*([^)]*)\)/m,_i=/,/,qi=/^\s*(_?)(\S+?)\1\s*$/,Ui=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,Ri=e("$injector");Vt.$$annotate=function(t,e,n){var i;if("function"==typeof t){if(!(i=t.$inject)){if(i=[],t.length){if(e)throw x(n)&&n||(n=t.name||function(t){return(t=Mt(t))?"function("+(t[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}(t)),Ri("strictdi",n);s((e=Mt(t))[1].split(_i),function(t){t.replace(qi,function(t,e,n){i.push(n)})})}t.$inject=i}}else si(t)?(F(t[e=t.length-1],"fn"),i=t.slice(0,e)):F(t,"fn",!0);return i};var zi=e("$animate"),Bi=function(){this.$get=d},Gi=function(){var t=new Di,e=[];this.$get=["$$AnimateRunner","$rootScope",function(n,i){function r(t,e,n){var i=!1;return e&&s(e=x(e)?e.split(" "):si(e)?e:[],function(e){e&&(i=!0,t[e]=n)}),i}function o(){s(e,function(e){var n=t.get(e);if(n){var i=function(t){x(t)&&(t=t.split(" "));var e=it();return s(t,function(t){t.length&&(e[t]=!0)}),e}(e.attr("class")),r="",o="";s(n,function(t,e){t!==!!i[e]&&(t?r+=(r.length?" ":"")+e:o+=(o.length?" ":"")+e)}),s(e,function(t){r&&bt(t,r),o&&wt(t,o)}),t.delete(e)}}),e.length=0}return{enabled:d,on:d,off:d,pin:d,push:function(s,a,l,c){return c&&c(),(l=l||{}).from&&s.css(l.from),l.to&&s.css(l.to),(l.addClass||l.removeClass)&&(a=l.addClass,c=l.removeClass,a=r(l=t.get(s)||{},a,!0),c=r(l,c,!1),(a||c)&&(t.set(s,l),e.push(s),1===e.length&&i.$$postDigest(o))),(s=new n).complete(),s}}}]},Ji=["$provide",function(t){var e=this,n=null;this.$$registeredAnimations=Object.create(null),this.register=function(n,i){if(n&&"."!==n.charAt(0))throw zi("notcsel",n);var r=n+"-animation";e.$$registeredAnimations[n.substr(1)]=r,t.factory(r,i)},this.classNameFilter=function(t){if(1===arguments.length&&(n=t instanceof RegExp?t:null)&&/[(\s|\/)]ng-animate[(\s|\/)]/.test(n.toString()))throw n=null,zi("nongcls","ng-animate");return n},this.$get=["$$animateQueue",function(t){function e(t,e,n){if(n){var i;t:{for(i=0;i<n.length;i++){var r=n[i];if(1===r.nodeType){i=r;break t}}i=void 0}!i||i.parentNode||i.previousElementSibling||(n=null)}n?n.after(t):e.prepend(t)}return{on:t.on,off:t.off,pin:t.pin,enabled:t.enabled,cancel:function(t){t.end&&t.end()},enter:function(n,i,r,s){return i=i&&qn(i),r=r&&qn(r),e(n,i=i||r.parent(),r),t.push(n,"enter",It(s))},move:function(n,i,r,s){return i=i&&qn(i),r=r&&qn(r),e(n,i=i||r.parent(),r),t.push(n,"move",It(s))},leave:function(e,n){return t.push(e,"leave",It(n),function(){e.remove()})},addClass:function(e,n,i){return(i=It(i)).addClass=Lt(i.addclass,n),t.push(e,"addClass",i)},removeClass:function(e,n,i){return(i=It(i)).removeClass=Lt(i.removeClass,n),t.push(e,"removeClass",i)},setClass:function(e,n,i,r){return(r=It(r)).addClass=Lt(r.addClass,n),r.removeClass=Lt(r.removeClass,i),t.push(e,"setClass",r)},animate:function(e,n,i,r,s){return(s=It(s)).from=s.from?c(s.from,n):n,s.to=s.to?c(s.to,i):i,s.tempClasses=Lt(s.tempClasses,r||"ng-inline-animate"),t.push(e,"animate",s)}}}]}],Wi=function(){this.$get=["$$rAF",function(t){function e(e){n.push(e),1<n.length||t(function(){for(var t=0;t<n.length;t++)n[t]();n=[]})}var n=[];return function(){var t=!1;return e(function(){t=!0}),function(n){t?n():e(n)}}}]},Yi=function(){this.$get=["$q","$sniffer","$$animateAsyncRun","$$isDocumentHidden","$timeout",function(t,e,n,i,r){function o(t){this.setHost(t);var e=n();this._doneCallbacks=[],this._tick=function(t){i()?r(t,0,!1):e(t)},this._state=0}return o.chain=function(t,e){var n=0;!function i(){n===t.length?e(!0):t[n](function(t){!1===t?e(!1):(n++,i())})}()},o.all=function(t,e){function n(n){r=r&&n,++i===t.length&&e(r)}var i=0,r=!0;s(t,function(t){t.done(n)})},o.prototype={setHost:function(t){this.host=t||{}},done:function(t){2===this._state?t():this._doneCallbacks.push(t)},progress:d,getPromise:function(){if(!this.promise){var e=this;this.promise=t(function(t,n){e.done(function(e){!1===e?n():t()})})}return this.promise},then:function(t,e){return this.getPromise().then(t,e)},catch:function(t){return this.getPromise().catch(t)},finally:function(t){return this.getPromise().finally(t)},pause:function(){this.host.pause&&this.host.pause()},resume:function(){this.host.resume&&this.host.resume()},end:function(){this.host.end&&this.host.end(),this._resolve(!0)},cancel:function(){this.host.cancel&&this.host.cancel(),this._resolve(!1)},complete:function(t){var e=this;0===e._state&&(e._state=1,e._tick(function(){e._resolve(t)}))},_resolve:function(t){2!==this._state&&(s(this._doneCallbacks,function(e){e(t)}),this._doneCallbacks.length=0,this._state=2)}},o}]},Ki=function(){this.$get=["$$rAF","$q","$$AnimateRunner",function(t,e,n){return function(e,i){function r(){return t(function(){s.addClass&&(e.addClass(s.addClass),s.addClass=null),s.removeClass&&(e.removeClass(s.removeClass),s.removeClass=null),s.to&&(e.css(s.to),s.to=null),o||a.complete(),o=!0}),a}var s=i||{};s.$$prepared||(s=T(s)),s.cleanupStyles&&(s.from=s.to=null),s.from&&(e.css(s.from),s.from=null);var o,a=new n;return{start:r,end:r}}}]},Xi=e("$compile"),Zi=new function(){};Rt.$inject=["$provide","$$sanitizeUriProvider"],zt.prototype.isFirstChange=function(){return this.previousValue===Zi};var Qi=/^((?:x|data)[:\-_])/i,Fi=/[:\-_]+(.)/g,tr=e("$controller"),er=/^(\S+)(\s+as\s+([\w$]+))?$/,nr=function(){this.$get=["$document",function(t){return function(e){return e?!e.nodeType&&e instanceof qn&&(e=e[0]):e=t[0].body,e.offsetWidth+1}}]},ir="application/json",rr={"Content-Type":ir+";charset=utf-8"},sr=/^\[|^\{(?!\{)/,or={"[":/]$/,"{":/}$/},ar=/^\)]\}',?\n/,lr=e("$http"),cr=ti.$interpolateMinErr=e("$interpolate");cr.throwNoconcat=function(t){throw cr("noconcat",t)},cr.interr=function(t,e){return cr("interr",t,e.toString())};var ur=function(){this.$get=function(){var t=ti.callbacks,e={};return{createCallback:function(n){var i="angular.callbacks."+(n="_"+(t.$$counter++).toString(36)),r=function(t){var e=function(t){e.data=t,e.called=!0};return e.id=t,e}(n);return e[i]=t[n]=r,i},wasCalled:function(t){return e[t].called},getResponse:function(t){return e[t].data},removeCallback:function(n){delete t[e[n].id],delete e[n]}}}},hr=/^([^?#]*)(\?([^#]*))?(#(.*))?$/,fr={http:80,https:443,ftp:21},dr=e("$location"),pr=/^\s*[\\\/]{2,}/,$r={$$absUrl:"",$$html5:!1,$$replace:!1,absUrl:be("$$absUrl"),url:function(t){if(g(t))return this.$$url;var e=hr.exec(t);return(e[1]||""===t)&&this.path(decodeURIComponent(e[1])),(e[2]||e[1]||""===t)&&this.search(e[3]||""),this.hash(e[5]||""),this},protocol:be("$$protocol"),host:be("$$host"),port:be("$$port"),path:xe("$$path",function(t){return"/"===(t=null!==t?t.toString():"").charAt(0)?t:"/"+t}),search:function(t,e){switch(arguments.length){case 0:return this.$$search;case 1:if(x(t)||O(t))t=t.toString(),this.$$search=z(t);else{if(!w(t))throw dr("isrcharg");s(t=T(t,{}),function(e,n){null==e&&delete t[n]}),this.$$search=t}break;default:g(e)||null===e?delete this.$$search[t]:this.$$search[t]=e}return this.$$compose(),this},hash:xe("$$hash",function(t){return null!==t?t.toString():""}),replace:function(){return this.$$replace=!0,this}};s([we,ve,ge],function(t){t.prototype=Object.create($r),t.prototype.state=function(e){if(!arguments.length)return this.$$state;if(t!==ge||!this.$$html5)throw dr("nostate");return this.$$state=g(e)?null:e,this.$$urlUpdatedByLocation=!0,this}});var mr=e("$parse"),gr={}.constructor.prototype.valueOf,vr=it();s("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(t){vr[t]=!0});var wr={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},br=function(t){this.options=t};br.prototype={constructor:br,lex:function(t){for(this.text=t,this.index=0,this.tokens=[];this.index<this.text.length;)if('"'===(t=this.text.charAt(this.index))||"'"===t)this.readString(t);else if(this.isNumber(t)||"."===t&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdentifierStart(this.peekMultichar()))this.readIdent();else if(this.is(t,"(){}[].,;:?"))this.tokens.push({index:this.index,text:t}),this.index++;else if(this.isWhitespace(t))this.index++;else{var e=t+this.peek(),n=e+this.peek(2),i=vr[e],r=vr[n];vr[t]||i||r?(t=r?n:i?e:t,this.tokens.push({index:this.index,text:t,operator:!0}),this.index+=t.length):this.throwError("Unexpected next character ",this.index,this.index+1)}return this.tokens},is:function(t,e){return-1!==e.indexOf(t)},peek:function(t){return t=t||1,this.index+t<this.text.length&&this.text.charAt(this.index+t)},isNumber:function(t){return"0"<=t&&"9">=t&&"string"==typeof t},isWhitespace:function(t){return" "===t||"\r"===t||"\t"===t||"\n"===t||"\v"===t||" "===t},isIdentifierStart:function(t){return this.options.isIdentifierStart?this.options.isIdentifierStart(t,this.codePointAt(t)):this.isValidIdentifierStart(t)},isValidIdentifierStart:function(t){return"a"<=t&&"z">=t||"A"<=t&&"Z">=t||"_"===t||"$"===t},isIdentifierContinue:function(t){return this.options.isIdentifierContinue?this.options.isIdentifierContinue(t,this.codePointAt(t)):this.isValidIdentifierContinue(t)},isValidIdentifierContinue:function(t,e){return this.isValidIdentifierStart(t,e)||this.isNumber(t)},codePointAt:function(t){return 1===t.length?t.charCodeAt(0):(t.charCodeAt(0)<<10)+t.charCodeAt(1)-56613888},peekMultichar:function(){var t=this.text.charAt(this.index),e=this.peek();if(!e)return t;var n=t.charCodeAt(0),i=e.charCodeAt(0);return 55296<=n&&56319>=n&&56320<=i&&57343>=i?t+e:t},isExpOperator:function(t){return"-"===t||"+"===t||this.isNumber(t)},throwError:function(t,e,n){throw n=n||this.index,e=v(e)?"s "+e+"-"+this.index+" ["+this.text.substring(e,n)+"]":" "+n,mr("lexerr",t,e,this.text)},readNumber:function(){for(var t="",e=this.index;this.index<this.text.length;){var n=Jn(this.text.charAt(this.index));if("."===n||this.isNumber(n))t+=n;else{var i=this.peek();if("e"===n&&this.isExpOperator(i))t+=n;else if(this.isExpOperator(n)&&i&&this.isNumber(i)&&"e"===t.charAt(t.length-1))t+=n;else{if(!this.isExpOperator(n)||i&&this.isNumber(i)||"e"!==t.charAt(t.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:e,text:t,constant:!0,value:Number(t)})},readIdent:function(){var t=this.index;for(this.index+=this.peekMultichar().length;this.index<this.text.length;){var e=this.peekMultichar();if(!this.isIdentifierContinue(e))break;this.index+=e.length}this.tokens.push({index:t,text:this.text.slice(t,this.index),identifier:!0})},readString:function(t){var e=this.index;this.index++;for(var n="",i=t,r=!1;this.index<this.text.length;){var s=this.text.charAt(this.index);i=i+s;if(r)"u"===s?((r=this.text.substring(this.index+1,this.index+5)).match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+r+"]"),this.index+=4,n+=String.fromCharCode(parseInt(r,16))):n+=wr[s]||s,r=!1;else if("\\"===s)r=!0;else{if(s===t)return this.index++,void this.tokens.push({index:e,text:i,constant:!0,value:n});n+=s}this.index++}this.throwError("Unterminated quote",e)}};var xr=function(t,e){this.lexer=t,this.options=e};xr.Program="Program",xr.ExpressionStatement="ExpressionStatement",xr.AssignmentExpression="AssignmentExpression",xr.ConditionalExpression="ConditionalExpression",xr.LogicalExpression="LogicalExpression",xr.BinaryExpression="BinaryExpression",xr.UnaryExpression="UnaryExpression",xr.CallExpression="CallExpression",xr.MemberExpression="MemberExpression",xr.Identifier="Identifier",xr.Literal="Literal",xr.ArrayExpression="ArrayExpression",xr.Property="Property",xr.ObjectExpression="ObjectExpression",xr.ThisExpression="ThisExpression",xr.LocalsExpression="LocalsExpression",xr.NGValueParameter="NGValueParameter",xr.prototype={ast:function(t){return this.text=t,this.tokens=this.lexer.lex(t),t=this.program(),0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),t},program:function(){for(var t=[];;)if(0<this.tokens.length&&!this.peek("}",")",";","]")&&t.push(this.expressionStatement()),!this.expect(";"))return{type:xr.Program,body:t}},expressionStatement:function(){return{type:xr.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var t=this.expression();this.expect("|");)t=this.filter(t);return t},expression:function(){return this.assignment()},assignment:function(){var t=this.ternary();if(this.expect("=")){if(!je(t))throw mr("lval");t={type:xr.AssignmentExpression,left:t,right:this.assignment(),operator:"="}}return t},ternary:function(){var t,e,n=this.logicalOR();return this.expect("?")&&(t=this.expression(),this.consume(":"))?(e=this.expression(),{type:xr.ConditionalExpression,test:n,alternate:t,consequent:e}):n},logicalOR:function(){for(var t=this.logicalAND();this.expect("||");)t={type:xr.LogicalExpression,operator:"||",left:t,right:this.logicalAND()};return t},logicalAND:function(){for(var t=this.equality();this.expect("&&");)t={type:xr.LogicalExpression,operator:"&&",left:t,right:this.equality()};return t},equality:function(){for(var t,e=this.relational();t=this.expect("==","!=","===","!==");)e={type:xr.BinaryExpression,operator:t.text,left:e,right:this.relational()};return e},relational:function(){for(var t,e=this.additive();t=this.expect("<",">","<=",">=");)e={type:xr.BinaryExpression,operator:t.text,left:e,right:this.additive()};return e},additive:function(){for(var t,e=this.multiplicative();t=this.expect("+","-");)e={type:xr.BinaryExpression,operator:t.text,left:e,right:this.multiplicative()};return e},multiplicative:function(){for(var t,e=this.unary();t=this.expect("*","/","%");)e={type:xr.BinaryExpression,operator:t.text,left:e,right:this.unary()};return e},unary:function(){var t;return(t=this.expect("+","-","!"))?{type:xr.UnaryExpression,operator:t.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var t,e;for(this.expect("(")?(t=this.filterChain(),this.consume(")")):this.expect("[")?t=this.arrayDeclaration():this.expect("{")?t=this.object():this.selfReferential.hasOwnProperty(this.peek().text)?t=T(this.selfReferential[this.consume().text]):this.options.literals.hasOwnProperty(this.peek().text)?t={type:xr.Literal,value:this.options.literals[this.consume().text]}:this.peek().identifier?t=this.identifier():this.peek().constant?t=this.constant():this.throwError("not a primary expression",this.peek());e=this.expect("(","[",".");)"("===e.text?(t={type:xr.CallExpression,callee:t,arguments:this.parseArguments()},this.consume(")")):"["===e.text?(t={type:xr.MemberExpression,object:t,property:this.expression(),computed:!0},this.consume("]")):"."===e.text?t={type:xr.MemberExpression,object:t,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return t},filter:function(t){t=[t];for(var e={type:xr.CallExpression,callee:this.identifier(),arguments:t,filter:!0};this.expect(":");)t.push(this.expression());return e},parseArguments:function(){var t=[];if(")"!==this.peekToken().text)do{t.push(this.filterChain())}while(this.expect(","));return t},identifier:function(){var t=this.consume();return t.identifier||this.throwError("is not a valid identifier",t),{type:xr.Identifier,name:t.text}},constant:function(){return{type:xr.Literal,value:this.consume().value}},arrayDeclaration:function(){var t=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;t.push(this.expression())}while(this.expect(","));return this.consume("]"),{type:xr.ArrayExpression,elements:t}},object:function(){var t,e=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;t={type:xr.Property,kind:"init"},this.peek().constant?(t.key=this.constant(),t.computed=!1,this.consume(":"),t.value=this.expression()):this.peek().identifier?(t.key=this.identifier(),t.computed=!1,this.peek(":")?(this.consume(":"),t.value=this.expression()):t.value=t.key):this.peek("[")?(this.consume("["),t.key=this.expression(),this.consume("]"),t.computed=!0,this.consume(":"),t.value=this.expression()):this.throwError("invalid key",this.peek()),e.push(t)}while(this.expect(","));return this.consume("}"),{type:xr.ObjectExpression,properties:e}},throwError:function(t,e){throw mr("syntax",e.text,t,e.index+1,this.text,this.text.substring(e.index))},consume:function(t){if(0===this.tokens.length)throw mr("ueoe",this.text);var e=this.expect(t);return e||this.throwError("is unexpected, expecting ["+t+"]",this.peek()),e},peekToken:function(){if(0===this.tokens.length)throw mr("ueoe",this.text);return this.tokens[0]},peek:function(t,e,n,i){return this.peekAhead(0,t,e,n,i)},peekAhead:function(t,e,n,i,r){if(this.tokens.length>t){var s=(t=this.tokens[t]).text;if(s===e||s===n||s===i||s===r||!(e||n||i||r))return t}return!1},expect:function(t,e,n,i){return!!(t=this.peek(t,e,n,i))&&(this.tokens.shift(),t)},selfReferential:{this:{type:xr.ThisExpression},$locals:{type:xr.LocalsExpression}}},Te.prototype={compile:function(t){var e=this;t=this.astBuilder.ast(t),this.state={nextId:0,filters:{},fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]},Pe(t,e.$filter);var n,i="";return this.stage="assign",(n=Ne(t))&&(this.state.computing="assign",i=this.nextId(),this.recurse(n,i),this.return_(i),i="fn.assign="+this.generateFunction("assign","s,v,l")),n=Ae(t.body),e.stage="inputs",s(n,function(t,n){var i="fn"+n;e.state[i]={vars:[],body:[],own:{}},e.state.computing=i;var r=e.nextId();e.recurse(t,r),e.return_(r),e.state.inputs.push(i),t.watchId=n}),this.state.computing="fn",this.stage="main",this.recurse(t),i='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+i+this.watchFns()+"return fn;",i=new Function("$filter","getStringValue","ifDefined","plus",i)(this.$filter,Ce,ke,Ee),this.state=this.stage=void 0,i.literal=ye(t),i.constant=t.constant,i},USE:"use",STRICT:"strict",watchFns:function(){var t=[],e=this.state.inputs,n=this;return s(e,function(e){t.push("var "+e+"="+n.generateFunction(e,"s"))}),e.length&&t.push("fn.inputs=["+e.join(",")+"];"),t.join("")},generateFunction:function(t,e){return"function("+e+"){"+this.varsPrefix(t)+this.body(t)+"};"},filterPrefix:function(){var t=[],e=this;return s(this.state.filters,function(n,i){t.push(n+"=$filter("+e.escape(i)+")")}),t.length?"var "+t.join(",")+";":""},varsPrefix:function(t){return this.state[t].vars.length?"var "+this.state[t].vars.join(",")+";":""},body:function(t){return this.state[t].body.join("")},recurse:function(t,e,n,i,r,o){var a,l,c,u,h,f=this;if(i=i||d,!o&&v(t.watchId))e=e||this.nextId(),this.if_("i",this.lazyAssign(e,this.computedMember("i",t.watchId)),this.lazyRecurse(t,e,n,i,r,!0));else switch(t.type){case xr.Program:s(t.body,function(e,n){f.recurse(e.expression,void 0,void 0,function(t){l=t}),n!==t.body.length-1?f.current().body.push(l,";"):f.return_(l)});break;case xr.Literal:u=this.escape(t.value),this.assign(e,u),i(e||u);break;case xr.UnaryExpression:this.recurse(t.argument,void 0,void 0,function(t){l=t}),u=t.operator+"("+this.ifDefined(l,0)+")",this.assign(e,u),i(u);break;case xr.BinaryExpression:this.recurse(t.left,void 0,void 0,function(t){a=t}),this.recurse(t.right,void 0,void 0,function(t){l=t}),u="+"===t.operator?this.plus(a,l):"-"===t.operator?this.ifDefined(a,0)+t.operator+this.ifDefined(l,0):"("+a+")"+t.operator+"("+l+")",this.assign(e,u),i(u);break;case xr.LogicalExpression:e=e||this.nextId(),f.recurse(t.left,e),f.if_("&&"===t.operator?e:f.not(e),f.lazyRecurse(t.right,e)),i(e);break;case xr.ConditionalExpression:e=e||this.nextId(),f.recurse(t.test,e),f.if_(e,f.lazyRecurse(t.alternate,e),f.lazyRecurse(t.consequent,e)),i(e);break;case xr.Identifier:e=e||this.nextId(),n&&(n.context="inputs"===f.stage?"s":this.assign(this.nextId(),this.getHasOwnProperty("l",t.name)+"?l:s"),n.computed=!1,n.name=t.name),f.if_("inputs"===f.stage||f.not(f.getHasOwnProperty("l",t.name)),function(){f.if_("inputs"===f.stage||"s",function(){r&&1!==r&&f.if_(f.isNull(f.nonComputedMember("s",t.name)),f.lazyAssign(f.nonComputedMember("s",t.name),"{}")),f.assign(e,f.nonComputedMember("s",t.name))})},e&&f.lazyAssign(e,f.nonComputedMember("l",t.name))),i(e);break;case xr.MemberExpression:a=n&&(n.context=this.nextId())||this.nextId(),e=e||this.nextId(),f.recurse(t.object,a,void 0,function(){f.if_(f.notNull(a),function(){t.computed?(l=f.nextId(),f.recurse(t.property,l),f.getStringValue(l),r&&1!==r&&f.if_(f.not(f.computedMember(a,l)),f.lazyAssign(f.computedMember(a,l),"{}")),u=f.computedMember(a,l),f.assign(e,u),n&&(n.computed=!0,n.name=l)):(r&&1!==r&&f.if_(f.isNull(f.nonComputedMember(a,t.property.name)),f.lazyAssign(f.nonComputedMember(a,t.property.name),"{}")),u=f.nonComputedMember(a,t.property.name),f.assign(e,u),n&&(n.computed=!1,n.name=t.property.name))},function(){f.assign(e,"undefined")}),i(e)},!!r);break;case xr.CallExpression:e=e||this.nextId(),t.filter?(l=f.filter(t.callee.name),c=[],s(t.arguments,function(t){var e=f.nextId();f.recurse(t,e),c.push(e)}),u=l+"("+c.join(",")+")",f.assign(e,u),i(e)):(l=f.nextId(),a={},c=[],f.recurse(t.callee,l,a,function(){f.if_(f.notNull(l),function(){s(t.arguments,function(e){f.recurse(e,t.constant?void 0:f.nextId(),void 0,function(t){c.push(t)})}),u=a.name?f.member(a.context,a.name,a.computed)+"("+c.join(",")+")":l+"("+c.join(",")+")",f.assign(e,u)},function(){f.assign(e,"undefined")}),i(e)}));break;case xr.AssignmentExpression:l=this.nextId(),a={},this.recurse(t.left,void 0,a,function(){f.if_(f.notNull(a.context),function(){f.recurse(t.right,l),u=f.member(a.context,a.name,a.computed)+t.operator+l,f.assign(e,u),i(e||u)})},1);break;case xr.ArrayExpression:c=[],s(t.elements,function(e){f.recurse(e,t.constant?void 0:f.nextId(),void 0,function(t){c.push(t)})}),u="["+c.join(",")+"]",this.assign(e,u),i(e||u);break;case xr.ObjectExpression:c=[],h=!1,s(t.properties,function(t){t.computed&&(h=!0)}),h?(e=e||this.nextId(),this.assign(e,"{}"),s(t.properties,function(t){t.computed?(a=f.nextId(),f.recurse(t.key,a)):a=t.key.type===xr.Identifier?t.key.name:""+t.key.value,l=f.nextId(),f.recurse(t.value,l),f.assign(f.member(e,a,t.computed),l)})):(s(t.properties,function(e){f.recurse(e.value,t.constant?void 0:f.nextId(),void 0,function(t){c.push(f.escape(e.key.type===xr.Identifier?e.key.name:""+e.key.value)+":"+t)})}),u="{"+c.join(",")+"}",this.assign(e,u)),i(e||u);break;case xr.ThisExpression:this.assign(e,"s"),i(e||"s");break;case xr.LocalsExpression:this.assign(e,"l"),i(e||"l");break;case xr.NGValueParameter:this.assign(e,"v"),i(e||"v")}},getHasOwnProperty:function(t,e){var n=t+"."+e,i=this.current().own;return i.hasOwnProperty(n)||(i[n]=this.nextId(!1,t+"&&("+this.escape(e)+" in "+t+")")),i[n]},assign:function(t,e){if(t)return this.current().body.push(t,"=",e,";"),t},filter:function(t){return this.state.filters.hasOwnProperty(t)||(this.state.filters[t]=this.nextId(!0)),this.state.filters[t]},ifDefined:function(t,e){return"ifDefined("+t+","+this.escape(e)+")"},plus:function(t,e){return"plus("+t+","+e+")"},return_:function(t){this.current().body.push("return ",t,";")},if_:function(t,e,n){if(!0===t)e();else{var i=this.current().body;i.push("if(",t,"){"),e(),i.push("}"),n&&(i.push("else{"),n(),i.push("}"))}},not:function(t){return"!("+t+")"},isNull:function(t){return t+"==null"},notNull:function(t){return t+"!=null"},nonComputedMember:function(t,e){return/^[$_a-zA-Z][$_a-zA-Z0-9]*$/.test(e)?t+"."+e:t+'["'+e.replace(/[^$_a-zA-Z0-9]/g,this.stringEscapeFn)+'"]'},computedMember:function(t,e){return t+"["+e+"]"},member:function(t,e,n){return n?this.computedMember(t,e):this.nonComputedMember(t,e)},getStringValue:function(t){this.assign(t,"getStringValue("+t+")")},lazyRecurse:function(t,e,n,i,r,s){var o=this;return function(){o.recurse(t,e,n,i,r,s)}},lazyAssign:function(t,e){var n=this;return function(){n.assign(t,e)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,stringEscapeFn:function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)},escape:function(t){if(x(t))return"'"+t.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(O(t))return t.toString();if(!0===t)return"true";if(!1===t)return"false";if(null===t)return"null";if(void 0===t)return"undefined";throw mr("esc")},nextId:function(t,e){var n="v"+this.state.nextId++;return t||this.current().vars.push(n+(e?"="+e:"")),n},current:function(){return this.state[this.state.computing]}},Me.prototype={compile:function(t){var e,n,i,r=this;Pe(t=this.astBuilder.ast(t),r.$filter),(e=Ne(t))&&(n=this.recurse(e)),(e=Ae(t.body))&&(i=[],s(e,function(t,e){var n=r.recurse(t);t.input=n,i.push(n),t.watchId=e}));var o=[];return s(t.body,function(t){o.push(r.recurse(t.expression))}),e=0===t.body.length?d:1===t.body.length?o[0]:function(t,e){var n;return s(o,function(i){n=i(t,e)}),n},n&&(e.assign=function(t,e,i){return n(t,i,e)}),i&&(e.inputs=i),e.literal=ye(t),e.constant=t.constant,e},recurse:function(t,e,n){var i,r,o,a=this;if(t.input)return this.inputs(t.input,t.watchId);switch(t.type){case xr.Literal:return this.value(t.value,e);case xr.UnaryExpression:return r=this.recurse(t.argument),this["unary"+t.operator](r,e);case xr.BinaryExpression:case xr.LogicalExpression:return i=this.recurse(t.left),r=this.recurse(t.right),this["binary"+t.operator](i,r,e);case xr.ConditionalExpression:return this["ternary?:"](this.recurse(t.test),this.recurse(t.alternate),this.recurse(t.consequent),e);case xr.Identifier:return a.identifier(t.name,e,n);case xr.MemberExpression:return i=this.recurse(t.object,!1,!!n),t.computed||(r=t.property.name),t.computed&&(r=this.recurse(t.property)),t.computed?this.computedMember(i,r,e,n):this.nonComputedMember(i,r,e,n);case xr.CallExpression:return o=[],s(t.arguments,function(t){o.push(a.recurse(t))}),t.filter&&(r=this.$filter(t.callee.name)),t.filter||(r=this.recurse(t.callee,!0)),t.filter?function(t,n,i,s){for(var a=[],l=0;l<o.length;++l)a.push(o[l](t,n,i,s));return t=r.apply(void 0,a,s),e?{context:void 0,name:void 0,value:t}:t}:function(t,n,i,s){var a,l=r(t,n,i,s);if(null!=l.value){a=[];for(var c=0;c<o.length;++c)a.push(o[c](t,n,i,s));a=l.value.apply(l.context,a)}return e?{value:a}:a};case xr.AssignmentExpression:return i=this.recurse(t.left,!0,1),r=this.recurse(t.right),function(t,n,s,o){var a=i(t,n,s,o);return t=r(t,n,s,o),a.context[a.name]=t,e?{value:t}:t};case xr.ArrayExpression:return o=[],s(t.elements,function(t){o.push(a.recurse(t))}),function(t,n,i,r){for(var s=[],a=0;a<o.length;++a)s.push(o[a](t,n,i,r));return e?{value:s}:s};case xr.ObjectExpression:return o=[],s(t.properties,function(t){t.computed?o.push({key:a.recurse(t.key),computed:!0,value:a.recurse(t.value)}):o.push({key:t.key.type===xr.Identifier?t.key.name:""+t.key.value,computed:!1,value:a.recurse(t.value)})}),function(t,n,i,r){for(var s={},a=0;a<o.length;++a)o[a].computed?s[o[a].key(t,n,i,r)]=o[a].value(t,n,i,r):s[o[a].key]=o[a].value(t,n,i,r);return e?{value:s}:s};case xr.ThisExpression:return function(t){return e?{value:t}:t};case xr.LocalsExpression:return function(t,n){return e?{value:n}:n};case xr.NGValueParameter:return function(t,n,i){return e?{value:i}:i}}},"unary+":function(t,e){return function(n,i,r,s){return n=v(n=t(n,i,r,s))?+n:0,e?{value:n}:n}},"unary-":function(t,e){return function(n,i,r,s){return n=v(n=t(n,i,r,s))?-n:-0,e?{value:n}:n}},"unary!":function(t,e){return function(n,i,r,s){return n=!t(n,i,r,s),e?{value:n}:n}},"binary+":function(t,e,n){return function(i,r,s,o){var a=t(i,r,s,o);return a=Ee(a,i=e(i,r,s,o)),n?{value:a}:a}},"binary-":function(t,e,n){return function(i,r,s,o){var a=t(i,r,s,o);return i=e(i,r,s,o),a=(v(a)?a:0)-(v(i)?i:0),n?{value:a}:a}},"binary*":function(t,e,n){return function(i,r,s,o){return i=t(i,r,s,o)*e(i,r,s,o),n?{value:i}:i}},"binary/":function(t,e,n){return function(i,r,s,o){return i=t(i,r,s,o)/e(i,r,s,o),n?{value:i}:i}},"binary%":function(t,e,n){return function(i,r,s,o){return i=t(i,r,s,o)%e(i,r,s,o),n?{value:i}:i}},"binary===":function(t,e,n){return function(i,r,s,o){return i=t(i,r,s,o)===e(i,r,s,o),n?{value:i}:i}},"binary!==":function(t,e,n){return function(i,r,s,o){return i=t(i,r,s,o)!==e(i,r,s,o),n?{value:i}:i}},"binary==":function(t,e,n){return function(i,r,s,o){return i=t(i,r,s,o)==e(i,r,s,o),n?{value:i}:i}},"binary!=":function(t,e,n){return function(i,r,s,o){return i=t(i,r,s,o)!=e(i,r,s,o),n?{value:i}:i}},"binary<":function(t,e,n){return function(i,r,s,o){return i=t(i,r,s,o)<e(i,r,s,o),n?{value:i}:i}},"binary>":function(t,e,n){return function(i,r,s,o){return i=t(i,r,s,o)>e(i,r,s,o),n?{value:i}:i}},"binary<=":function(t,e,n){return function(i,r,s,o){return i=t(i,r,s,o)<=e(i,r,s,o),n?{value:i}:i}},"binary>=":function(t,e,n){return function(i,r,s,o){return i=t(i,r,s,o)>=e(i,r,s,o),n?{value:i}:i}},"binary&&":function(t,e,n){return function(i,r,s,o){return i=t(i,r,s,o)&&e(i,r,s,o),n?{value:i}:i}},"binary||":function(t,e,n){return function(i,r,s,o){return i=t(i,r,s,o)||e(i,r,s,o),n?{value:i}:i}},"ternary?:":function(t,e,n,i){return function(r,s,o,a){return r=t(r,s,o,a)?e(r,s,o,a):n(r,s,o,a),i?{value:r}:r}},value:function(t,e){return function(){return e?{context:void 0,name:void 0,value:t}:t}},identifier:function(t,e,n){return function(i,r,s,o){return i=r&&t in r?r:i,n&&1!==n&&i&&null==i[t]&&(i[t]={}),r=i?i[t]:void 0,e?{context:i,name:t,value:r}:r}},computedMember:function(t,e,n,i){return function(r,s,o,a){var l,c,u=t(r,s,o,a);return null!=u&&(l=e(r,s,o,a),l+="",i&&1!==i&&u&&!u[l]&&(u[l]={}),c=u[l]),n?{context:u,name:l,value:c}:c}},nonComputedMember:function(t,e,n,i){return function(r,s,o,a){return r=t(r,s,o,a),i&&1!==i&&r&&null==r[e]&&(r[e]={}),s=null!=r?r[e]:void 0,n?{context:r,name:e,value:s}:s}},inputs:function(t,e){return function(n,i,r,s){return s?s[e]:t(n,i,r)}}};var Or=function(t,e,n){this.lexer=t,this.$filter=e,this.options=n,this.ast=new xr(t,n),this.astCompiler=n.csp?new Me(this.ast,e):new Te(this.ast,e)};Or.prototype={constructor:Or,parse:function(t){return this.astCompiler.compile(t)}};var Sr=e("$sce"),Cr={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},kr=/_([a-z])/g,Er=e("$compile"),Pr=t.document.createElement("a"),Ar=Ke(t.location.href);Qe.$inject=["$document"],tn.$inject=["$provide"];var jr=22,Nr=".",yr="0";sn.$inject=["$locale"],on.$inject=["$locale"];var Tr={yyyy:cn("FullYear",4,0,!1,!0),yy:cn("FullYear",2,0,!0,!0),y:cn("FullYear",1,0,!1,!0),MMMM:un("Month"),MMM:un("Month",!0),MM:cn("Month",2,1),M:cn("Month",1,1),LLLL:un("Month",!1,!0),dd:cn("Date",2),d:cn("Date",1),HH:cn("Hours",2),H:cn("Hours",1),hh:cn("Hours",2,-12),h:cn("Hours",1,-12),mm:cn("Minutes",2),m:cn("Minutes",1),ss:cn("Seconds",2),s:cn("Seconds",1),sss:cn("Milliseconds",3),EEEE:un("Day"),EEE:un("Day",!0),a:function(t,e){return 12>t.getHours()?e.AMPMS[0]:e.AMPMS[1]},Z:function(t,e,n){return(0<=(t=-1*n)?"+":"")+(ln(Math[0<t?"floor":"ceil"](t/60),2)+ln(Math.abs(t%60),2))},ww:fn(2),w:fn(1),G:dn,GG:dn,GGG:dn,GGGG:function(t,e){return 0>=t.getFullYear()?e.ERANAMES[0]:e.ERANAMES[1]}},Mr=/((?:[^yMLdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|L+|d+|H+|h+|m+|s+|a|Z|G+|w+))(.*)/,Vr=/^-?\d+$/;pn.$inject=["$locale"];var Dr=$(Jn),Lr=$(Wn);vn.$inject=["$parse"];var Ir=$({restrict:"E",compile:function(t,e){if(!e.href&&!e.xlinkHref)return function(t,e){if("a"===e[0].nodeName.toLowerCase()){var n="[object SVGAnimatedString]"===Zn.call(e.prop("href"))?"xlink:href":"href";e.on("click",function(t){e.attr(n)||t.preventDefault()})}}}}),Hr={};s(yi,function(t,e){function n(t,n,r){t.$watch(r[i],function(t){r.$set(e,!!t)})}if("multiple"!==t){var i=Bt("ng-"+e),r=n;"checked"===t&&(r=function(t,e,r){r.ngModel!==r[i]&&n(t,0,r)}),Hr[i]=function(){return{restrict:"A",priority:100,link:r}}}}),s(Mi,function(t,e){Hr[e]=function(){return{priority:100,link:function(t,n,i){"ngPattern"===e&&"/"===i.ngPattern.charAt(0)&&(n=i.ngPattern.match(zn))?i.$set("ngPattern",new RegExp(n[1],n[2])):t.$watch(i[e],function(t){i.$set(e,t)})}}}}),s(["src","srcset","href"],function(t){var e=Bt("ng-"+t);Hr[e]=function(){return{priority:99,link:function(n,i,r){var s=t,o=t;"href"===t&&"[object SVGAnimatedString]"===Zn.call(i.prop("href"))&&(o="xlinkHref",r.$attr[o]="xlink:href",s=null),r.$observe(e,function(e){e?(r.$set(o,e),_n&&s&&i.prop(s,r[o])):"href"===t&&r.$set(o,null)})}}}});var _r={$addControl:d,$$renameControl:function(t,e){t.$name=e},$removeControl:d,$setValidity:d,$setDirty:d,$setPristine:d,$setSubmitted:d};bn.$inject=["$element","$attrs","$scope","$animate","$interpolate"],bn.prototype={$rollbackViewValue:function(){s(this.$$controls,function(t){t.$rollbackViewValue()})},$commitViewValue:function(){s(this.$$controls,function(t){t.$commitViewValue()})},$addControl:function(t){tt(t.$name,"input"),this.$$controls.push(t),t.$name&&(this[t.$name]=t),t.$$parentForm=this},$$renameControl:function(t,e){var n=t.$name;this[n]===t&&delete this[n],this[e]=t,t.$name=e},$removeControl:function(t){t.$name&&this[t.$name]===t&&delete this[t.$name],s(this.$pending,function(e,n){this.$setValidity(n,null,t)},this),s(this.$error,function(e,n){this.$setValidity(n,null,t)},this),s(this.$$success,function(e,n){this.$setValidity(n,null,t)},this),y(this.$$controls,t),t.$$parentForm=_r},$setDirty:function(){this.$$animate.removeClass(this.$$element,xs),this.$$animate.addClass(this.$$element,Os),this.$dirty=!0,this.$pristine=!1,this.$$parentForm.$setDirty()},$setPristine:function(){this.$$animate.setClass(this.$$element,xs,Os+" ng-submitted"),this.$dirty=!1,this.$pristine=!0,this.$submitted=!1,s(this.$$controls,function(t){t.$setPristine()})},$setUntouched:function(){s(this.$$controls,function(t){t.$setUntouched()})},$setSubmitted:function(){this.$$animate.addClass(this.$$element,"ng-submitted"),this.$submitted=!0,this.$$parentForm.$setSubmitted()}},On({clazz:bn,set:function(t,e,n){var i=t[e];i?-1===i.indexOf(n)&&i.push(n):t[e]=[n]},unset:function(t,e,n){var i=t[e];i&&(y(i,n),0===i.length&&delete t[e])}});var qr=function(t){return["$timeout","$parse",function(e,n){function i(t){return""===t?n('this[""]').assign:n(t).assign||d}return{name:"form",restrict:t?"EAC":"E",require:["form","^^?form"],controller:bn,compile:function(n,r){n.addClass(xs).addClass(ws);var s=r.name?"name":!(!t||!r.ngForm)&&"ngForm";return{pre:function(t,n,r,o){var a=o[0];if(!("action"in r)){var l=function(e){t.$apply(function(){a.$commitViewValue(),a.$setSubmitted()}),e.preventDefault()};n[0].addEventListener("submit",l),n.on("$destroy",function(){e(function(){n[0].removeEventListener("submit",l)},0,!1)})}(o[1]||a.$$parentForm).$addControl(a);var u=s?i(a.$name):d;s&&(u(t,a),r.$observe(s,function(e){a.$name!==e&&(u(t,void 0),a.$$parentForm.$$renameControl(a,e),(u=i(a.$name))(t,a))})),n.on("$destroy",function(){a.$$parentForm.$removeControl(a),u(t,void 0),c(a,_r)})}}}}}]},Ur=qr(),Rr=qr(!0),zr=/^\d{4,}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z)$/,Br=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:\/?#]+|\[[a-f\d:]+])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i,Gr=/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/,Jr=/^\s*(-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,Wr=/^(\d{4,})-(\d{2})-(\d{2})$/,Yr=/^(\d{4,})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,Kr=/^(\d{4,})-W(\d\d)$/,Xr=/^(\d{4,})-(\d\d)$/,Zr=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,Qr=it();s(["date","datetime-local","month","time","week"],function(t){Qr[t]=!0});var Fr={text:function(t,e,n,i,r,s){kn(0,e,n,i,r,s),Cn(i)},date:Pn("date",Wr,En(Wr,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":Pn("datetimelocal",Yr,En(Yr,"yyyy MM dd HH mm ss sss".split(" ")),"yyyy-MM-ddTHH:mm:ss.sss"),time:Pn("time",Zr,En(Zr,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:Pn("week",Kr,function(t,e){if(S(t))return t;if(x(t)){Kr.lastIndex=0;var n=Kr.exec(t);if(n){var i=+n[1],r=+n[2],s=n=0,o=0,a=0,l=hn(i);r=7*(r-1);return e&&(n=e.getHours(),s=e.getMinutes(),o=e.getSeconds(),a=e.getMilliseconds()),new Date(i,0,l.getDate()+r,n,s,o,a)}}return NaN},"yyyy-Www"),month:Pn("month",Xr,En(Xr,["yyyy","MM"]),"yyyy-MM"),number:function(t,e,n,i,r,s){var o,a,l;(An(0,e,0,i),jn(i),kn(0,e,n,i,r,s),(v(n.min)||n.ngMin)&&(i.$validators.min=function(t){return i.$isEmpty(t)||g(o)||t>=o},n.$observe("min",function(t){o=Nn(t),i.$validate()})),(v(n.max)||n.ngMax)&&(i.$validators.max=function(t){return i.$isEmpty(t)||g(a)||t<=a},n.$observe("max",function(t){a=Nn(t),i.$validate()})),v(n.step)||n.ngStep)&&(i.$validators.step=function(t,e){return i.$isEmpty(e)||g(l)||Tn(e,o||0,l)},n.$observe("step",function(t){l=Nn(t),i.$validate()}))},url:function(t,e,n,i,r,s){kn(0,e,n,i,r,s),Cn(i),i.$$parserName="url",i.$validators.url=function(t,e){var n=t||e;return i.$isEmpty(n)||Br.test(n)}},email:function(t,e,n,i,r,s){kn(0,e,n,i,r,s),Cn(i),i.$$parserName="email",i.$validators.email=function(t,e){var n=t||e;return i.$isEmpty(n)||Gr.test(n)}},radio:function(t,e,n,i){var r=!n.ngTrim||"false"!==ai(n.ngTrim);g(n.name)&&e.attr("name",++ei),e.on("click",function(t){var s;e[0].checked&&(s=n.value,r&&(s=ai(s)),i.$setViewValue(s,t&&t.type))}),i.$render=function(){var t=n.value;r&&(t=ai(t)),e[0].checked=t===i.$viewValue},n.$observe("value",i.$render)},range:function(t,e,n,i,r,s){function o(t,i){e.attr(t,n[t]),n.$observe(t,i)}An(0,e,0,i),jn(i),kn(0,e,n,i,r,s);var a=i.$$hasNativeValidators&&"range"===e[0].type,l=a?0:void 0,c=a?100:void 0,u=a?1:void 0,h=e[0].validity;t=v(n.min),r=v(n.max),s=v(n.step);var f=i.$render;i.$render=a&&v(h.rangeUnderflow)&&v(h.rangeOverflow)?function(){f(),i.$setViewValue(e.val())}:f,t&&(i.$validators.min=a?function(){return!0}:function(t,e){return i.$isEmpty(e)||g(l)||e>=l},o("min",function(t){l=Nn(t),ni(i.$modelValue)||(a?(t=e.val(),l>t&&(t=l,e.val(t)),i.$setViewValue(t)):i.$validate())})),r&&(i.$validators.max=a?function(){return!0}:function(t,e){return i.$isEmpty(e)||g(c)||e<=c},o("max",function(t){c=Nn(t),ni(i.$modelValue)||(a?(t=e.val(),c<t&&(e.val(c),t=c<l?l:c),i.$setViewValue(t)):i.$validate())})),s&&(i.$validators.step=a?function(){return!h.stepMismatch}:function(t,e){return i.$isEmpty(e)||g(u)||Tn(e,l||0,u)},o("step",function(t){u=Nn(t),ni(i.$modelValue)||(a&&i.$viewValue!==e.val()?i.$setViewValue(e.val()):i.$validate())}))},checkbox:function(t,e,n,i,r,s,o,a){var l=Mn(a,t,"ngTrueValue",n.ngTrueValue,!0),c=Mn(a,t,"ngFalseValue",n.ngFalseValue,!1);e.on("click",function(t){i.$setViewValue(e[0].checked,t&&t.type)}),i.$render=function(){e[0].checked=i.$viewValue},i.$isEmpty=function(t){return!1===t},i.$formatters.push(function(t){return M(t,l)}),i.$parsers.push(function(t){return t?l:c})},hidden:d,button:d,submit:d,reset:d,file:d},ts=["$browser","$sniffer","$filter","$parse",function(t,e,n,i){return{restrict:"E",require:["?ngModel"],link:{pre:function(r,s,o,a){a[0]&&(Fr[Jn(o.type)]||Fr.text)(r,s,o,a[0],e,t,n,i)}}}}],es=/^(true|false|\d+)$/,ns=function(){function t(t,e,n){var i=v(n)?n:9===_n?"":null;t.prop("value",i),e.$set("value",n)}return{restrict:"A",priority:100,compile:function(e,n){return es.test(n.ngValue)?function(e,n,i){t(n,i,e=e.$eval(i.ngValue))}:function(e,n,i){e.$watch(i.ngValue,function(e){t(n,i,e)})}}}},is=["$compile",function(t){return{restrict:"AC",compile:function(e){return t.$$addBindingClass(e),function(e,n,i){t.$$addBindingInfo(n,i.ngBind),n=n[0],e.$watch(i.ngBind,function(t){n.textContent=rt(t)})}}}}],rs=["$interpolate","$compile",function(t,e){return{compile:function(n){return e.$$addBindingClass(n),function(n,i,r){n=t(i.attr(r.$attr.ngBindTemplate)),e.$$addBindingInfo(i,n.expressions),i=i[0],r.$observe("ngBindTemplate",function(t){i.textContent=g(t)?"":t})}}}}],ss=["$sce","$parse","$compile",function(t,e,n){return{restrict:"A",compile:function(i,r){var s=e(r.ngBindHtml),o=e(r.ngBindHtml,function(e){return t.valueOf(e)});return n.$$addBindingClass(i),function(e,i,r){n.$$addBindingInfo(i,r.ngBindHtml),e.$watch(o,function(){var n=s(e);i.html(t.getTrustedHtml(n)||"")})}}}}],os=$({restrict:"A",require:"ngModel",link:function(t,e,n,i){i.$viewChangeListeners.push(function(){t.$eval(n.ngChange)})}}),as=Vn("",!0),ls=Vn("Odd",0),cs=Vn("Even",1),us=wn({compile:function(t,e){e.$set("ngCloak",void 0),t.removeClass("ng-cloak")}}),hs=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],fs={},ds={blur:!0,focus:!0};s("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(t){var e=Bt("ng-"+t);fs[e]=["$parse","$rootScope",function(n,i){return{restrict:"A",compile:function(r,s){var o=n(s[e]);return function(e,n){n.on(t,function(n){var r=function(){o(e,{$event:n})};ds[t]&&i.$$phase?e.$evalAsync(r):e.$apply(r)})}}}}]});var ps=["$animate","$compile",function(t,e){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(n,i,r,s,o){var a,l,c;n.$watch(r.ngIf,function(n){n?l||o(function(n,s){l=s,n[n.length++]=e.$$createComment("end ngIf",r.ngIf),a={clone:n},t.enter(n,i.parent(),i)}):(c&&(c.remove(),c=null),l&&(l.$destroy(),l=null),a&&(c=nt(a.clone),t.leave(c).done(function(t){!1!==t&&(c=null)}),a=null))})}}}],$s=["$templateRequest","$anchorScroll","$animate",function(t,e,n){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:ti.noop,compile:function(i,r){var s=r.ngInclude||r.src,o=r.onload||"",a=r.autoscroll;return function(i,r,l,c,u){var h,f,d,p=0,$=function(){f&&(f.remove(),f=null),h&&(h.$destroy(),h=null),d&&(n.leave(d).done(function(t){!1!==t&&(f=null)}),f=d,d=null)};i.$watch(s,function(s){var l=function(t){!1===t||!v(a)||a&&!i.$eval(a)||e()},f=++p;s?(t(s,!0).then(function(t){if(!i.$$destroyed&&f===p){var e=i.$new();c.template=t,t=u(e,function(t){$(),n.enter(t,null,r).done(l)}),d=t,(h=e).$emit("$includeContentLoaded",s),i.$eval(o)}},function(){i.$$destroyed||f!==p||($(),i.$emit("$includeContentError",s))}),i.$emit("$includeContentRequested",s)):($(),c.template=null)})}}}}],ms=["$compile",function(e){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(n,i,r,s){Zn.call(i[0]).match(/SVG/)?(i.empty(),e(ut(s.template,t.document).childNodes)(n,function(t){i.append(t)},{futureParentElement:i})):(i.html(s.template),e(i.contents())(n))}}}],gs=wn({priority:450,compile:function(){return{pre:function(t,e,n){t.$eval(n.ngInit)}}}}),vs=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(t,e,n,i){var r=n.ngList||", ",o="false"!==n.ngTrim,a=o?ai(r):r;i.$parsers.push(function(t){if(!g(t)){var e=[];return t&&s(t.split(a),function(t){t&&e.push(o?ai(t):t)}),e}}),i.$formatters.push(function(t){if(si(t))return t.join(r)}),i.$isEmpty=function(t){return!t||!t.length}}}},ws="ng-valid",bs="ng-invalid",xs="ng-pristine",Os="ng-dirty",Ss=e("ngModel");Dn.$inject="$scope $exceptionHandler $attrs $element $parse $animate $timeout $q $interpolate".split(" "),Dn.prototype={$$initGetterSetters:function(){if(this.$options.getOption("getterSetter")){var t=this.$$parse(this.$$attr.ngModel+"()"),e=this.$$parse(this.$$attr.ngModel+"($$$p)");this.$$ngModelGet=function(e){var n=this.$$parsedNgModel(e);return C(n)&&(n=t(e)),n},this.$$ngModelSet=function(t,n){C(this.$$parsedNgModel(t))?e(t,{$$$p:n}):this.$$parsedNgModelAssign(t,n)}}else if(!this.$$parsedNgModel.assign)throw Ss("nonassign",this.$$attr.ngModel,U(this.$$element))},$render:d,$isEmpty:function(t){return g(t)||""===t||null===t||t!=t},$$updateEmptyClasses:function(t){this.$isEmpty(t)?(this.$$animate.removeClass(this.$$element,"ng-not-empty"),this.$$animate.addClass(this.$$element,"ng-empty")):(this.$$animate.removeClass(this.$$element,"ng-empty"),this.$$animate.addClass(this.$$element,"ng-not-empty"))},$setPristine:function(){this.$dirty=!1,this.$pristine=!0,this.$$animate.removeClass(this.$$element,Os),this.$$animate.addClass(this.$$element,xs)},$setDirty:function(){this.$dirty=!0,this.$pristine=!1,this.$$animate.removeClass(this.$$element,xs),this.$$animate.addClass(this.$$element,Os),this.$$parentForm.$setDirty()},$setUntouched:function(){this.$touched=!1,this.$untouched=!0,this.$$animate.setClass(this.$$element,"ng-untouched","ng-touched")},$setTouched:function(){this.$touched=!0,this.$untouched=!1,this.$$animate.setClass(this.$$element,"ng-touched","ng-untouched")},$rollbackViewValue:function(){this.$$timeout.cancel(this.$$pendingDebounce),this.$viewValue=this.$$lastCommittedViewValue,this.$render()},$validate:function(){if(!ni(this.$modelValue)){var t=this.$$lastCommittedViewValue,e=this.$$rawModelValue,n=this.$valid,i=this.$modelValue,r=this.$options.getOption("allowInvalid"),s=this;this.$$runValidators(e,t,function(t){r||n===t||(s.$modelValue=t?e:void 0,s.$modelValue!==i&&s.$$writeModelToScope())})}},$$runValidators:function(t,e,n){function i(t,e){o===a.$$currentValidationRunId&&a.$setValidity(t,e)}function r(t){o===a.$$currentValidationRunId&&n(t)}this.$$currentValidationRunId++;var o=this.$$currentValidationRunId,a=this;!function(){var t=a.$$parserName||"parse";return g(a.$$parserValid)?(i(t,null),!0):(a.$$parserValid||(s(a.$validators,function(t,e){i(e,null)}),s(a.$asyncValidators,function(t,e){i(e,null)})),i(t,a.$$parserValid),a.$$parserValid)}()?r(!1):function(){var n=!0;return s(a.$validators,function(r,s){var o=Boolean(r(t,e));n=n&&o,i(s,o)}),!!n||(s(a.$asyncValidators,function(t,e){i(e,null)}),!1)}()?function(){var n=[],o=!0;s(a.$asyncValidators,function(r,s){var a=r(t,e);if(!a||!C(a.then))throw Ss("nopromise",a);i(s,void 0),n.push(a.then(function(){i(s,!0)},function(){o=!1,i(s,!1)}))}),n.length?a.$$q.all(n).then(function(){r(o)},d):r(!0)}():r(!1)},$commitViewValue:function(){var t=this.$viewValue;this.$$timeout.cancel(this.$$pendingDebounce),(this.$$lastCommittedViewValue!==t||""===t&&this.$$hasNativeValidators)&&(this.$$updateEmptyClasses(t),this.$$lastCommittedViewValue=t,this.$pristine&&this.$setDirty(),this.$$parseAndValidate())},$$parseAndValidate:function(){var t=this.$$lastCommittedViewValue,e=this;if(this.$$parserValid=!g(t)||void 0)for(var n=0;n<this.$parsers.length;n++)if(g(t=this.$parsers[n](t))){this.$$parserValid=!1;break}ni(this.$modelValue)&&(this.$modelValue=this.$$ngModelGet(this.$$scope));var i=this.$modelValue,r=this.$options.getOption("allowInvalid");this.$$rawModelValue=t,r&&(this.$modelValue=t,e.$modelValue!==i&&e.$$writeModelToScope()),this.$$runValidators(t,this.$$lastCommittedViewValue,function(n){r||(e.$modelValue=n?t:void 0,e.$modelValue!==i&&e.$$writeModelToScope())})},$$writeModelToScope:function(){this.$$ngModelSet(this.$$scope,this.$modelValue),s(this.$viewChangeListeners,function(t){try{t()}catch(t){this.$$exceptionHandler(t)}},this)},$setViewValue:function(t,e){this.$viewValue=t,this.$options.getOption("updateOnDefault")&&this.$$debounceViewValueCommit(e)},$$debounceViewValueCommit:function(t){var e=this.$options.getOption("debounce");O(e[t])?e=e[t]:O(e.default)&&(e=e.default),this.$$timeout.cancel(this.$$pendingDebounce);var n=this;0<e?this.$$pendingDebounce=this.$$timeout(function(){n.$commitViewValue()},e):this.$$scope.$root.$$phase?this.$commitViewValue():this.$$scope.$apply(function(){n.$commitViewValue()})},$overrideModelOptions:function(t){this.$options=this.$options.createChild(t)}},On({clazz:Dn,set:function(t,e){t[e]=!0},unset:function(t,e){delete t[e]}});var Cs,ks=["$rootScope",function(t){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:Dn,priority:1,compile:function(e){return e.addClass(xs).addClass("ng-untouched").addClass(ws),{pre:function(t,e,n,i){var r=i[0];e=i[1]||r.$$parentForm,(i=i[2])&&(r.$options=i.$options),r.$$initGetterSetters(),e.$addControl(r),n.$observe("name",function(t){r.$name!==t&&r.$$parentForm.$$renameControl(r,t)}),t.$on("$destroy",function(){r.$$parentForm.$removeControl(r)})},post:function(e,n,i,r){function s(){o.$setTouched()}var o=r[0];o.$options.getOption("updateOn")&&n.on(o.$options.getOption("updateOn"),function(t){o.$$debounceViewValueCommit(t&&t.type)}),n.on("blur",function(){o.$touched||(t.$$phase?e.$evalAsync(s):e.$apply(s))})}}}}}],Es=/(\s+|^)default(\s+|$)/;Ln.prototype={getOption:function(t){return this.$$options[t]},createChild:function(t){var e=!1;return s(t=c({},t),function(n,i){"$inherit"===n?"*"===i?e=!0:(t[i]=this.$$options[i],"updateOn"===i&&(t.updateOnDefault=this.$$options.updateOnDefault)):"updateOn"===i&&(t.updateOnDefault=!1,t[i]=ai(n.replace(Es,function(){return t.updateOnDefault=!0," "})))},this),e&&(delete t["*"],In(t,this.$$options)),In(t,Cs.$$options),new Ln(t)}},Cs=new Ln({updateOn:"",updateOnDefault:!0,debounce:0,getterSetter:!1,allowInvalid:!1,timezone:null});var Ps=function(){function t(t,e){this.$$attrs=t,this.$$scope=e}return t.$inject=["$attrs","$scope"],t.prototype={$onInit:function(){var t=this.parentCtrl?this.parentCtrl.$options:Cs,e=this.$$scope.$eval(this.$$attrs.ngModelOptions);this.$options=t.createChild(e)}},{restrict:"A",priority:10,require:{parentCtrl:"?^^ngModelOptions"},bindToController:!0,controller:t}},As=wn({terminal:!0,priority:1e3}),js=e("ngOptions"),Ns=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([$\w][$\w]*)|(?:\(\s*([$\w][$\w]*)\s*,\s*([$\w][$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,ys=["$compile","$document","$parse",function(e,n,i){function o(t,e,n){function s(t,e,n,i,r){this.selectValue=t,this.viewValue=e,this.label=n,this.group=i,this.disabled=r}function o(t){var e;if(!c&&r(t))e=t;else for(var n in e=[],t)t.hasOwnProperty(n)&&"$"!==n.charAt(0)&&e.push(n);return e}var a=t.match(Ns);if(!a)throw js("iexp",t,U(e));var l=a[5]||a[7],c=a[6];t=/ as /.test(a[0])&&a[1];var u=a[9];e=i(a[2]?a[1]:l);var h=t&&i(t)||e,f=u&&i(u),d=u?function(t,e){return f(n,e)}:function(t){return yt(t)},p=function(t,e){return d(t,b(t,e))},$=i(a[2]||a[1]),m=i(a[3]||""),g=i(a[4]||""),v=i(a[8]),w={},b=c?function(t,e){return w[c]=e,w[l]=t,w}:function(t){return w[l]=t,w};return{trackBy:u,getTrackByValue:p,getWatchables:i(v,function(t){for(var e=[],i=o(t=t||[]),r=i.length,s=0;s<r;s++){var l=t[c=t===i?s:i[s]],c=b(l,c);l=d(l,c);e.push(l),(a[2]||a[1])&&(l=$(n,c),e.push(l)),a[4]&&(c=g(n,c),e.push(c))}return e}),getOptions:function(){for(var t=[],e={},i=v(n)||[],r=o(i),a=r.length,l=0;l<a;l++){var c=i===r?l:r[l],f=b(i[c],c),w=h(n,f);w=new s(c=d(w,f),w,$(n,f),m(n,f),f=g(n,f));t.push(w),e[c]=w}return{items:t,selectValueMap:e,getOptionFromViewValue:function(t){return e[p(t)]},getViewValueFromOption:function(t){return u?T(t.viewValue):t.viewValue}}}}}var a=t.document.createElement("option"),l=t.document.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","ngModel"],link:{pre:function(t,e,n,i){i[0].registerOption=d},post:function(t,i,r,c){function u(t){var e=(t=w.getOptionFromViewValue(t))&&t.element;return e&&!e.selected&&(e.selected=!0),t}function h(){var t=w&&f.readValue();if(w)for(var e=w.items.length-1;0<=e;e--){var n=w.items[e];v(n.group)?kt(n.element.parentNode):kt(n.element)}w=b.getOptions();var r={};g&&i.prepend(f.emptyOption),w.items.forEach(function(t){var e;if(v(t.group)){(e=r[t.group])||(e=l.cloneNode(!1),x.appendChild(e),e.label=null===t.group?"null":t.group,r[t.group]=e);var n=a.cloneNode(!1)}else e=x,n=a.cloneNode(!1);e.appendChild(n),function(t,e){t.element=e,e.disabled=t.disabled,t.label!==e.label&&(e.label=t.label,e.textContent=t.label),e.value=t.selectValue}(t,n)}),i[0].appendChild(x),d.$render(),d.$isEmpty(t)||(e=f.readValue(),(b.trackBy||p?M(t,e):t===e)||(d.$setViewValue(e),d.$render()))}var f=c[0],d=c[1],p=r.multiple;c=0;for(var $=i.children(),m=$.length;c<m;c++)if(""===$[c].value){f.hasEmptyOption=!0,f.emptyOption=$.eq(c);break}var g=!!f.emptyOption;qn(a.cloneNode(!1)).val("?");var w,b=o(r.ngOptions,i,t),x=n[0].createDocumentFragment();f.generateUnknownOptionValue=function(t){return"?"},p?(f.writeValue=function(t){var e=t&&t.map(u)||[];w.items.forEach(function(t){t.element.selected&&-1===Array.prototype.indexOf.call(e,t)&&(t.element.selected=!1)})},f.readValue=function(){var t=i.val()||[],e=[];return s(t,function(t){(t=w.selectValueMap[t])&&!t.disabled&&e.push(w.getViewValueFromOption(t))}),e},b.trackBy&&t.$watchCollection(function(){if(si(d.$viewValue))return d.$viewValue.map(function(t){return b.getTrackByValue(t)})},function(){d.$render()})):(f.writeValue=function(t){var e=w.selectValueMap[i.val()],n=w.getOptionFromViewValue(t);e&&e.element.removeAttribute("selected"),n?(i[0].value!==n.selectValue&&(f.removeUnknownOption(),f.unselectEmptyOption(),i[0].value=n.selectValue,n.element.selected=!0),n.element.setAttribute("selected","selected")):g?f.selectEmptyOption():f.unknownOption.parent().length?f.updateUnknownOption(t):f.renderUnknownOption(t)},f.readValue=function(){var t=w.selectValueMap[i.val()];return t&&!t.disabled?(f.unselectEmptyOption(),f.removeUnknownOption(),w.getViewValueFromOption(t)):null},b.trackBy&&t.$watch(function(){return b.getTrackByValue(d.$viewValue)},function(){d.$render()})),g&&(f.emptyOption.remove(),e(f.emptyOption)(t),8===f.emptyOption[0].nodeType?(f.hasEmptyOption=!1,f.registerOption=function(t,e){""===e.val()&&(f.hasEmptyOption=!0,f.emptyOption=e,f.emptyOption.removeClass("ng-scope"),d.$render(),e.on("$destroy",function(){f.hasEmptyOption=!1,f.emptyOption=void 0}))}):f.emptyOption.removeClass("ng-scope")),i.empty(),h(),t.$watchCollection(b.getWatchables,h)}}}}],Ts=["$locale","$interpolate","$log",function(t,e,n){var i=/{}/g,r=/^when(Minus)?(.+)$/;return{link:function(o,a,l){function c(t){a.text(t||"")}var u,h=l.count,f=l.$attr.when&&a.attr(l.$attr.when),p=l.offset||0,$=o.$eval(f)||{},m={},v=e.startSymbol(),w=e.endSymbol(),b=v+h+"-"+p+w,x=ti.noop;s(l,function(t,e){var n=r.exec(e);n&&(n=(n[1]?"-":"")+Jn(n[2]),$[n]=a.attr(l.$attr[e]))}),s($,function(t,n){m[n]=e(t.replace(i,b))}),o.$watch(h,function(e){var i=parseFloat(e),r=ni(i);r||i in $||(i=t.pluralCat(i-p)),i===u||r&&ni(u)||(x(),g(r=m[i])?(null!=e&&n.debug("ngPluralize: no rule defined for '"+i+"' in "+f),x=d,c()):x=o.$watch(r,c),u=i)})}}}],Ms=["$parse","$animate","$compile",function(t,n,i){var o=e("ngRepeat"),a=function(t,e,n,i,r,s,o){t[n]=i,r&&(t[r]=s),t.$index=e,t.$first=0===e,t.$last=e===o-1,t.$middle=!(t.$first||t.$last),t.$odd=!(t.$even=0==(1&e))};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function(e,l){var c=l.ngRepeat,u=i.$$createComment("end ngRepeat",c);if(!(h=c.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/)))throw o("iexp",c);var h,f=h[1],d=h[2],p=h[3],$=h[4];if(!(h=f.match(/^(?:(\s*[$\w]+)|\(\s*([$\w]+)\s*,\s*([$\w]+)\s*\))$/)))throw o("iidexp",f);var m=h[3]||h[1],g=h[2];if(p&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(p)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(p)))throw o("badident",p);var v,w,b,x,O={$id:yt};return $?v=t($):(b=function(t,e){return yt(e)},x=function(t){return t}),function(t,e,i,l,h){v&&(w=function(e,n,i){return g&&(O[g]=e),O[m]=n,O.$index=i,v(t,O)});var f=it();t.$watchCollection(d,function(i){var l,d,$,v,O,S,C,k,E,P,A=e[0],j=it();if(p&&(t[p]=i),r(i))k=i,d=w||b;else for(P in d=w||x,k=[],i)Bn.call(i,P)&&"$"!==P.charAt(0)&&k.push(P);for(v=k.length,P=Array(v),l=0;l<v;l++)if(O=i===k?l:k[l],S=i[O],C=d(O,S,l),f[C])E=f[C],delete f[C],j[C]=E,P[l]=E;else{if(j[C])throw s(P,function(t){t&&t.scope&&(f[t.id]=t)}),o("dupes",c,C,S);P[l]={id:C,scope:void 0,clone:void 0},j[C]=!0}for($ in f){if(C=nt((E=f[$]).clone),n.leave(C),C[0].parentNode)for(l=0,d=C.length;l<d;l++)C[l].$$NG_REMOVED=!0;E.scope.$destroy()}for(l=0;l<v;l++)if(O=i===k?l:k[l],S=i[O],(E=P[l]).scope){$=A;do{$=$.nextSibling}while($&&$.$$NG_REMOVED);E.clone[0]!==$&&n.move(nt(E.clone),null,A),A=E.clone[E.clone.length-1],a(E.scope,l,m,S,g,O,v)}else h(function(t,e){E.scope=e;var i=u.cloneNode(!1);t[t.length++]=i,n.enter(t,null,A),A=i,E.clone=t,j[E.id]=E,a(E.scope,l,m,S,g,O,v)});f=j})}}}}],Vs=["$animate",function(t){return{restrict:"A",multiElement:!0,link:function(e,n,i){e.$watch(i.ngShow,function(e){t[e?"removeClass":"addClass"](n,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],Ds=["$animate",function(t){return{restrict:"A",multiElement:!0,link:function(e,n,i){e.$watch(i.ngHide,function(e){t[e?"addClass":"removeClass"](n,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],Ls=wn(function(t,e,n){t.$watch(n.ngStyle,function(t,n){n&&t!==n&&s(n,function(t,n){e.css(n,"")}),t&&e.css(t)},!0)}),Is=["$animate","$compile",function(t,e){return{require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(n,i,r,o){var a=[],l=[],c=[],u=[],h=function(t,e){return function(n){!1!==n&&t.splice(e,1)}};n.$watch(r.ngSwitch||r.on,function(n){for(var i,r;c.length;)t.cancel(c.pop());for(i=0,r=u.length;i<r;++i){var f=nt(l[i].clone);u[i].$destroy(),(c[i]=t.leave(f)).done(h(c,i))}l.length=0,u.length=0,(a=o.cases["!"+n]||o.cases["?"])&&s(a,function(n){n.transclude(function(i,r){u.push(r);var s=n.element;i[i.length++]=e.$$createComment("end ngSwitchWhen"),l.push({clone:i}),t.enter(i,s.parent(),s)})})})}}}],Hs=wn({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(t,e,n,i,r){s(n.ngSwitchWhen.split(n.ngSwitchWhenSeparator).sort().filter(function(t,e,n){return n[e-1]!==t}),function(t){i.cases["!"+t]=i.cases["!"+t]||[],i.cases["!"+t].push({transclude:r,element:e})})}}),_s=wn({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(t,e,n,i,r){i.cases["?"]=i.cases["?"]||[],i.cases["?"].push({transclude:r,element:e})}}),qs=e("ngTransclude"),Us=["$compile",function(t){return{restrict:"EAC",terminal:!0,compile:function(e){var n=t(e.contents());return e.empty(),function(t,e,i,r,s){function o(){n(t,function(t){e.append(t)})}if(!s)throw qs("orphan",U(e));i.ngTransclude===i.$attr.ngTransclude&&(i.ngTransclude=""),s(function(t,n){var i;if(i=t.length)t:{i=0;for(var r=t.length;i<r;i++){var s=t[i];if(s.nodeType!==mi||s.nodeValue.trim()){i=!0;break t}}i=void 0}i?e.append(t):(o(),n.$destroy())},null,i=i.ngTransclude||i.ngTranscludeSlot),i&&!s.isSlotFilled(i)&&o()}}}}],Rs=["$templateCache",function(t){return{restrict:"E",terminal:!0,compile:function(e,n){"text/ng-template"===n.type&&t.put(n.id,e[0].text)}}}],zs={$setViewValue:d,$render:d},Bs=["$element","$scope",function(e,n){function i(){a||(a=!0,n.$$postDigest(function(){a=!1,s.ngModelCtrl.$render()}))}function r(t){l||(l=!0,n.$$postDigest(function(){n.$$destroyed||(l=!1,s.ngModelCtrl.$setViewValue(s.readValue()),t&&s.ngModelCtrl.$render())}))}var s=this,o=new Di;s.selectValueMap={},s.ngModelCtrl=zs,s.multiple=!1,s.unknownOption=qn(t.document.createElement("option")),s.hasEmptyOption=!1,s.emptyOption=void 0,s.renderUnknownOption=function(t){t=s.generateUnknownOptionValue(t),s.unknownOption.val(t),e.prepend(s.unknownOption),Hn(s.unknownOption,!0),e.val(t)},s.updateUnknownOption=function(t){t=s.generateUnknownOptionValue(t),s.unknownOption.val(t),Hn(s.unknownOption,!0),e.val(t)},s.generateUnknownOptionValue=function(t){return"? "+yt(t)+" ?"},s.removeUnknownOption=function(){s.unknownOption.parent()&&s.unknownOption.remove()},s.selectEmptyOption=function(){s.emptyOption&&(e.val(""),Hn(s.emptyOption,!0))},s.unselectEmptyOption=function(){s.hasEmptyOption&&s.emptyOption.removeAttr("selected")},n.$on("$destroy",function(){s.renderUnknownOption=d}),s.readValue=function(){var t=(t=e.val())in s.selectValueMap?s.selectValueMap[t]:t;return s.hasOption(t)?t:null},s.writeValue=function(t){var n=e[0].options[e[0].selectedIndex];n&&Hn(qn(n),!1),s.hasOption(t)?(s.removeUnknownOption(),n=yt(t),e.val(n in s.selectValueMap?n:t),Hn(qn(e[0].options[e[0].selectedIndex]),!0)):null==t&&s.emptyOption?(s.removeUnknownOption(),s.selectEmptyOption()):s.unknownOption.parent().length?s.updateUnknownOption(t):s.renderUnknownOption(t)},s.addOption=function(t,e){if(8!==e[0].nodeType){tt(t,'"option value"'),""===t&&(s.hasEmptyOption=!0,s.emptyOption=e);var n=o.get(t)||0;o.set(t,n+1),i()}},s.removeOption=function(t){var e=o.get(t);e&&(1===e?(o.delete(t),""===t&&(s.hasEmptyOption=!1,s.emptyOption=void 0)):o.set(t,e-1))},s.hasOption=function(t){return!!o.get(t)};var a=!1,l=!1;s.registerOption=function(t,e,n,o,a){if(n.$attr.ngValue){var l,c=NaN;n.$observe("value",function(t){var n,i=e.prop("selected");v(c)&&(s.removeOption(l),delete s.selectValueMap[c],n=!0),c=yt(t),l=t,s.selectValueMap[c]=t,s.addOption(t,e),e.attr("value",c),n&&i&&r()})}else o?n.$observe("value",function(t){s.readValue();var n,i=e.prop("selected");v(l)&&(s.removeOption(l),n=!0),l=t,s.addOption(t,e),n&&i&&r()}):a?t.$watch(a,function(t,i){n.$set("value",t);var o=e.prop("selected");i!==t&&s.removeOption(i),s.addOption(t,e),i&&o&&r()}):s.addOption(n.value,e);n.$observe("disabled",function(t){("true"===t||t&&e.prop("selected"))&&(s.multiple?r(!0):(s.ngModelCtrl.$setViewValue(null),s.ngModelCtrl.$render()))}),e.on("$destroy",function(){var t=s.readValue(),e=n.value;s.removeOption(e),i(),(s.multiple&&t&&-1!==t.indexOf(e)||t===e)&&r(!0)})}}],Gs=function(){return{restrict:"E",require:["select","?ngModel"],controller:Bs,priority:1,link:{pre:function(t,e,n,i){var r=i[0],o=i[1];if(o){if(r.ngModelCtrl=o,e.on("change",function(){r.removeUnknownOption(),t.$apply(function(){o.$setViewValue(r.readValue())})}),n.multiple){r.multiple=!0,r.readValue=function(){var t=[];return s(e.find("option"),function(e){e.selected&&!e.disabled&&(e=e.value,t.push(e in r.selectValueMap?r.selectValueMap[e]:e))}),t},r.writeValue=function(t){s(e.find("option"),function(e){var n=!!t&&(-1!==Array.prototype.indexOf.call(t,e.value)||-1!==Array.prototype.indexOf.call(t,r.selectValueMap[e.value]));n!==e.selected&&Hn(qn(e),n)})};var a,l=NaN;t.$watch(function(){l!==o.$viewValue||M(a,o.$viewValue)||(a=st(o.$viewValue),o.$render()),l=o.$viewValue}),o.$isEmpty=function(t){return!t||0===t.length}}}else r.registerOption=d},post:function(t,e,n,i){var r=i[1];if(r){var s=i[0];r.$render=function(){s.writeValue(r.$viewValue)}}}}}},Js=["$interpolate",function(t){return{restrict:"E",priority:100,compile:function(e,n){var i,r;return v(n.ngValue)||(v(n.value)?i=t(n.value,!0):(r=t(e.text(),!0))||n.$set("value",e.text())),function(t,e,n){var s=e.parent();(s=s.data("$selectController")||s.parent().data("$selectController"))&&s.registerOption(t,e,n,i,r)}}}}],Ws=function(){return{restrict:"A",require:"?ngModel",link:function(t,e,n,i){i&&(n.required=!0,i.$validators.required=function(t,e){return!n.required||!i.$isEmpty(e)},n.$observe("required",function(){i.$validate()}))}}},Ys=function(){return{restrict:"A",require:"?ngModel",link:function(t,n,i,r){if(r){var s,o=i.ngPattern||i.pattern;i.$observe("pattern",function(t){if(x(t)&&0<t.length&&(t=new RegExp("^"+t+"$")),t&&!t.test)throw e("ngPattern")("noregexp",o,t,U(n));s=t||void 0,r.$validate()}),r.$validators.pattern=function(t,e){return r.$isEmpty(e)||g(s)||s.test(e)}}}}},Ks=function(){return{restrict:"A",require:"?ngModel",link:function(t,e,n,i){if(i){var r=-1;n.$observe("maxlength",function(t){t=h(t),r=ni(t)?-1:t,i.$validate()}),i.$validators.maxlength=function(t,e){return 0>r||i.$isEmpty(e)||e.length<=r}}}}},Xs=function(){return{restrict:"A",require:"?ngModel",link:function(t,e,n,i){if(i){var r=0;n.$observe("minlength",function(t){r=h(t)||0,i.$validate()}),i.$validators.minlength=function(t,e){return i.$isEmpty(e)||e.length>=r}}}}};t.angular.bootstrap?t.console&&console.log("WARNING: Tried to load angular more than once."):(function(){var e;if(!$i){var n=ui();(Un=g(n)?t.jQuery:n?t[n]:void 0)&&Un.fn.on?(qn=Un,c(Un.fn,{scope:Ni.scope,isolateScope:Ni.isolateScope,controller:Ni.controller,injector:Ni.injector,inheritedData:Ni.inheritedData}),e=Un.cleanData,Un.cleanData=function(t){for(var n,i,r=0;null!=(i=t[r]);r++)(n=Un._data(i,"events"))&&n.$destroy&&Un(i).triggerHandler("$destroy");e(t)}):qn=ht,ti.element=qn,$i=!0}}(),function(i){c(i,{errorHandlingConfig:n,bootstrap:Y,copy:T,extend:c,merge:u,equals:M,element:qn,forEach:s,injector:Vt,noop:d,bind:D,toJson:I,fromJson:H,identity:p,isUndefined:g,isDefined:v,isString:x,isFunction:C,isObject:w,isNumber:O,isElement:j,isArray:si,version:gi,isDate:S,lowercase:Jn,uppercase:Wn,callbacks:{$$counter:0},getTestability:X,reloadWithDebugInfo:K,$$minErr:e,$$csp:ci,$$encodeUriSegment:G,$$encodeUriQuery:J,$$stringify:rt}),(Rn=function(t){function n(t,e,n){return t[e]||(t[e]=n())}var i=e("$injector"),r=e("ng");return(t=n(t,"angular",Object)).$$minErr=t.$$minErr||e,n(t,"module",function(){var t={};return function(e,s,o){var a={};if("hasOwnProperty"===e)throw r("badname","module");return s&&t.hasOwnProperty(e)&&(t[e]=null),n(t,e,function(){function t(t,e,n,i){return i||(i=l),function(){return i[n||"push"]([t,e,arguments]),f}}function n(t,n,i){return i||(i=l),function(r,s){return s&&C(s)&&(s.$$moduleName=e),i.push([t,n,arguments]),f}}if(!s)throw i("nomod",e);var l=[],c=[],u=[],h=t("$injector","invoke","push",c),f={_invokeQueue:l,_configBlocks:c,_runBlocks:u,info:function(t){if(v(t)){if(!w(t))throw r("aobj","value");return a=t,this}return a},requires:s,name:e,provider:n("$provide","provider"),factory:n("$provide","factory"),service:n("$provide","service"),value:t("$provide","value"),constant:t("$provide","constant","unshift"),decorator:n("$provide","decorator",c),animation:n("$animateProvider","register"),filter:n("$filterProvider","register"),controller:n("$controllerProvider","register"),directive:n("$compileProvider","directive"),component:n("$compileProvider","component"),config:h,run:function(t){return u.push(t),this}};return o&&h(o),f})}})}(t))("ng",["ngLocale"],["$provide",function(t){t.provider({$$sanitizeUri:Ue}),t.provider("$compile",Rt).directive({a:Ir,input:ts,textarea:ts,form:Ur,script:Rs,select:Gs,option:Js,ngBind:is,ngBindHtml:ss,ngBindTemplate:rs,ngClass:as,ngClassEven:cs,ngClassOdd:ls,ngCloak:us,ngController:hs,ngForm:Rr,ngHide:Ds,ngIf:ps,ngInclude:$s,ngInit:gs,ngNonBindable:As,ngPluralize:Ts,ngRepeat:Ms,ngShow:Vs,ngStyle:Ls,ngSwitch:Is,ngSwitchWhen:Hs,ngSwitchDefault:_s,ngOptions:ys,ngTransclude:Us,ngModel:ks,ngList:vs,ngChange:os,pattern:Ys,ngPattern:Ys,required:Ws,ngRequired:Ws,minlength:Xs,ngMinlength:Xs,maxlength:Ks,ngMaxlength:Ks,ngValue:ns,ngModelOptions:Ps}).directive({ngInclude:ms}).directive(Hr).directive(fs),t.provider({$anchorScroll:Dt,$animate:Ji,$animateCss:Ki,$$animateJs:Bi,$$animateQueue:Gi,$$AnimateRunner:Yi,$$animateAsyncRun:Wi,$browser:_t,$cacheFactory:qt,$controller:Yt,$document:Kt,$$isDocumentHidden:Xt,$exceptionHandler:Zt,$filter:tn,$$forceReflow:nr,$interpolate:le,$interval:ce,$http:se,$httpParamSerializer:Ft,$httpParamSerializerJQLike:te,$httpBackend:ae,$xhrFactory:oe,$jsonpCallbacks:ur,$location:Oe,$log:Se,$parse:De,$rootScope:qe,$q:Le,$$q:Ie,$sce:Be,$sceDelegate:ze,$sniffer:Ge,$templateCache:Ut,$templateRequest:Je,$$testability:We,$timeout:Ye,$window:Ze,$$rAF:_e,$$jqLite:Nt,$$Map:Li,$$cookieReader:Fe})}]).info({angularVersion:"1.6.3"})}(ti),ti.module("ngLocale",[],["$provide",function(t){t.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:"January February March April May June July August September October November December".split(" "),SHORTDAY:"Sun Mon Tue Wed Thu Fri Sat".split(" "),SHORTMONTH:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),STANDALONEMONTH:"January February March April May June July August September October November December".split(" "),WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a",short:"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-¤",negSuf:"",posPre:"¤",posSuf:""}]},id:"en-us",localeID:"en_US",pluralCat:function(t,e){var n=0|t,i=e;return void 0===i&&(i=Math.min(function(t){var e=(t+="").indexOf(".");return-1==e?0:t.length-e-1}(t),3)),Math.pow(10,i),1==n&&0==i?"one":"other"}})}]),qn(function(){W(t.document,Y)}))}(window),!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>')},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);const s=angular.module("mainApp",["ngRoute","ngCookies","ngAnimate","as.sortable"]);window.app=s,s.config(function(t){t.when("/",{templateUrl:"dashboard.html",controller:"dashboardCtrl as dashboard"}).when("/dashboard",{resolve:{check:function(t,e,n,i){const r=e.getAll();if(n.loggedIn)t.path("/dashboard");else if(r.hasOwnProperty("login")&&r.hasOwnProperty("pwd")){let s={};s.login=r.login,s.pwd=r.pwd,i.post("php/authorization.php",s).then(function(i){!0===i.data.loggin&&(n.loggedIn=!0,t.path("/dashboard"),n.name=i.data.name,e.put("loggedIn",i.data.loggin),e.put("username",i.data.name),e.put("login",i.data.login),e.put("pwd",i.data.pwd),console.log(e))},function(t){console.log(t)})}else t.path("/")}},templateUrl:"dashboard.html",controller:"dashboardCtrl as dashboard"}).when("/company",{templateUrl:"./templates/paths/company/index.html",controller:"companyCtrl"}).when("/polis",{templateUrl:"./templates/paths/polis/index.html",controller:"polisCtrl as polisCtrl"}).when("/calculation",{templateUrl:"./templates/paths/calculation/index.html",controller:"calculationCtrl as calculation"}).when("/polisEditor",{templateUrl:"./templates/paths/polisEditor/index.html",controller:"polisEditorCtrl"}).when("/finance",{templateUrl:"./templates/paths/finance/index.html",controller:"financeCtrl"}).when("/profile",{templateUrl:"./templates/paths/profile/index.html",controller:"profileCtrl"}).otherwise({redirectTo:"/"})}),s.directive("financeDashboard",function(){return{restrict:"A",templateUrl:"./templates/paths/finance/dashboard.html"}}),s.directive("financeMatrix",function(){return{restrict:"A",templateUrl:"./templates/paths/finance/matrix.html"}}),s.directive("financeReturn",function(){return{restrict:"A",templateUrl:"./templates/paths/finance/return.html"}}),s.directive("financeView",function(){return{restrict:"A",templateUrl:"./templates/views/finance.view.html"}}),s.directive("polisEditorReturn",function(){return{restrict:"A",templateUrl:"./templates/paths/polisEditor/return.html"}}),s.directive("polisEditorDashboard",function(){return{restrict:"A",templateUrl:"./templates/paths/polisEditor/dashboard.html"}}),s.directive("polisEditorMatrix",function(){return{restrict:"A",templateUrl:"./templates/paths/polisEditor/matrix.html"}}),s.directive("polisEditorNav",function(){return{restrict:"A",templateUrl:"./templates/paths/polisEditor/navigation.html"}}),s.directive("addition",function(){return{scope:{addition:"="},restrict:"A",templateUrl:"./templates/views/addition.view.html"}}),s.directive("companyView",function(){return{restrict:"A",templateUrl:"./templates/views/company.view.html"}}),s.directive("calculationBottomView",function(){return{restrict:"A",templateUrl:"./templates/paths/calculation/bottom.view.html"}}),s.directive("calculationBottom",function(){return{restrict:"A",templateUrl:"./templates/paths/calculation/bottom.html"}}),s.directive("calculationMatrix",function(){return{restrict:"A",templateUrl:"./templates/paths/calculation/matrix.html"}}),s.directive("calculationReturn",function(){return{restrict:"A",templateUrl:"./templates/paths/calculation/return.html"}}),s.directive("calculationNav",function(){return{restrict:"A",templateUrl:"./templates/paths/calculation/navigation.html"}}),s.directive("calculationDashboard",function(){return{restrict:"A",templateUrl:"./templates/paths/calculation/dashboard.html"}}),s.directive("calculationView",function(){return{restrict:"A",templateUrl:"./templates/views/calculation.view.html"}}),s.directive("polisDashboard",function(){return{restrict:"A",templateUrl:"./templates/paths/polis/dashboard.html"}}),s.directive("polisMatrix",function(){return{restrict:"A",templateUrl:"./templates/paths/polis/matrix.html"}}),s.directive("polisReturn",function(){return{restrict:"A",templateUrl:"./templates/paths/polis/return.html"}}),s.directive("polisHeader",function(){return{restrict:"A",templateUrl:"./templates/paths/polis/header.html"}}),s.directive("polisNav",function(){return{restrict:"A",templateUrl:"./templates/paths/polis/navigation.html"}}),s.directive("companyDashboard",function(){return{restrict:"A",templateUrl:"./templates/paths/company/dashboard.html"}}),s.directive("companyReturn",function(){return{restrict:"A",templateUrl:"./templates/paths/company/return.html"}}),s.directive("companyMatrix",function(){return{restrict:"A",templateUrl:"./templates/paths/company/matrix.html"}}),s.directive("companyNav",function(){return{restrict:"A",templateUrl:"./templates/paths/company/navigation.html"}}),s.directive("karetka",function(){return{restrict:"A",templateUrl:"./templates/dashboards/karetka.html"}}),s.directive("return",function(){return{restrict:"A",templateUrl:"./templates/paths/main/return.html"}}),s.directive("mainNav",function(){return{restrict:"A",templateUrl:"./templates/paths/main/navigation.html"}}),s.directive("findCompany",function(){return{restrict:"A",templateUrl:"./templates/matrix/find_company.html",link:function(t,e,n,i){}}}),s.directive("searchCompany",function(){return{restrict:"A",templateUrl:"./templates/paths/calculation/search-company.html",link:function(t,e,n,i){}}}),s.directive("findCalculation",function(){return{restrict:"A",templateUrl:"./templates/matrix/find_calculation.html"}}),s.directive("findCalculationView",function(){return{restrict:"A",templateUrl:"./templates/views/find_calculation_view.html"}}),s.directive("profileDashboard",function(){return{restrict:"A",templateUrl:"./templates/paths/profile/dashboard.html"}}),s.directive("profileHeader",function(){return{restrict:"A",templateUrl:"./templates/paths/profile/header.html"}}),s.directive("profileReturn",function(){return{restrict:"A",templateUrl:"./templates/paths/profile/return.html"}}),s.directive("profileMatrix",function(){return{restrict:"A",templateUrl:"./templates/paths/profile/matrix.html"}}),s.directive("profileNav",function(){return{restrict:"A",templateUrl:"./templates/paths/profile/navigation.html"}}),s.directive("profileCalcs",function(){return{restrict:"A",templateUrl:"./templates/paths/profile/calcs-matrix.html"}}),s.directive("loading",function(){return{restrict:"A",templateUrl:"./templates/views/loading.html"}}),s.directive("ngRightClick",function(t){return function(e,n,i){let r=t(i.ngRightClick);n.bind("contextmenu",function(t){e.$apply(function(){t.preventDefault(),r(e,{$event:t})})})}}),s.directive("importSheetJs",function(t){return{scope:{opts:"="},link:function(e,n,i){n.on("change",function(n){try{e.changeE=n;const r=new FileReader;r.onload=function(n){try{const r=i.importSheetJs.match(/\d+/gi)[0],s=i.importSheetJs.match(/\d+/gi)[1],o=t.parks[r],a=n.target.result,l=XLSX.read(a,{type:"binary"}),c=l.Sheets[l.SheetNames[0]];e.changeE.target.parentNode.classList.toggle("select--hidden");const u=function(t){let e=0,n=0;const i=parseInt(t["!ref"].match(/.:[A-Z]+(\d*)/)[1]);let r=!1;for(let s=1;s<=i;s++){const i=`A${s}`;if(t[i]&&1===t[i].v&&(e=s,r=!0),!t[i]&&r){n=s-1;break}}const s=[];for(let i=e;i<=n;i++){const e={model:t[`B${i}`]?t[`B${i}`].w.trim():"",autNumber:t[`C${i}`]?t[`C${i}`].w:"",VIN:t[`D${i}`]?t[`D${i}`].w:"",prodYear:t[`E${i}`]?t[`E${i}`].w:""};s.push(e)}return s}(c);t.setCarsFromExcel(u,o,r,s)}catch(n){alert("Выбран несоответствующий файл. Пожалуйста, выберите файл формата xls или xlsx"),console.error(n)}},r.readAsBinaryString(n.target.files[0])}catch(t){alert("Выбран несоответствующий файл. Пожалуйста, выберите файл формата xls или xlsx"),console.error(t)}})}}}),s.directive("currencyInput",function(t,e){return{require:"?ngModel",link:function(n,i,r,s){s&&(s.$formatters.unshift(function(){return t("number")(s.$modelValue)}),s.$parsers.unshift(function(e){let n=e.replace(/[\,\.\s]/g,""),r=t("number")(n);return i.val(r),n}),i.bind("click",t=>{t.target.select()}),i.bind("blur",t=>{if("a_limit"==r.currencyInput){i.val().replace(/[\s\,]/g,"");LimKoef=1;let t=e.a_limit;t.hand=!0,e.finalCalc(),t.value=1*i.val().replace(/[\s\,]/g,""),""==t.value||0==t.value?(t.type="Агр. лимит",t.value=t.max_limit,e.a_limit.value=t.max_limit,t.hand=!1,LimKoef=1):t.value==t.max_limit&&(t.hand=!1,LimKoef=1),e.applyAlimit(),e.finalCalc(),n.$apply()}else if("payment"==r.currencyInput)i.val()<=0||""==i.val()?(i.val(1),e.payment.hand=!1):(i.val()>12&&i.val(12),e.payment.hand=!0),e.payment.val=i.val(),e.finalCalc(),n.$apply();else if("practicalPrice"==r.currencyInput)console.log(e.totalPrice-e.totalPrice%1),0==i.val()||""==i.val()||e.practicalPrice.val==e.totalPrice-e.totalPrice%1?(e.checkPracticalPriceKoef(!1),e.practicalPrice.val==e.totalPrice-e.totalPrice%1&&i.val(""),e.bottom.priceMode="price"):(e.bottom.singleAmount&&(e.practicalPrice.val*=e.totalAmount/e.totalAmountForSingle),e.practicalPrice.koef=e.practicalPrice.val/e.totalPrice,e.checkPracticalPriceKoef(!0)),e.finalCalc(),n.$apply();else if("agents"==r.currencyInput){const t=e.agents.val;"%"===e.agents.mode&&t>50&&(e.agents.val=50),e.finalCalc(),n.$apply()}else{"listener"==n.calculation.karetka.mode&&(n.calculation.karetka.mode="making new process");let s=1*i.val().replace(/[\s\,]/g,"");if("Park"==e.process.constructor.name){"amount"==r.param&&"Тягачей"==e.amountType&&(s*=24);let t=e.process;Array.isArray(t[r.param])?e.parkTemplate.length:(t.changeProperty(r.param,s),e.finalCalc(),n.$apply())}else"Multi"==e.process.constructor.name?"amount"==r.param&&"Тягачей"==e.amountType?e.process.changeProperty(r.param,24*s):e.process.changeProperty(r.param,s):"amount"==r.param&&"Тягачей"==e.amountType?e.process[r.param]=24*s:e.process[r.param]=s;if("making new process"==n.calculation.karetka.mode){let i=0;for(let r in e.process){if(""===e.process[r]){return n.calculation.selectParam(i),t.target.blur(),void document.querySelector(".dashboard_container").focus()}i++}e.addNewProcess(),e.finalCalc(),n.$apply()}"changing process"==n.calculation.karetka.mode&&delete e.process.changing}}),i.bind("keydown keypress",t=>{let s=t.which;if(!(91==s||15<s&&s<19||37<=s&&s<=40))if("a_limit"==r.currencyInput){i.val().replace(/[\s\,]/g,"");if(13==s){LimKoef=1;let t=e.a_limit;t.hand=!0,e.finalCalc(),t.value=1*i.val().replace(/[\s\,]/g,""),""==t.value||0==t.value?(t.type="Агр. лимит",t.value=t.max_limit,e.a_limit.value=t.max_limit,t.hand=!1,LimKoef=1):t.value==t.max_limit&&(t.hand=!1,LimKoef=1),e.applyAlimit(),e.finalCalc(),console.log(e.a_limit.value),n.$apply()}}else if("payment"==r.currencyInput)13==s&&(i.val()<=0||""==i.val()?(i.val(1),e.payment.hand=!1):(i.val()>12&&i.val(12),e.payment.hand=!0),e.payment.val=i.val(),e.finalCalc(),n.$apply());else if("practicalPrice"==r.currencyInput)13==s&&(console.log(e.totalPrice-e.totalPrice%1),0==i.val()||""==i.val()||e.practicalPrice.val==e.totalPrice-e.totalPrice%1?(e.checkPracticalPriceKoef(!1),e.practicalPrice.val==e.totalPrice-e.totalPrice%1&&i.val(""),e.bottom.priceMode="price"):(e.bottom.singleAmount&&(e.practicalPrice.val*=e.totalAmount/e.totalAmountForSingle),e.practicalPrice.koef=e.practicalPrice.val/e.totalPrice,e.checkPracticalPriceKoef(!0)),e.finalCalc(),n.$apply());else if("agents"==r.currencyInput){if(13==s){const t=e.agents.val;"%"===e.agents.mode&&t>50&&(e.agents.val=50),e.finalCalc(),n.$apply()}}else if("listener"==n.calculation.karetka.mode&&(n.calculation.karetka.mode="making new process"),console.log(e.process),13==s){let s=1*i.val().replace(/[\s\,]/g,"");if("Park"==e.process.constructor.name){"amount"==r.param&&"Тягачей"==e.amountType&&(s*=24);let t=e.process;Array.isArray(t[r.param])?e.parkTemplate.length:(t.changeProperty(r.param,s),e.finalCalc(),n.$apply())}else"Multi"==e.process.constructor.name?"amount"==r.param&&"Тягачей"==e.amountType?e.process.changeProperty(r.param,24*s):e.process.changeProperty(r.param,s):"amount"==r.param&&"Тягачей"==e.amountType?e.process[r.param]=24*s:e.process[r.param]=s;if("making new process"==n.calculation.karetka.mode){let i=0;for(let r in e.process){if(""===e.process[r]){return n.calculation.selectParam(i),t.target.blur(),document.querySelector(".dashboard_container").focus(),void console.log(e.process)}i++}e.addNewProcess(),e.finalCalc(),n.$apply()}"changing process"==n.calculation.karetka.mode&&delete e.process.changing,n.calculation.clean(),t.target.blur()}}))}}}),s.factory("myFactory",function(){return{cameFrom:{name:null,path:null},karetkaTypes:{"Перевозчики":"HIP.json","Экспедиторы":"HIP-conf.json"},calcObj:{},companyObj:{},makingPolis:!1,addNewPolisProperty:function(){const t=this.polisObj.conditions;t.push({name:"",values:[]}),this.polisCurrent=t[t.length-1],this.polisCurrent.isNew=!0},polisCurrent:"",multi:{multies:[],mode:!1,count:0,template:[],arrays:{risk:[],wrapping:[]},clean:function(){this.arrays.risk=[],this.arrays.wrapping=[],this.mode=!1,this.template=[]}},multiChangeMode:function(t){void 0===t?0==this.multi.mode?(""!=this.process.wrapping&&"multi"!=this.process.wrapping&&this.multi.arrays.wrapping.indexOf(this.process.wrapping)&&this.multi.arrays.wrapping.push(this.process.wrapping),""!=this.process.risk&&"multi"!=this.process.risk&&this.multi.arrays.risk.indexOf(this.process.risk)&&this.multi.arrays.risk.push(this.process.risk),this.multi.mode=!0):this.multi.mode=!1:this.multi.mode=t,console.log(this.multi.mode)},keyCodes:{qwerty:{mass:[113,119,101,114,116,121,117,105,111,112],length:0},number:{mass:[49,50,51,52,53,54,55,56,57,48],length:7},tab:{mass:[60,62,167,177]}},document:{model:"Расчет",currParam:0,selectedParam:0,clean:function(){this.currParam="",this.selectedParam=""},currency:"Р"},bottom:{singleAmount:!1,priceMode:"price"},matrixType:"find",a_limit:{max_limit:0,value:0,type:"Агр. лимит",hand:!1},changeAlimit(){let t=this.a_limit;"Агр. лимит"==t.type?(t.type="Кол-во случаев",t.value=1,t.hand=!0,this.applyAlimit()):(t.hand=!1,t.type="Агр. лимит",t.hand||(t.value=t.max_limit))},setAlimitAsTimes(t){let e=this.a_limit;if("Кол-во случаев"===e.type&&e.value===t)return!0;LimKoef=1,e.type="Кол-во случаев",e.value=t,e.hand=!0,this.finalCalc(),this.applyAlimit(),this.finalCalc()},setAlimitAsAgr(){const t=this.a_limit;t.hand=!1,t.type="Агр. лимит",t.hand||(t.value=t.max_limit)},applyAlimit:function(){let t=this.a_limit;if(t.value<t.max_limit&&"Агр. лимит"==t.type)this.parks.forEach(function(e){e.cutDownLimits(t.value)}),t.hand=!1,LimKoef=1;else{let e=0;this.cleanUpProcessesInParks(),"Кол-во случаев"==t.type?(this.parks.forEach(function(n){e+=1*n.calculateMatrixWithAlimit(t.value,!0)}),LimKoef=e/this.totalPrice):(this.parks.forEach(function(n){e+=1*n.calculateMatrixWithAlimit(t.value,!1)}),e=Math.abs(e-this.totalPriceWithoutPayments),e*=t.max_limit/t.value,e+=this.totalPrice,e/=this.totalPrice,LimKoef=e)}},payment:{val:0,hand:!1,mode:"ON",totalPrice:null,leftPrice:null,calcDebt:null,payed:"0",changeMode:function(){"ON"==this.mode?(this.mode="OFF",this.val=1,this.hand=!1):this.mode="ON"},makeArray(t,{start:e="",end:n="",time:i="",startDate:s=""}){const o=t=>{let e=t.getDate(),n=t.getMonth()+1;return e<10&&(e=`0${e}`),n<10&&(n=`0${n}`),`${e}.${n}.${t.getFullYear()}`};this.totalPrice=t,this.datesWhenCreated={start:e,end:n,time:i};let a=Object(r.addSpaces)(Math.round(t/this.val));this.calcDebt=a,this.leftPrice=Object(r.addSpaces)(Math.round(t/this.val)*this.val);const l=[],c=((t,e,n)=>{switch(n){case"Год":return 12;case"6 месяцев":return 6;case"Вручную":return Math.ceil((new Date(e)-new Date(t))/2592e6);default:return 12}})(e=e.replace(/(\d+).(\d+).(\d+)/,"$2.$1.$3"),n=n.replace(/(\d+).(\d+).(\d+)/,"$2.$1.$3"),i);c<this.val&&console.warn("Продолжительность договора меньше чем этапов платежей");for(let t=0;t<this.val;t++){let n=10===e.length?new Date(s):new Date;n.setMonth(n.getMonth()+t*(c/this.val)),n=o(n),l.push({price:"",date:"",debt:a,debtDate:n,manual:!1})}this.array=l}},agents:{val:"",getKoef:function(t){if(this.val*=1,"%"==this.mode){return t/(1-this.val/100)/t}return(t+this.val)/t},mode:"%",changeMode:function(){"Р"==this.mode?this.mode="%":this.mode="Р"}},practicalPrice:{val:"",koef:1},process:{cost:"",amount:"",wrapping:"",risk:"",limit:"",franchise:""},cleanProcess:function(){this.process={};for(let t=0;t<transportProp.length;t++)this.process[transportProp[t]]=""},amountType:"Тягачей",changeAmountType:function(){"Тягачей"==this.amountType?this.amountType="Рейсов":this.amountType="Тягачей"},parks:[],parkTemplate:[],choosePark(t,e,n,r){for(let e=0;e<t.length;e++){let n=t[e];if("Multi"==n.constructor.name){let i=n;t.splice(e,1);for(let n=0;n<i.processes.length;n++)t.splice(e+n,0,i.processes[n])}}if(e){let i=n;t.forEach(function(t){t.park=e,-1===e.processes.indexOf(t)&&(e.processes.splice(i,0,t),i++)})}else{let e=!1,n=this;if(0==this.parks.length?e=!0:t.forEach(function(t){-1!=n.parks[0].risks.indexOf(t.risk)&&(e=!0)}),e)if(r)for(let e=0;e<t.length;e++)0==e?this.parks.push(new i.Park(t[e])):(t[e].park=this.parks[this.parks.length-1],this.parks[this.parks.length-1].processes.splice(e,0,t[e]));else for(let e=0;e<t.length;e++)0==e?this.parks.splice(e,0,new i.Park(t[e])):(t[e].park=this.parks[0],this.parks[0].processes.splice(e,0,t[e]));else for(let e=0;e<t.length;e++)t[e].park=this.parks[0],this.parks[0].processes.unshift(t[e])}},checkPracticalPriceKoef:function(t){let e=this;t?this.parks.forEach(function(t){t.processes.forEach(function(t){t.practicalPriceKoef=e.practicalPrice.koef})}):this.parks.forEach(function(t){t.processes.forEach(function(t){delete t.practicalPriceKoef})})},calculateParksAmount(){let t=0;this.parks.forEach(function(e){t+=e.calculateAmount()}),totalAmount=t,this.totalAmount=totalAmount},findMaxLimit(){let t=0;this.parks.forEach(function(e){t=Math.max(e.findMaxLimit(),t)}),this.a_limit.max_limit=t},makePackage(){let t=[],e={};e.packName=this.process.risk,e.template=this.multi.template,this.process.risk=BASENAME,this.process.package=e.packName,t.push(new i.Process(this.process));let n=this;return this.multi.template.forEach(function(e){let r={};for(let t in n.process)r[t]=n.process[t];for(let t in e)r[t]="limit"==t||"franchise"==t?e[t]*n.process[t]:e[t];t.push(new i.Process(r))}),e.array=t,delete this.process.package,e},bindMulti:function(t,e){e.packName&&delete e.packName,e.template&&delete e.template;let n=[];e.processes.forEach(t=>n.push(t));for(let t=0;t<n.length;t++){n[t].remove()}return e.processes=t,e.processes.forEach(function(t){t.multi=e}),e},makeMulti(t){if(0==this.multi.arrays.risk.length&&this.multi.arrays.risk.push(this.process.risk),0==this.multi.arrays.wrapping.length&&this.multi.arrays.wrapping.push(this.process.wrapping),1===this.multi.arrays.wrapping.length&&1===this.multi.arrays.risk.length){this.process.risk=this.multi.arrays.risk[0],this.process.wrapping=this.multi.arrays.wrapping[0];let e=this.multi.arrays.risk[0],n=this.packages.filter(function(t){return t.name==e});if(n.length>0){this.multi.template=n[0].values;let e=this.makePackage();return t?(this.bindMulti(e.array,t),t.packName=e.packName,t.template=e.template):this.multi.multies.push(new i.Multi(e.array,e.packName,e.template)),e.array}if(!t)return[new i.Process(this.process)];{let e=this;t.processes.forEach(function(n){-1!=e.multi.arrays.risk.indexOf(n.risk)&&-1!=e.multi.arrays.wrapping.indexOf(n.wrapping)||t.processes.splice(t.processes.indexOf(n),1)})}}let e,n=[];for(let t=0;t<this.multi.arrays.wrapping.length;t++)for(let r=0;r<this.multi.arrays.risk.length;r++){this.process.wrapping=this.multi.arrays.wrapping[t],this.process.risk=this.multi.arrays.risk[r];let s=this.process.risk,o=this.packages.filter(function(t){return t.name==s});o.length>0?(this.multi.template=o[0].values,(e=this.makePackage()).array.forEach(function(t){n.push(t)})):n.push(new i.Process(this.process))}let r,s=!1;if(n.forEach(t=>{t.risk==BASENAME&&(s=!0)}),s)for(;n[0].risk!=BASENAME;)n.push(n.splice(0,1)[0]);return t?r=this.bindMulti(n,t):(r=new i.Multi(n),this.multi.multies.push(r)),e&&(r.packName=e.packName,r.template=e.template),n},addNewProcess(t,e,n){if("changing"==t){let t=this.process.park,r=this.process;this.cleanProcess();for(let t in r)-1!=transportProp.indexOf(t)&&(this.process[t]=r[t]);let s=t.processes.indexOf(r);const o=e?e.processes.length:1;if(r.multi){let e=t.processes.length;r.multi.processes.forEach(n=>{let i=t.processes.indexOf(n);i<e&&(e=i)}),s=e}else t.processes.splice(s,o);if(this.multi.template.length>0){let e=this.makePackage(),n=e.array;this.multi.multies.push(new i.Multi(n,e.packName,e.template)),this.choosePark(n,t,s)}else if(this.multi.arrays.risk.length>0||this.multi.arrays.wrapping.length>0){let i=this.makeMulti(e);void 0!==n&&(s=n),this.choosePark(i,t,s),this.multi.template=[]}}else if(this.multi.arrays.risk.length>0||this.multi.arrays.wrapping.length>0){let t=[];const e=function(){const t=[],e=[];return[...this.multi.arrays.risk].map(n=>{this.packages.some(t=>t.name===n)?t.push(n):e.push(n)}),{packages:t,notPackages:e}}.call(this);if(function({packages:t,notPackages:e}){return!(0===t.length||0===e.length&&1===t.length)}(e)){const n=function({packages:t,notPackages:e}){const n={};return t.forEach(t=>{this.packages.find(e=>e.name===t).values.map(t=>{const e=t.limit?t.limit:1;n[t.risk]=n[t.risk]?Math.max(n[t.risk],e):e})}),e.forEach(t=>{n[t]=1}),n}.call(this,e);this.multi.arrays.risk=[],delete n[BASENAME],this.multi.arrays.risk=Object.keys(n),this.multi.arrays.risk.unshift(BASENAME),(t=this.makeMulti()).forEach(t=>{const e=n[t.risk]?n[t.risk]:1;t.limit=t.limit*e})}else t=this.makeMulti();this.choosePark(t)}else if(this.multi.template.length>0){let t=this.makePackage(),e=t.array;this.multi.multies.push(new i.Multi(e,t.packName,t.template)),this.choosePark(e);const n=function(t){const e=this.packages.find(e=>e.name===t);return!!e&&e.times}.call(this,t.packName);n&&this.setAlimitAsTimes(n)}else this.choosePark([new i.Process(this.process)],void 0,void 0,t);this.cleanProcess()},getTotal:function(){let t=0;return this.parks.forEach(function(e){t+=e.getTotal()}),t},cleanUpProcessesInParks(){let t=[],e=this;this.parks.forEach(function(e,n){e.check().forEach(function(e){delete e.park,t.push(new i.Process(e))}),e.processes.length>0&&e.replaceBase()});const n=[];for(let t=0;t<this.parks.length;t++){const e=this.parks[t];0==e.processes.length&&n.push(e)}n.forEach(t=>e.parks.splice(e.parks.indexOf(t),1));for(let e=0;e<t.length;e++)this.process=t[e],this.addNewProcess("replacing");this.parks.forEach(function(t){t.check(!1);t.replaceBase()})},finalCalc(){if(this.parkTemplate=[],0==risks.length&&void 0!==this.currObj)for(let t=0;t<this.currObj.length;t++){let e=this.currObj;for(let n=0;n<e[t].values.length;n++)"risk"==e[t].values[n].type&&(risks[e[t].values[n].name]=e[t].values[n].value)}this.cleanUpProcessesInParks(),this.calculateParksAmount(),this.findMaxLimit();let t=this;if(this.parks.forEach(t=>{t.processes.forEach(t=>{delete t.showRows})}),this.multi.multies.forEach(function(e){1==e.processes.length&&(delete e.processes[0].multi,t.multi.multies.splice(t.multi.multies.indexOf(e),1))}),this.parks.forEach(function(e,n){0==e.processes.length?t.parks.splice(t.parks.indexOf(e),1):e.calculate()}),this.a_limit.hand&&("Агр. лимит"==this.a_limit.type&&this.a_limit.value>this.a_limit.max_limit||"Кол-во случаев"==this.a_limit.type)?this.parks.forEach(function(t){t.applyKoef(LimKoef)}):(this.a_limit.hand=!1,this.a_limit.value=this.a_limit.max_limit,this.a_limit.type="Агр. лимит"),this.totalPrice=this.getTotal(),!isNaN(this.totalPrice)){if("ON"==this.payment.mode){if(!this.payment.hand){let t=this.totalPrice/3e4;if(0==(t-=t%1))t=1;else if(t>12)t=12;else for(;1!=t&&2!=t&&4!=t&&6!=t&&12!=t;)t--;this.payment.val=t}let t=Object(r.Spline)(this.totalPrice,Points.payment,3);t=(t/=1100)*this.payment.val-t,this.payment.koef=1+t,this.parks.forEach(function(e){e.applyKoef(1+t)}),this.totalPriceWithoutPayments=this.totalPrice,this.totalPrice=this.getTotal()}if(0!=this.agents.val){let t=this.agents.getKoef(this.totalPrice);this.parks.forEach(function(e){e.applyKoef(t)})}if(this.totalPrice=this.getTotal(),"Тягачей"==this.amountType?this.totalAmountForSingle=24:this.totalAmountForSingle=1,this.totalPriceForSingle=this.totalPrice/(this.totalAmount/this.totalAmountForSingle),0!=this.practicalPrice.val&&""!=this.practicalPrice.val){this.parks.forEach(function(t){t.applyPracticalPriceKoef()});let t=this.getTotal();this.practicalPrice.val=Math.round(t),this.bottom.singleAmount&&(this.practicalPrice.val/=this.totalAmount/this.totalAmountForSingle)}this.multi.multies.forEach(function(t){t.calculatePrice()}),this.parks.forEach(function(t){t.getValues()}),this.fixHeight()}},fixHeight(){const t=document.documentElement.clientHeight,e=document.querySelector(".calc"),n=e?e.offsetTop:233,i=document.querySelector(".bottom");let r=t-(n+(i?i.offsetHeight:80)+8);e&&(e.style.maxHeight=`${r}px`)},removeCellSelection(t="matrix_table",e){const n=document.querySelector(`.${t} .mi_selected`);if(null!==n&&n.classList.toggle("mi_selected"),e)return!0;document.querySelectorAll(`.${t} .alreadySelected`).forEach(t=>t.classList.toggle("alreadySelected"))},deleteProcess(t){if(t.multi&&(t.multi.multi&&t.multi.multi.processes.splice(t.multi.multi.processes.indexOf(t.multi),1),t.multi.processes.splice(t.multi.processes.indexOf(t),1),t.multi.processes.length<2)){let e;if(t.multi.prevMulti?e=t.multi.prevMulti:t.multi.multi&&(e=t.multi.multi),e){if(t.multi.processes[0].multi=e,!e.processes)throw new Error("Верхний мульти с другой структурой. Нет .processes");e.processes.push(t.multi.processes[0])}this.multi.multies.splice(this.multi.multies.indexOf(t.multi),1)}t.park.processes.length>1?t.park.processes.splice(t.park.processes.indexOf(t),1):this.parks.splice(this.parks.indexOf(t.park),1)},cleanCalculations(){this.calculationName="";const t=this.a_limit;t.max_limit=0,t.value=0,t.type="Агр. лимит",t.hand=!1,this.agents.mode="%",this.agents.val="",this.amountType="Тягачей",this.bottom.priceMode="price",this.bottom.singleAmount=!1,this.matrixType="HIP",this.multi.arrays.risk=[],this.multi.arrays.wrapping=[],this.multi.count=0,this.multi.mode=!1,this.multi.multies=[],this.multi.template=[],this.parkTemplate=[],this.parks=[],this.payment.hand=!1,this.payment.mode="ON",this.payment.val=0,this.practicalPrice.koef=1,this.practicalPrice.val="",this.cleanProcess(),delete this.totalAmount,delete this.totalAmountForSingle,delete this.totalPrice,delete this.totalPriceForSingle,delete this.totalPriceWithoutPayments},async loadLinks(t,e){if("number"==typeof e&&(e=`${e}`),"calc_id"!==t&&"company_id"!==t&&"agent_id"!==t&&"contact_id"!==t&&"id"!==t)return void console.error(`Параметры функции неверны: ${t} должен быть calc_id, company_id ...`);const n=new FormData;n.append("type",t),n.append("id",e);const i=new Request("php/get_link.php",{method:"POST",body:n});return fetch(i).then(async t=>await t.json(),t=>{console.error("Ошибка поиска привязки расчета")})}}})},function(t,e,n){"use strict";n.r(e);var i=n(4),r=n(3),s=n(0);app.controller("calculationCtrl",function(t,e,n,o,a,l,c,u){this.span=1,this.karetkaDepth=1,this.myFactory=o;let h,f=this;function d(t){if(t.calcObj.isSaved&&t.calcObj.name&&t.calcObj.name.length>1){const e=t.calcObj.name;document.querySelector("#inputSaveCalc").value=e}}this.search_params=[],this.isArray=angular.isArray,this.config="HIP.json",this.myFactory.matrixType="HIP",void 0===this.myFactory.HIPname&&(this.myFactory.HIPname="Перевозчики"),this.myFactory.scop=this,this.myFactory.calcObj.isInited||(this.myFactory.calcObj=new i.a(this.myFactory)),this.loadMatrix=async function(){const t=this.myFactory.karetkaTypes[this.myFactory.HIPname];await e.post(`./src/${t}`).then(function(t){if(o.isLoading){const t=new r.a(!0);o.isLoading=t}f.currObj=[];let e=function(t){const e={},n={},i=[...t];t.forEach((t,i)=>{t.name&&1===t.values.length&&(e[i]=t.values[0].name),t.url&&1===t.values.length&&"Пакеты"!==t.url&&(n[t.url]=t.values[0])});for(let n in e){const r=t.find(t=>t.url===e[n]);i[+n].name=r.url,i[+n].values=r.values,console.warn(`${r.url} был заменен, так как в нем был только один параметр`)}for(let t in n){const e=n[t].type,r=i.find(t=>t.name&&t.model===e).values;let s;r.forEach((e,n)=>{e.name===t&&(s=n)}),r.splice(s,1,n[t]),i.forEach((e,n)=>{e.url===t&&(s=n)}),i.splice(s,1)}return i}(t.data);e=function(t){let e=[...t];function n(t){const n=e.filter(e=>e.url&&t.model===e.model&&t.url!==e.url),i=n.find(e=>{const n=e.values.map(t=>t.name);return n.includes(t.url)});return i}return e.forEach(e=>{if(e.name&&!e.url){e.depth=1;for(let n=0;n<e.values.length;n++){const i=e.values[n];if(i.urlTo){const n=i.urlTo,r=t.find(t=>t.url===n);r.depth=2,r.parent=e}}}}),function t(){let i=!1;for(let t of e)if(t.url&&!t.depth){const e=n(t);t.parent=e,t.depth=e.depth+1,i=!0}i&&t()}(),e}(e),f.currObj=e,f.myFactory.currObj=e;let n=f.currObj.filter(function(t){return"Пакеты"==t.url});n=n[0],f.myFactory.packages=n.values,"/calculation"===c.$$path&&f.myFactory.removeCellSelection("dashboard_container"),f.selectParam(0),0===o.parks.length&&(f.karetka.mode="making new process"),f.myFactory.keyCodes.qwerty.length=f.currObj.filter(function(t){return null!=t.name}).length,f.navStyle="width:"+100/f.currObj.length+"%;",f.config="HIP.json",f.myFactory.matrixType="HIP",void 0!==o.loadProcess&&(f.matrix.loadProcess(f.myFactory.loadProcess.process,f.myFactory.loadProcess.key),delete f.myFactory.loadProcess)},function(t){console.error(t)})},this.setParamToAllProcess=function(t,e,n){if("string"==typeof t&&t.includes("-"))return!1;const i=n.park,r=i.processes.indexOf(n);let s;const a=[];function l(){t=Array.isArray(t)?t[0]:t;const n=this.karetka.mode,i=o.multi.mode;s.forEach(n=>{if(n[e]=t,"limit"===e&&void 0!==n.package){delete n.multi.packName,delete n.multi.template,n.multi.processes.filter(t=>t.package==n.package).forEach(t=>delete t.package)}}),a.forEach(e=>{const n=[];let i=!1;e.wrapping.forEach(e=>{e!==t?n.push(e):i=!0}),i||n.unshift(t);const r={model:"wrapping"};o.process=e,o.multi.mode=!0,n.forEach(t=>{const e={name:t,type:"risk",value:risks[t],selected:!0};this.karetka.mode="changing process",this.karetka.clicked(r,e)})}),this.karetka.mode=n,o.multi.mode=i}(function(){"wrapping"===e?(()=>{s=i.processes.filter((t,e)=>!(!(e>r)||t.multi&&t.multi===n.multi&&!0!==n.multi.show||t.multi&&!1===t.multi.show&&i.processes.filter(e=>e.multi===t.multi).length>1)||!(!(e>r&&t.multi)||a.includes(t.multi)||t.multi===n.multi&&!0!==t.multi.show)&&(a.push(t.multi),!1)),Array.isArray(t)?1===t.length?l.call(this):function(){const e=this.karetka.mode,n=o.multi.mode,i={model:"wrapping"};o.multi.mode=!0,this.karetka.mode="changing process",s.forEach(e=>{o.process=e;const n=[];t.forEach(t=>{t!==e.wrapping&&n.push(t)});const r={name:n[0],type:"risk",value:risks[n[0]],selected:!0};this.karetka.clicked(i,r);const s=e.park.processes.find(t=>t.wrapping===e.wrapping&&t.risk===e.risk);a.push(s.multi)}),a.forEach(e=>{const n=[];t.forEach(t=>{e.wrapping.includes(t)||n.push(t)}),e.wrapping.forEach(e=>{t.includes(e)||n.push(e)}),n.forEach(t=>{o.process=e;const n={name:t,type:"risk",value:risks[t],selected:!0};this.karetka.clicked(i,n)})}),this.karetka.mode=e,o.multi.mode=n}.call(this):l.call(this)})():(()=>{s=i.processes.filter((t,e)=>e>r),function(){s.forEach(n=>{if(n[e]=t,"limit"===e&&void 0!==n.package){delete n.multi.packName,delete n.multi.template;let t=n.multi.processes.filter(t=>t.package==n.package);t.forEach(t=>delete t.package)}})}.call(this)})()}).call(this),o.finalCalc()},this.deleteProperty=function(t,e){delete t[e]},this.getUniqueId=((t,e)=>o.parks.indexOf(t.park).toString()+t.park.processes.indexOf(t)+e),this.clickedOnTopOfDashboard=((t,e)=>{switch(t.type){case"relocate_here":this.relocateHere(t.urlTo);break;case"relocatePage":this.relocatePage(t.urlTo);break;case"reloadDashboard":this.reloadDashboard(t.json,t.matrix);break;case"text":case"currency":case"amount":case"risk":this.karetka.clicked(e,t);break;case"amountType":this.myFactory.changeAmountType();break;case"currencyValue":break;case"saveCalc":this.saveCalculation();break;case"resaveCalc":if(!this.myFactory.calcObj.isSaved)break;this.saveCalculation({resave:!0});break;case"polisProject":this.makePolisProject()}}),this.keyHandler=(t=>{const e=t=>{if("Enter"!==t.code&&13!==t.code&&"Enter"!==t.key&&13!==t.key)return!1;const e=t.currentTarget.value.trim();if(""===e||!e||" "===e)return!1;this.myFactory.calcObj.isSaved&&this.myFactory.calcObj.name===e?this.saveCalculation({resave:!0}):this.saveCalculation()},n=t.currentTarget.id;if(!n)return!1;switch(n){case"inputSaveCalc":e(t)}}),this.tooltip={title:"",style:"",fadeIn(t,e){let n=!1;"object"==typeof t?(t=t.join("; "),n=!0):void 0!==risks[t]&&f.currObj.forEach(e=>{e.values.forEach(e=>{e.name==t&&void 0!==e.title&&(n=!0,t=e.title)})}),n&&(this.title=t,f.oldConfig=f.config,f.config="tooltip",this.style=e?"tooltip_span--multi":"")},fadeOut(){this.title="",f.config=f.oldConfig,delete f.oldConfig}},this.isRepeated=function(t,e){let n,i=t.park;if(1==o.parks.length&&1==i.processes.length||0==i.processes.indexOf(t))return!1;if(0!==i.processes.indexOf(t))n=i.processes[i.processes.indexOf(t)-1];else if(0!==o.parks.indexOf(i)){let t=o.parks[o.parks.indexOf(i)-1];n=t.processes[t.processes.length-1]}return n[e]===t[e]},this.multiClicked=function(){if("making new process"==this.karetka.mode)o.multiChangeMode(),!o.multi.mode&&f.selectNextParam()&&(o.addNewProcess(),o.finalCalc(),f.clean());else if("changing process"==this.karetka.mode){let t=o.process;if(o.multi.mode)"Multi"==t.constructor.name&&t[transportProp[o.document.currParam]].length>1?this.clean():o.multiChangeMode();else if("risk"==transportProp[o.document.currParam]||"wrapping"==transportProp[o.document.currParam])o.multiChangeMode();else if(void 0!==this.currObj[o.document.currParam].url){let t,e=this.currObj[o.document.currParam].url;this.currObj.forEach(n=>{n.values.forEach(i=>{i.urlTo===e&&(t=n)})});let n=this.currObj.indexOf(t);"risk"!=transportProp[n]&&"wrapping"!=transportProp[n]||o.multiChangeMode()}}},this.Confirm=function(){o.makingPolis&&(o.makingPolis="Расчет",c.path("/polis")),this.karetka.mode="confirm refresh",h=l(function(){f.karetka.mode="listener"},4e3)},this.alert=function(t){alert(t)},this.console=console,this.isNaN=function(t){return isNaN(t)},this.clean=function(t=!1){if(t&&0===this.myFactory.parks.length)return this.relocatePage("dashboard"),!0;this.tooltip.fadeOut();for(let t=0;t<f.currObj.length;t++){delete f.currObj[t].selected;for(let e=0;e<f.currObj[t].values.length;e++)delete f.currObj[t].values[e].selected,void 0!==f.currObj[t].values[e].oldValue&&(f.currObj[t].values[e].name=f.currObj[t].values[e].oldValue,delete f.currObj[t].values[e].oldValue),f.currObj[t].values[e].temporarily&&(f.currObj[t].values.splice(e,1),e--)}o.parkTemplate=[],o.multi.multies.forEach(function(t){delete t.changing,delete t.showRows,delete t.unselectable}),o.parks.forEach(function(t){delete t.changing,delete t.showRows,delete t.unselectable,t.processes.forEach(function(t){delete t.changing,delete t.showRows,delete t.unselectable})}),this.myFactory.document.clean(),this.myFactory.cleanProcess(),this.myFactory.multi.clean(),this.karetka.mode="listener",o.finalCalc()},this.isValue=function(t){let e=t.phone;return""!=e&&null!=e&&null!=e&&!isNaN(e)&&!angular.equals("",e)},this.isMulti=function(t){return t.contact.length>1},this.multiHeight=function(t){let e=100/t.length;return e="{height:"+e+"%;}"},this.reloadDashboard=function(t,n){"Компания"===t&&(t="HIP.json",n="HIP"),l.cancel(h),this.saveRes=12345;const i=`./src/${t}`;this.karetka.mode="listener",f.myFactory.removeCellSelection("dashboard_container"),e.post(i).then(function(e){if(f.myFactory.removeCellSelection(),f.currObj=[],f.currObj=e.data,f.myFactory.currObj=e.data,"HIP.json"!=t)f.selectParam(0);else{let t=f.currObj.filter(function(t){return"Пакеты"==t.url});t=t[0],f.myFactory.packages=t.values,0!=o.parks.length?f.selectParam(0):(f.selectParam(0),f.karetka.mode="making new process")}f.config=t,void 0!==n&&(f.myFactory.matrixType=n),"calculationActions"===f.myFactory.matrixType&&0===f.myFactory.document.currParam&&0===f.myFactory.document.selectedParam&&setTimeout(()=>d(f.myFactory),0)},function(t){console.error(t)})},this.relocatePage=function(t){this.myFactory.cameFrom={name:Object(s.getPathName)(c.$$path),path:c.$$path},"/"===(t="dashboard"===t?"":t)[0]&&(t=t.slice(1)),c.path(`/${t}`)},this.relocateHere=function(t){for(let e=0;e<f.currObj.length;e++)f.currObj[e].url===t&&f.selectParam(f.currObj.indexOf(f.currObj[e]))},this.currentUl=function(t){if(t===f.myFactory.document.currParam)return!0},this.setCurrentUl=function(t){return transportProp.indexOf(t)},this.currentProcess={},this.selectParam=function(e,n=!0){if(o.parkTemplate.length>0&&(o.parkTemplate=[]),this.currObj[e]&&void 0===this.currObj[e].name){const t=this.currObj[e].url,i=this.currObj[this.myFactory.document.currParam];n&&!function e(n,i,r){let s=i.values.some(e=>e.name===t);if(s)return s;const o=[];i.values.forEach(t=>{if(t.urlTo){const e=t.name,i=n.find(t=>t.url===e);o.push(i)}});const a=o.map(t=>e(n,t,r));s=a.some(t=>t);return s}(this.currObj,i,t)&&this.currObj.forEach(function(e,n){e.values.forEach(function(e){e.urlTo==t&&(o.document.selectedParam=n)})}),this.karetkaDepth=this.currObj[e].depth}else o.document.selectedParam=e,this.karetkaDepth=1;this.myFactory.document.currParam=e,""!==e&&(this.myFactory.keyCodes.number.length=this.currObj[this.myFactory.document.currParam].values.length+1,"listener"==this.karetka.mode&&(this.karetka.mode="making new process")),"Компания"!==this.myFactory.matrixType&&"calculationActions"!==this.myFactory.matrixType||(t.search_result=[]),"calculationActions"===this.myFactory.matrixType&&0===this.myFactory.document.currParam&&0===o.document.selectedParam&&d(this.myFactory)},u.putFullName=(()=>{!function(t){if(t.calcObj.isSaved&&t.calcObj.name&&t.calcObj.name.length>1){const e=new Date;let n=e.getHours();n=n<10?`0${n}`:`${n}`;let i=e.getMinutes();i=i<10?`0${i}`:`${i}`;let r=t.calcObj.name;const s=r.match(/ \d\d:\d\d/);s&&(r=r.slice(0,s.index));const o=`${r} ${n}:${i}`;t.scop.nameOfCalculation=o,document.querySelector("#inputSaveCalc").value=o}}(this.myFactory)}),this.selectParentParam=function(){const t=this.myFactory.document.currParam,e=this.currObj[t].parent,n=e.name||e.url,i=this.currObj.findIndex(t=>t.name===n||t.url===n);this.selectParam(i,!1)},this.depthSymbol=function(t){return{1:"I",2:"II",3:"III",4:"IV",5:"V",6:"VI"}[t]},this.selectNextParam=function(){let t=0;for(let e in o.process){if(""===o.process[e])return f.selectParam(t),!1;t++}return!0},this.checkTransportProp=function(t){return transportProp.indexOf(t)},this.configuration=function(t){if(1===t)return"navigation"===f.config},this.applyFilter=function(t,e,n){if(void 0!==n){if(Object(s.isNumeric)(t)||-1==t.indexOf("-")){if("cost"==e||"limit"==e||"franchise"==e)return a("currency")(t,"",0)+" Р";if("amount"==e){if("Тягачей"==this.myFactory.amountType)return a("currency")(t/TRACTOR,"",0)+" "+i(t/TRACTOR,o.amountType);if("Рейсов"==this.myFactory.amountType)return a("currency")(t,"",0)+" "+i(t,o.amountType)}return t}if(t=t.split("-"),"cost"==e||"limit"==e||"franchise"==e)return a("currency")(t[0],"",0)+" Р - "+a("currency")(t[1],"",0)+" Р";if("amount"==e){if("Тягачей"==this.myFactory.amountType)return a("currency")(t[0]/TRACTOR,"",0)+" "+i(t[0]/TRACTOR,o.amountType)+" - "+a("currency")(t[1]/TRACTOR,"",0)+" "+i(t[1]/TRACTOR,o.amountType);if("Рейсов"==this.myFactory.amountType)return a("currency")(t[0],"",0)+" "+i(t[0],o.amountType)+" - "+a("currency")(t[1],"",0)+" "+i(t[1],o.amountType)}}else if(void 0===e){if("currency"==t.type)return a(t.type)(t.name,"",0);if("amount"!=t.type)return t.name;if("Тягачей"==this.myFactory.amountType)return a("currency")(t.name/TRACTOR,"",0);if("Рейсов"==this.myFactory.amountType)return a("currency")(t.name,"",0)}else{if("cost"==e||"limit"==e||"franchise"==e)return a("currency")(t,"",0)+" Р";if("amount"==e){if("Тягачей"==this.myFactory.amountType)return a("currency")(t/TRACTOR,"",0)+" "+i(t/TRACTOR,o.amountType);if("Рейсов"==this.myFactory.amountType)return a("currency")(t,"",0)+" "+i(t,o.amountType)}else{if("badAssAmount"!=e)return Array.isArray(t)&&1===t.length?t[0]:t;if("Тягачей"==this.myFactory.amountType)return a("currency")(t,"",0)+" "+i(t,o.amountType);if("Рейсов"==this.myFactory.amountType)return a("currency")(t,"",0)+" "+i(t,o.amountType)}}function i(t,e){const n="Тягачей"===e?0:1,i=[["Тягач","Тягача"],["Рейс","Рейса"]];return 1===(t=+t)||t>20&&t%10==1?i[n][0]:2<=t&&t<=4||t>20&&2<=t%10&&t%10<=4?i[n][1]:e}},this.alreadySelected=function(e){return"calc"==t.mode&&!(""===o.process[e])},this.addPropertyToProcess=function(t,e){o.process[t.model]=e,t.name||f.currObj.forEach(function(e){e.name&&e.model==t.model&&(t=e)}),"amount"==t.model&&"Тягачей"==f.myFactory.amountType?t.selected=e/TRACTOR:t.selected=e},this.clickedSelectAll=function(t,e){f.myFactory.multiChangeMode(!0);let n=!0,i=f.myFactory.multi;t.values.forEach(function(r){r!=e&&(f.myFactory.multi.mode=!0,-1==i.arrays[t.model].indexOf(r.name)&&(r.selected=!0,i.arrays[t.model].push(r.name),n=!1))}),n&&t.values.forEach(e=>{delete e.selected,i.arrays[t.model].splice(i.arrays[t.model].indexOf(e.name),1)}),console.log(f.myFactory.multi)},this.clickedOnMulti=function(t,e){if("changing process"==f.karetka.mode&&"Process"==o.process.constructor.name&&o.multi.mode){let n,i=o.process.multi,r=i.processes[i.processes.indexOf(o.process)];const s=r.park;let a=r.park.processes.indexOf(r);const l=i.processes.indexOf(r),c=function(){const n=Object.assign({},r);return n[t.model]=e.name,s.contains([n])}();if(-1==i[t.model].indexOf(e.name)||i[t.model].length>1){if(c)o.process=Object.assign({},r),o.multi.arrays.risk=[r.risk],o.multi.arrays.wrapping=[r.wrapping],o.multi.arrays[t.model].push(e.name),o.addNewProcess(),n=o.parks[0].processes[0].multi;else{o.process=r,o.multi.arrays.risk=[r.risk],o.multi.arrays.wrapping=[r.wrapping],o.multi.arrays[t.model].push(e.name);o.makeMulti();s.processes.splice(a,1),o.addNewProcess("changing",null,a);let c=s.processes.find(t=>t.risk===r.risk&&t.wrapping===r.wrapping);a=s.processes.indexOf(c),i.processes[l]=s.processes[a].multi,(n=i.processes[l]).prevMulti=i,i.parent?(i.parent.processes?i.parent.processes.push(n):i.parent.push(n),n.parent=i.parent):(n.parent=i,n.multi=i)}return e.selected=!0,o.removeCellSelection(),o.finalCalc(),void f.matrix.loadMulti(n.processes[0],t.model)}}if("changing process"==f.karetka.mode&&"Multi"==o.process.constructor.name){let n,i=o.process,r=i.processes[0];if("Multi"==r.constructor.name&&(r=r.processes[0]),-1==i[t.model].indexOf(e.name)||i[t.model].length>1){if(o.process=r,o.multi.arrays.risk=i.risk,o.multi.arrays.wrapping=i.wrapping,-1!=o.multi.arrays[t.model].indexOf(e.name))o.multi.arrays[t.model].splice(o.multi.arrays[t.model].indexOf(e.name),1),n="unclick",delete e.selected;else if(console.log(t,e),"selectAll"==e.action)if(void 0===i.packName)this.clickedSelectAll(t,e);else{let n=[];i.template.forEach(t=>n.push(t.risk));let r=!0;if(t.values.forEach(i=>{i.name!=e.name&&-1===n.indexOf(i.name)&&-1===o.multi.arrays[t.model].indexOf(i.name)&&(i.selected=!0,r=!1,o.multi.arrays[t.model].push(i.name))}),r)return o.process=i,!1}else{if("package"==e.action){i.template=e.values,void 0!==i.packName&&o.multi.arrays[t.model].splice(o.multi.arrays[t.model].indexOf(i.packName)),i.removePackage(),i.prepareForPackage();let n=o.multi.arrays[t.model];-1!=n.indexOf(BASENAME)&&n.splice(n.indexOf(BASENAME),1);let r=[];i.template.forEach(t=>r.push(t.risk)),r.forEach(t=>{-1!=n.indexOf(t)&&n.splice(n.indexOf(t),1)})}if(void 0!==i.packName){t.values.forEach(t=>{t.name==i.packName&&delete t.selected});let n=[];if(i.template.forEach(t=>n.push(t.risk)),-1!==n.indexOf(e.name))return console.log("такой риск есть в пакете"),o.process=i,!1}o.multi.arrays[t.model].push(e.name),e.selected=!0}i.processes.forEach(function(t){"Multi"==t.constructor.name&&o.multi.multies.splice(o.multi.multies.indexOf(t),1)}),1==i.risk.length&&i.risk[0]==i.packName&&(o.process.risk=i.risk[0]);const s=()=>{const t=o;return t.packages.every(e=>e.name!==t.multi.arrays.risk[0])};if((()=>Object.values(o.multi.arrays).every(t=>1===t.length))()&&s()){o.removeCellSelection();const n="risk"===t.model?"wrapping":"risk";!function(t){if(t.multi){if(t.multi.processes.splice(t.multi.processes.indexOf(t),1),t.multi.parent){let e=t.multi.parent;const n=e.processes?e.processes:e;n.splice(n.indexOf(t.multi),1)}if(t.multi.processes.length<2){let e;if(t.multi.prevMulti?e=t.multi.prevMulti:t.multi.multi&&(e=t.multi.multi),e){if(t.multi.processes[0].multi=e,!e.processes)throw new Error("Верхний мульти с другой структурой. Нет .processes");e.processes.push(t.multi.processes[0])}else t.multi.parent?t.multi.processes[0].multi=t.multi.parent:delete t.multi.processes[0].multi;o.multi.multies.splice(o.multi.multies.indexOf(t.multi),1)}}t.park.processes.length>1?t.park.processes.splice(t.park.processes.indexOf(t),1):o.parks.splice(o.parks.indexOf(t.park),1);f.clean()}(r.park.processes.find(i=>i[t.model]===e.name&&i[n]===r[n])),o.finalCalc()}else{!function(){if("unclick"===n)return!1;const i=Object.assign({},o.process);return i[t.model]=e.name,i.park.contains([i])}()?(o.addNewProcess("changing",i),o.finalCalc(),o.process=i,1===o.multi.arrays[t.model].length&&f.clean()):(o.process=Object.assign({},i.processes[0]),o.multi.arrays.risk=i.risk,o.multi.arrays.wrapping=i.wrapping,o.addNewProcess(),o.process=o.parks[0].processes[0].multi,o.finalCalc(),f.matrix.loadMulti(o.process.processes[0],t.model))}}return}let n=f.myFactory.multi;if("selectAll"==e.action)f.myFactory.multiChangeMode(!0),t.values.forEach(function(n){if(n!=e){n.selected=!0,f.myFactory.multi.mode=!0;let e=f.myFactory.multi;-1==e.arrays[t.model].indexOf(n.name)&&(n.selected=!0,e.arrays[t.model].push(n.name))}}),console.log(f.myFactory.multi);else if(-1==n.arrays[t.model].indexOf(e.name))e.selected=!0,n.arrays[t.model].push(e.name);else{if(1===n.arrays[t.model].length)return delete e.selected,!1;delete e.selected,n.arrays[t.model].splice(n.arrays[t.model].indexOf(e.name),1)}n.arrays[t.model].length>1?f.addPropertyToProcess(t,"multi"):1==n.arrays[t.model].length?f.addPropertyToProcess(t,n.arrays[t.model][0]):(delete e.selected,delete t.selected,o.process[t.model]="")},this.pipeAmount=function(t){return isNaN(t)?t:t%TRACTOR!=0?t+" рейсов":t/24+" тягачей"},this.matrix={copyMulti(t){f.clean(),console.log(t);let e=[];t.processes.forEach(function(t){let n=new Process(t);e.push(n)});let n=new Multi(e);o.multi.multies.push(n);for(let e in t)"processes"!=e&&(n[e]=t[e]);const i=t.processes[0].park;!function(t){let e=!0;1===t.risk.length&&t.wrapping.length>1&&(e=!1);t.packName&&(e=!0);return e}(t)?e.forEach(t=>{i.processes.push(t)}):function(){let t=new Park(e);o.parks.splice(o.parks.indexOf(i)+1,0,t)}(),this.loadMulti(e[0],"risk"),o.finalCalc()},deleteMulti(t){o.removeCellSelection();let e=t.processes[0].park,n=t.processes.length;!function i(){t.processes.forEach(function(t){t.package&&e.processes.forEach(t=>{delete t.package}),e.processes.splice(e.processes.indexOf(t),1)});n!==t.processes.length&&(n=t.processes.length,i())}(),0==e.processes.length&&o.parks.splice(o.parks.indexOf(e),1),t.parent&&this.deleteMultiFromParent(t),o.multi.multies.splice(o.multi.multies.indexOf(t),1),f.clean(),console.log(o.parks,o.multi.multies)},deleteMultiFromParent(t){let e=t.parent;e.processes.splice(e.processes.indexOf(t),1),e.parent&&e.parent.forEach(e=>{e.processes.includes(t)&&e.processes.splice(e.processes.indexOf(t),1)}),t.parent.processes.length<2&&(e.processes.forEach(t=>{t.parent===t.prevMulti&&delete t.prevMulti,t.parent===t.multi&&delete t.multi,delete t.parent}),o.multi.multies.splice(o.multi.multies.indexOf(e),1)),t.multi&&t.multi.length<2&&delete t.multi},copyPark(t){f.clean();let e=t.copyPark(),{mass:n,park:i}=e;o.parks.push(i),o.choosePark(n,i,0);let r=n.filter(t=>"create"===t.multi);r.length>0&&o.multi.multies.push(new Multi(r)),n.forEach(t=>{if(t.package){let e=o.multi.multies[o.multi.multies.length-1];e.packName=t.package;let n=o.packages.filter(e=>e.name==t.package);return e.template=n[0].values,o.finalCalc(),!1}}),o.finalCalc()},deletePark(t){f.clean(),t.processes.forEach(t=>{t.multi&&"deleted"!=t.multi&&function t(e){e.processes.forEach(t=>{"Process"===t.constructor.name&&delete t.multi});e.parent&&t(e.parent);o.multi.multies.splice(o.multi.multies.indexOf(e),1)}(t.multi)}),o.parks.splice(o.parks.indexOf(t),1),o.finalCalc()},loadProcess(t,e){o.multi.multies.forEach(function(t){delete t.changing}),o.parks.forEach(function(t){delete t.changing,t.processes.forEach(function(t){delete t.changing})}),t.changing=!0,f.karetka.mode="changing process";for(let t=0;t<f.currObj.length;t++)for(let e=0;e<f.currObj[t].values.length;e++)delete f.currObj[t].values[e].selected;f.myFactory.document.currParam=transportProp.indexOf(e),f.myFactory.document.selectedParam=transportProp.indexOf(e),o.process=t;for(let n in t)if(-1!=transportProp.indexOf(n))if("cost"==n||"amount"==n||"limit"==n||"franchise"==n){const e=f.currObj.find(t=>t.model==n);for(let i=0;i<e.values.length;i++)if("input"==e.values[i].name&&("amount"==n&&"Тягачей"==f.myFactory.amountType?e.selected=t[n]/TRACTOR:e.selected=t[n]),e.values[i].name==t[n]){e.values[i].selected=!0;break}}else for(let i=0;i<f.currObj.length;i++)for(let r=0;r<f.currObj[i].values.length;r++)if(f.currObj[i].values[r].name==t[n]){f.currObj[i].selected=t[n],f.currObj[i].values[r].selected=!0,n==e&&f.selectParam(i);break}if("cost"==e||"amount"==e||"limit"==e||"franchise"==e){const n=f.currObj.find(t=>t.model==e).values.some(n=>n.name===t[e]),i=`#inputForCurrency-${e}`;n||setTimeout(()=>document.querySelector(i).focus(),700)}},loadMulti(t,e){f.selectParam(transportProp.indexOf(e));let n=t.multi;if(Object(s.isNumeric)(n[e])||-1==n[e].indexOf("-"))if(f.clean(),n.changing=!0,f.karetka.mode="changing process",("wrapping"==e||"risk"==e)&&n[e].length>1){o.multi.mode=!0,f.selectParam(transportProp.indexOf(e)),o.process=n;for(let t=0;t<f.currObj.length;t++)for(let i=0;i<f.currObj[t].values.length;i++)if(-1!=n[e].indexOf(f.currObj[t].values[i].name)&&(f.currObj[t].values[i].selected=!0,f.currObj[t].url)){let e=f.currObj[t].url;for(let t=0;t<f.currObj.length;t++)for(let n=0;n<f.currObj[t].values.length;n++)f.currObj[t].values[n].urlTo==e&&(f.currObj[t].values[n].selected=!0)}}else this.loadProcess(n,e)},loadPark(t,e){if(console.log(f.currObj),f.clean(),f.selectParam(transportProp.indexOf(e)),f.karetka.mode="changing process",t.changing=!0,o.process=t,Array.isArray(t[e])){for(let n=0;n<f.currObj.length;n++)for(let i=0;i<f.currObj[n].values.length;i++)if(-1!=t[e].indexOf(f.currObj[n].values[i].name)&&(f.currObj[n].values[i].selected=!0,f.currObj[n].url)){let t=f.currObj[n].url;for(let e=0;e<f.currObj.length;e++)for(let n=0;n<f.currObj[e].values.length;n++)f.currObj[e].values[n].urlTo==t&&(f.currObj[e].values[n].selected=!0)}}else if(Object(s.isNumeric)(t[e])||-1==t[e].indexOf("-"))this.loadProcess(t,e);else{let n=[];if(t.processes.forEach(function(t){(!t.package||t.package&&t.risk==BASENAME)&&n.push(t[e])}),n.length>10)return!1;let i=f.currObj.filter(function(t){return t.model==e});i=i[0];for(let t=0;t<n.length;t++)i.values.forEach(function(e){e.name==n[t]&&(e.selected=!0,n.splice(t,1),t--)});n.forEach(function(t){let n=null,r=null;if(i.values.forEach(function(e){Object(s.isNumeric)(e.name)&&(null===n?(n=Math.abs(e.name-t),r=e):null!==n&&n>Math.abs(e.name-t)&&(n=Math.abs(e.name-t),r=e))}),void 0===r.oldVal&&void 0===r.selected)r.oldVal=r.name,r.name=t,r.selected=!0;else{let n={};n.name=t,n.type="amount"==e?"amount":"currency",n.temporarily=!0,n.selected=!0,r.name>t?i.values.splice(i.values.indexOf(r),0,n):i.values.splice(i.values.indexOf(r)+1,0,n)}})}}},this.karetka={mode:"listener",multiClicked:function(t){console.log(t)},clicked:function(t,e){if("listener"==this.mode&&(this.mode="making new process"),"making new process"==this.mode)if(!f.myFactory.multi.mode||f.myFactory.multi.mode&&"wrapping"!=t.model&&"risk"!=t.model){if(f.addPropertyToProcess(t,e.name),e.selected=!0,"selectAll"==e.action)f.clickedSelectAll(t,e);else if("package"==e.action){f.myFactory.multi.template=e.values}f.selectNextParam()&&(o.addNewProcess(),o.finalCalc(),f.clean())}else f.clickedOnMulti(t,e);if("changing process"==this.mode)if("Park"==o.process.constructor.name){let n=o.process;if(Array.isArray(n[t.model])||!Object(s.isNumeric)(n[t.model])&&-1!=n[t.model].indexOf("-")){if(console.log(t,e),e.selected){let i=[];n.processes.forEach(function(n){n[t.model]==e.name&&-1==i.indexOf(n)&&i.push(n)}),o.parkTemplate=i,o.parkTemplateChangingValue=e.name}else if(o.parkTemplate.length>0){e.selected=!0;for(let t=0;t<f.currObj.length;t++)for(let e=0;e<f.currObj[t].values.length;e++)if(o.parkTemplateChangingValue==f.currObj[t].values[e].name&&(delete f.currObj[t].values[e].selected,f.currObj[t].url)){let e=!1;if(f.currObj[t].values.forEach(function(t){t.selected&&(e=!0)}),!e){let e=f.currObj[t].url;for(let t=0;t<f.currObj.length;t++)for(let n=0;n<f.currObj[t].values.length;n++)f.currObj[t].values[n].urlTo==e&&delete f.currObj[t].values[n].selected}}n.changeProperty(t.model,e.name,o.parkTemplate),o.finalCalc()}}else n.changeProperty(t.model,e.name),o.finalCalc(),f.clean()}else if("Multi"==o.process.constructor.name||o.process.multi&&o.multi.mode){o.finalCalc();let n=o.process;if(o.multi.mode)f.clickedOnMulti(t,e);else if(Object(s.isNumeric)(n[t.model])||1==n[t.model].length)if("package"==e.action||"selectAll"==e.action){if("risk"==t.model){if(o.multi.arrays.wrapping=n.wrapping,o.process=n.processes[0],o.process.risk=e.name,"package"==e.action)o.multi.arrays[t.model].push(e.name),n.processes[0].package&&n.processes.forEach(function(t,e){t.package&&0!=e&&t.park.processes.splice(t.park.processes.indexOf(t),1)});else if("selectAll"==e.action){let n=t.model;t.values.forEach(function(t){t.name!=e.name&&-1==o.multi.arrays[n].indexOf(t.name)&&(o.multi.arrays[n].push(t.name),t.selected=!0)})}o.addNewProcess("changing",n),delete f.myFactory.process.changing,"package"==e.action&&e.times&&(o.setAlimitAsTimes(e.times),o.finalCalc()),f.clean(),console.log(o.parks)}}else if(n[t.model][0]==n.packName&&"risk"==t.model){let i=n.processes[0];n.wrapping.length>1?(o.multi.arrays.wrapping=n.wrapping,i[t.model]=e.name,o.process=i,o.addNewProcess("changing",n)):(delete i.multi,n.processes.forEach(function(t,e){if(0!=e){let e=t.park;e.processes.splice(e.processes.indexOf(t),1)}}),n.processes=[],o.multi.multies.splice(o.multi.multies.indexOf(n),1),o.process=i,void 0!==o.process.package&&delete o.process.package,f.addPropertyToProcess(t,e.name),delete f.myFactory.process.changing),console.log(o.parks,o.multi.multies),o.removeCellSelection(),f.clean(),console.log(o.parks,o.multi.multies)}else{const i=Object.assign({},n);if(i.processes.map(n=>{n[t.model]=e.name}),n.processes[0].park.contains(i.processes)){o.multi.arrays.risk=[e.name],o.multi.arrays.wrapping=n.wrapping,"wrapping"===t.model&&console.error("Ожидалось изменение риска, пришел тип отсека. Необходимо поменять логику"),o.process=Object.assign({},n.processes[0]),o.multi.multies.splice(o.multi.multies.indexOf(n),1);const i=n.processes[0].park;n.processes.forEach(t=>{i.processes.splice(i.processes.indexOf(t),1)}),o.addNewProcess()}else n.changeProperty(t.model,e.name);delete f.myFactory.process.changing,f.clean()}}else if(f.myFactory.multi.mode){if(t.selected===e.name)return;o.removeCellSelection();let n=o.process;o.multi.arrays.wrapping=[n.wrapping],o.multi.arrays.risk=[n.risk],-1==o.multi.arrays[t.model].indexOf(e.name)&&o.multi.arrays[t.model].push(e.name),!function(){const i=Object.assign({},n);return i[t.model]=e.name,i.park.contains([i])}()?o.addNewProcess("changing"):(o.process=Object.assign({},n),o.addNewProcess()),f.clean(),n=o.multi.multies[o.multi.multies.length-1].processes[0],f.matrix.loadMulti(n,t.model)}else if("selectAll"==e.action){f.clickedSelectAll(t,e);let n=o.process;""!=o.process.wrapping&&"multi"!=o.process.wrapping&&o.multi.arrays.wrapping.indexOf(o.process.wrapping)&&o.multi.arrays.wrapping.push(o.process.wrapping),""!=o.process.risk&&"multi"!=o.process.risk&&o.multi.arrays.risk.indexOf(o.process.risk)&&o.multi.arrays.risk.push(o.process.risk),o.addNewProcess("changing"),f.clean(),n=o.multi.multies[o.multi.multies.length-1].processes[0],f.matrix.loadMulti(n,t.model)}else if("package"==e.action){let n=f.myFactory.multi;o.deleteProcess(o.process),n.template=e.values,o.process[t.model]=e.name,o.addNewProcess(),delete f.myFactory.process.changing,o.removeCellSelection(),e.times&&o.setAlimitAsTimes(e.times),f.clean()}else{f.addPropertyToProcess(t,e.name);o.process[t.model];if(angular.element(document.querySelector("td.mi_selected")).addClass("alreadySelected"),o.process.package&&o.process.multi&&"deleted"!=o.process.multi){delete o.process.multi.template,delete o.process.multi.packName;let t=o.process.package;o.process.multi.processes.forEach(function(e){e.package&&e.package==t&&delete e.package}),delete o.process.package,console.log(o.process.multi)}if(o.process.multi&&o.process.multi.show){o.process.park.contains([o.process])&&(o.deleteProcess(o.process),o.addNewProcess())}delete f.myFactory.process.changing,f.clean()}}},this.setHIP=async function(t){const e=this.myFactory.karetkaTypes[t];if(this.HIPname===t)return document.querySelector(".select_HIP div").classList.remove("select--hidden"),!0;o.removeCellSelection("dashboard_container"),await Object(s.loadRisks)(e),this.myFactory.HIPname=t,this.loadMatrix()},this.toogleMenu=function(){document.querySelector(".select_HIP .select_container").classList.toggle("select--hidden")},this.cleanCalcObj=(()=>{this.myFactory.calcObj=new i.a(this.myFactory)}),this.saveCalculation=function({withoutNotify:t,withoutName:n,resave:i}={}){if(!(""!=this.nameOfCalculation&&void 0!==this.nameOfCalculation||n||i))return!1;let r=[];o.parks.forEach(function(t){let e={};for(let n in t)"processes"!=n&&"carGroup"!=n?e[n]=t[n]:"carGroup"===n&&t[n]?e[n]=t[n].id:(e[n]=[],t.processes.forEach(function(t){let i={};for(let e in t)switch(e){case"multi":i[e]=o.multi.multies.indexOf(t.multi);break;case"park":case"cars":break;default:i[e]=t[e]}e[n].push(i)}));r.push(e)});let s=[];o.multi.multies.length>0&&o.multi.multies.forEach(function(t){let e={};for(let n in t)"processes"!=n&&(e[n]=t[n]);s.push(e)});let a={};this.myFactory.calculationName=this.nameOfCalculation;try{a.parks=JSON.stringify(r)}catch{let t=window.CircularJSON;a.parks=t.stringify(r)}try{a.mass=JSON.stringify(s)}catch{let t=window.CircularJSON;a.mass=t.stringify(s)}return a.payment=o.payment.val,a.agents=o.agents.val+";"+o.agents.mode,a.practicalPrice=o.practicalPrice.val+";"+o.practicalPrice.koef,a.a_limit=o.a_limit.value,a.a_limitType=o.a_limit.type,a.totalAmount=o.totalAmount,a.totalPrice=o.totalPrice,a.HIPname=o.HIPname,i?(a.type="update_calc",a.name=o.calcObj.name,a.id=o.calcObj.id):(a.type="save_calc",a.name=this.nameOfCalculation),e.post("php/save.php",a).then(function(e){if(isNaN(Number(e.data)))return alert("Ошибка при сохранении расчета. Пожалуйста, по возможности не закрывайте окно и обратитесь к разработчику"),console.error(e.data),!1;i?alert("Успешно пересохранено"):(t||alert("Успешно сохранено"),o.calcObj.id=e.data,o.calcObj.isSaved=!0,o.calcObj.name=o.calculationName)},function(t){console.log(t)})},this.linkToCompany=(async(t,e)=>{try{await this.linkTo({company_id:t}),await e(t,!0)}catch(t){console.error(t)}}),this.linkTo=(async t=>{const n=this.myFactory.calcObj;let i=!1;if(n.isSaved||(await this.saveCalculation({withoutNotify:!0,withoutName:!0}),i=!0),!n.isSaved)return alert("Ошибка привязки расчета. Пожалуйста, по возможности не закрывайте это окно и братитесь к разработчику"),console.error("При привязке не удалось сохранить расчет"),!1;n.isSaved&&!i&&await this.saveCalculation({resave:!0});const r={};r.calc_id=n.id,r.company_id="",r.contact_id="",r.agent_id="";for(let e in t)r[e]=t[e];return r.type="link_calc",e.post("php/save.php",r).then(async t=>{isNaN(Number(t.data))?(alert("Ошибка привязки расчета. Пожалуйста, по возможности не закрывайте это окно и братитесь к разработчику"),console.error(t.data)):(alert("Расчет привязан"),await n.loadLink())},t=>{console.error("Ошибка привязки расчета")})}),this.unexpectedSave=(async()=>{if("calculationActions"!==this.myFactory.matrixType)return!1;const t=document.querySelector("#inputSaveCalc");return!!t&&(""!==t.value&&" "!==t.value&&void(this.myFactory.calcObj.isSaved?this.myFactory.calcObj.name!==t.value&&await this.saveCalculation():await this.saveCalculation()))}),this.blurHandler=(t=>{""===t.currentTarget.value&&d(this.myFactory)}),"/calculation"===c.$$path&&this.loadMatrix("HIP.json")})},function(t,e){app.controller("loginCtrl",function(t,e,n,i,r){t.username="",t.password="",n.loggedIn=!1;const s=r.getAll(),o=(s,o)=>{if(0==n.loggedIn){let a={};a.login=t.username,a.pwd=t.password,s&&o&&(a.login=s,a.pwd=o),i.post("php/authorization.php",a).then(function(i){!0===i.data.loggin?(n.loggedIn=!0,e.path("/dashboard"),n.name=i.data.name,r.put("loggedIn",i.data.loggin),r.put("username",i.data.name),r.put("login",i.data.login),r.put("pwd",i.data.pwd),console.log(r)):(t.username="",t.password="")},function(t){console.log(t)})}};s.hasOwnProperty("login")&&s.hasOwnProperty("pwd")&&o(s.login,s.pwd),t.enter=function(){""==t.username||""!=t.password&&null!=t.password?""==t.password||""!=t.username&&null!=t.username?""!=t.password&&""!=t.username&&o():document.getElementById("username").focus():document.getElementById("password").focus()},t.submit=o})},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);app.controller("dashboardCtrl",function(t,e,n,s,o,a,l,c){this.span=1,this.myFactory=s;let u,h=this;this.search_params=[],this.isArray=angular.isArray,this.deleteProperty=function(t,e){delete t[e]},this.clickedOnTopOfDashboard=((t,e)=>{const n="Новый"===e.name;if(n)switch(t.name){case"Расчет":if(this.myFactory.parks.length>0)return!1;break;case"Полис":if(this.myFactory.makingPolis)return!1}if("Найти"===e.name&&"Расчет"===t.name&&this.myFactory.parks.length>0)return!1;switch("Найти"===e.name&&this.toggleMenu(!0),t.type){case"relocate_here":this.relocateHere(t.urlTo);break;case"relocatePage":n&&this.clearDataFromPage(t),this.relocatePage(t);break;case"reloadDashboard":this.reloadDashboard(t.json,t.matrix);break;case"text":case"currency":case"amount":case"risk":this.karetka.clicked(e,t);break;case"amountType":this.myFactory.changeAmountType();break;case"currencyValue":break;case"saveCalc":this.saveCalculation();break;case"polisProject":this.makePolisProject()}}),this.tooltip={title:"",fadeIn(t){let e=!1;"object"==typeof t?(this.title=t,e=!0):void 0!==risks[t]&&h.currObj.forEach(n=>{n.values.forEach(n=>{n.name==t&&void 0!==n.title&&(e=!0,t=n.title)})}),e&&(this.title=t,h.oldConfig=h.config,h.config="tooltip")},fadeOut(){this.title="",h.config=h.oldConfig,delete h.oldConfig}},this.Confirm=function(){this.karetka.mode="confirm refresh",u=a(function(){h.karetka.mode="listener"},4e3)},this.alert=function(t){alert(t)},this.console=console,this.isNaN=function(t){return isNaN(t)},this.clean=function(){this.tooltip.fadeOut();for(let t=0;t<h.currObj.length;t++){delete h.currObj[t].selected;for(let e=0;e<h.currObj[t].values.length;e++)delete h.currObj[t].values[e].selected,void 0!==h.currObj[t].values[e].oldValue&&(h.currObj[t].values[e].name=h.currObj[t].values[e].oldValue,delete h.currObj[t].values[e].oldValue),h.currObj[t].values[e].temporarily&&(h.currObj[t].values.splice(e,1),e--)}s.parkTemplate=[],s.multi.multies.forEach(function(t){delete t.changing,delete t.showRows,delete t.unselectable}),s.parks.forEach(function(t){delete t.changing,delete t.showRows,delete t.unselectable,t.processes.forEach(function(t){delete t.changing,delete t.showRows,delete t.unselectable})}),this.myFactory.document.clean(),this.myFactory.cleanProcess(),this.myFactory.multi.clean(),this.karetka.mode="listener",s.finalCalc()},this.isValue=function(t){let e=t.phone;return""!=e&&null!=e&&null!=e&&!isNaN(e)&&!angular.equals("",e)},this.isMulti=function(t){return t.contact.length>1},this.multiHeight=function(t){let e=100/t.length;return e="{height:"+e+"%;}"},this.reloadDashboard=function(t,n){"Компания"===t&&(t="HIP.json",n="HIP"),a.cancel(u),this.saveRes=12345,this.karetka.mode="listener",e.post(t).then(function(e){if(h.currObj=[],h.currObj=e.data,h.myFactory.currObj=e.data,"HIP.json"!=t)h.selectParam(0);else{let t=h.currObj.filter(function(t){return"Пакеты"==t.url});t=t[0],h.myFactory.packages=t.values,0!=s.parks.length?h.selectParam(""):(h.selectParam(0),h.karetka.mode="making new process")}h.myFactory.keyCodes.qwerty.length=h.currObj.filter(function(t){return null!=t.name}).length,h.navStyle="width:"+100/h.currObj.length+"%;",h.config=t,void 0!==n&&(h.myFactory.matrixType=n),console.log(s.parks)},function(t){console.log(t)})},this.config="dashboard.json",e.post("./src/dashboard.json").then(function(t){h.currObj=t.data,h.myFactory.keyCodes.qwerty.length=h.currObj.filter(function(t){return null!=t.name}).length,n.get("currentObj")&&(h.currObj=n.get("currentObj"),n.remove("currentObj")),h.selectParam(0)},function(t){console.log(t)}),this.relocatePage=function(t){this.myFactory.cameFrom={name:Object(r.getPathName)(l.$$path),path:l.$$path},"profile"!==t.urlTo||this.myFactory.companyObj.id||(t.urlTo="company"),l.path(`/${t.urlTo}`)},this.clearDataFromPage=function(t){"calculation"===t.urlTo&&this.myFactory.cleanCalculations(),"company"===t.urlTo&&(delete this.myFactory.newClientCard,this.myFactory.companyObj=new i.a)},this.relocateHere=function(t){for(let e=0;e<h.currObj.length;e++)h.currObj[e].url===t&&h.selectParam(h.currObj.indexOf(h.currObj[e]))},this.currentUl=function(t){if(t===h.myFactory.document.currParam)return!0},this.setCurrentUl=function(t){return transportProp.indexOf(t)},this.currentProcess={},this.selectParam=function(e){if(s.parkTemplate.length>0&&(s.parkTemplate=[]),this.currObj[e]&&void 0===this.currObj[e].name){let t=this.currObj[e].url;this.currObj.forEach(function(e,n){e.values.forEach(function(e){e.urlTo==t&&(s.document.selectedParam=n)})})}else s.document.selectedParam=e;this.myFactory.document.currParam=e,t.search_result=[]},this.selectNextParam=function(){let t=0;for(let e in s.process){if(""===s.process[e])return h.selectParam(t),!1;t++}return!0},this.checkTransportProp=function(t){return transportProp.indexOf(t)},this.configuration=function(t){if(1===t)return"navigation"===h.config},this.alreadySelected=function(e){return"calc"==t.mode&&!(""===s.process[e])},this.toggleMenu=function(t){const e=document.querySelector(".nav-back_container");if(!e)return!0;void 0===t&&e.classList.toggle("nav-back_container--hidden"),!1===t&&e.classList.aremovedd("nav-back_container--hidden"),!0===t&&e.classList.add("nav-back_container--hidden")},c.$on("$destroy",function(){s.removeCellSelection("dashboard_container",!0)}),c.isntEmpty=(t=>{for(let e in t)if(""!=t[e]&&"Форма организации"!=t[e]&&null!=t[e])return!0;return!1})})},function(t,e,n){"use strict";n.r(e);var i=n(4),r=n(2),s=n(3),o=n(5),a=n(0),l=n(1);app.controller("matrixCtrl",function(t,e,n,c,u){function h(){try{t.search_result=[]}catch(t){console.error(`Clear search results problem: ${t}`)}}this.deleteCalculation=function(n){let i=n.id;t.search_result.splice(t.search_result.indexOf(n),1);let r={type:"delete_calculation"};return r.id=i,e.post("php/save.php",r).then(function(t){"Успешно удалено"===t.data?console.log("calculation successfully deleted"):console.error("problem with deleting",t)},function(t){console.log(t)})},this.deleteRow=(t=>{let e=t.currentTarget;for(;!e.classList.contains("row-flex");)e=e.parentNode;e.parentNode.removeChild(e)}),this.deleteLink=(t=>{const i={id:t.id};return""===t.name?(this.deleteCalculation(t),i.type="delete_link"):i.type="delete_link_company",n.profileObj.deleteCalc(t.id),e.post("php/save.php",i).then(t=>{"OK"!==t.data&&console.error(t.data)},t=>{console.error(t)})}),this.loadCalculation=function(r){n.calcObj={},c(async function(){t.cacheTemplate={},"/calculation"!==u.$$path&&"/polis"!==u.$$path&&(n.cameFrom={path:u.$$path,name:Object(a.getPathName)(u.$$path)},u.path("/calculation"),await Object(a.delay)(200));const o=new s.a(!0);n.isLoading=o;let c={type:"load_calculation"};c.id=r;e.post("php/search.php",c).then(async function(t){n.matrixType="HIP",n.parks=[];let e=JSON.parse(t.data.processes);if(123==t.data.user_name){e.forEach(function(t){let e=[],i=[];t.processes.forEach(function(t){OLDBASENAMES.includes(t.risk)&&(t.risk=BASENAME);let n=new l.Process(t);for(let e in t)n[e]=t[e];n.loadedPrice=n.totalPrice,i.push(n),void 0!==t.multi&&-1==e.indexOf(t.multi)&&e.push(t.multi)});let r=new l.Park(i[0]);i.length>1&&r.processes.splice(0,1),n.choosePark(i,r,0);for(let e in t)"processes"!=e&&(r[e]=t[e]);if(n.parks.push(r),e.length>0)for(let t=0;t<e.length;t++){let i=r.processes.filter(function(n){return n.multi==e[t]});n.multi.multies.push(new l.Multi(i))}});let i=JSON.parse(t.data.mass);if(i.length>0&&n.multi.multies.length===i.length)for(let t=0;t<i.length;t++){let e=i[t];for(let i in e)n.multi.multies[t][i]=e[i]}if(""!==t.data.HIPname&&"Перевозчики"!==t.data){const e=n.karetkaTypes[t.data.HIPname];await Object(a.loadRisks)(e),n.HIPname=t.data.HIPname,n.scop.loadMatrix()}if(n.calculationName=t.data.name,n.finalCalc(),0!=t.data.a_limit&&t.data.a_limit!=n.a_limit.max_limit&&(n.a_limit.hand=!0,n.a_limit.value=1*t.data.a_limit,n.a_limit.type=t.data.a_limitType,n.applyAlimit(),n.finalCalc()),";Р"!=t.data.agents&&";%"!=t.data.agents){let e=t.data.agents.split(";");n.agents.mode=e[1],n.agents.val=1*e[0],n.finalCalc()}if(0!=t.data.payment&&t.data.payment!=n.payment.val&&(n.payment.hand=!0,n.payment.val=1*t.data.payment,n.finalCalc()),";Р"!=t.data.fact_premia&&";1"!=t.data.fact_premia){let e=t.data.fact_premia.split(";");n.practicalPrice.val=1*e[0],n.practicalPrice.koef=1*e[1],n.parks.forEach(function(t){t.applyPracticalPriceKoef("load")});let i=n.getTotal();n.practicalPrice.val=i-i%1,n.bottom.priceMode="practicalPrice",n.finalCalc()}else 0!=t.data.total_price&&Math.round(n.totalPrice)!=t.data.total_price&&(n.practicalPrice.val=1*t.data.total_price,n.practicalPrice.koef=n.practicalPrice.val/n.totalPrice,n.checkPracticalPriceKoef(!0),n.bottom.priceMode="practicalPrice",n.finalCalc())}else{let i={};for(let t in e)i[t]=e[t];let r=[];for(let t in i){let e=i[t];-1==r.indexOf(e.park)&&r.push(e.park),e.cost=e[1].split(" Р"),e.cost=1*e.cost[0],delete e[1],e.amount=e[2].split(" "),"Тягачей"==e.amount[1]?e.amount=24*e.amount[0]:e.amount=1*e.amount[0],delete e[2],e.wrapping=e[3],delete e[3],e.risk=e[4],delete e[4],OLDBASENAMES.includes(e.risk)&&(e.risk=BASENAME),e.limit=e[5].split(" Р"),e.limit=1*e.limit[0],delete e[5],e.franchise=e[6].split(" Р"),e.franchise=1*e.franchise[0],delete e[6],e.koef&&(e.practicalPriceKoef=e.koef,delete e.koef),delete e.stavka}e=JSON.parse(t.data.mass);let s={},o=[];e.forEach(function(t){if(""!=t.trs){t.trs=t.trs.split(";");for(let e=0;e<t.trs.length;e++)""==t.trs[e]&&t.trs.splice(t.trs.indexOf(t.trs[e]),1);t.multi&&void 0===s[t.multi]&&(s[t.multi]={},s[t.multi].processes=[]),t.package_name?(void 0===t.multi&&o.push({processes:[]}),t.trs.forEach(function(e){e=(e=e.split("tr_"))[1],i[e].package=t.package_name,t.multi&&-1==s[t.multi].processes.indexOf(e)?(s[t.multi].processes.push(e),i[e].multi=t.multi):(o[o.length-1].processes.push(e),i[e].packageNum=o.length-1)}),t.multi&&(s[t.multi].package=t.package_name)):t.trs.forEach(function(e){-1==e.indexOf("packageRow")&&(e=(e=e.split("tr_"))[1],-1==s[t.multi].processes.indexOf(e)&&(s[t.multi].processes.push(e),i[e].multi=t.multi))})}}),n.parks=[];for(let t=0;t<r.length;t++){let e=[];for(let n in i){let s=i[n];s.park==r[t]&&e.push(s)}let s=[];e.forEach(function(t){let e=new l.Process(t);void 0!==t.packageNum&&(e.packageNum=t.packageNum),void 0!==t.multi&&(e.multi=t.multi),void 0!==t.package&&(e.package=t.package),void 0!==t.koef&&(e.practicalPriceKoef=t.koef),s.push(e)});let o=new l.Park(s[0]);n.parks.push(o),s.splice(0,1),n.choosePark(s,o,0),console.log(n.parks)}if(void 0===n.packages){let t=await fetch("./src/HIP.json");t=(t=(t=await t.json()).filter(t=>"Пакеты"==t.url))[0].values,n.packages=t,console.warn("myFactory.packages загружен отдельно")}if(n.parks.forEach(function(t){t.processes.forEach(function(e){if(void 0!==e.packageNum){let i=e.packageNum,r=t.processes.filter(function(t){return t.packageNum==i}),s=e.package,o=n.packages.filter(function(t){return t.name==s});o=o[0].values,r.forEach(function(t){delete t.packageNum});let a=new l.Multi(r,s,o);n.multi.multies.push(a)}if(void 0!==e.multi){let i=e.multi,r=t.processes.filter(function(t){return t.multi==i}),s=0;if(r.forEach(function(t){t.package&&(s=t.package)}),s){let t=n.packages.filter(function(t){return t.name==s});t=t[0].values;let e=new l.Multi(r,s,t);n.multi.multies.push(e)}else{let t=new l.Multi(r);n.multi.multies.push(t)}}})}),""!==t.data.HIPname&&"Перевозчики"!==t.data){const e=n.karetkaTypes[t.data.HIPname];await Object(a.loadRisks)(e),n.HIPname=t.data.HIPname,n.scop.loadMatrix()}if(n.calculationName=t.data.name,n.finalCalc(),0!=t.data.a_limit&&t.data.a_limit!=n.a_limit.max_limit&&(n.a_limit.hand=!0,n.a_limit.value=1*t.data.a_limit,t.data.a_limit>10?n.a_limit.type="Агр. лимит":n.a_limit.type="Кол-во случаев",n.applyAlimit(),n.finalCalc()),"0 %"!=t.data.agents&&"0 Р"!=t.data.agents){let e=t.data.agents.split(" ");n.agents.mode=e[1],n.agents.val=1*e[0],n.finalCalc()}0!=t.data.payment&&t.data.payment!=n.payment.val&&(n.payment.hand=!0,n.payment.val=1*t.data.payment,n.finalCalc());let c=t.data.fact_premia.split(" Р");"undefined"!=c[0]?(n.practicalPrice.val=1*c[0],n.practicalPrice.koef=n.practicalPrice.val/n.totalPrice,n.checkPracticalPriceKoef(!0),n.bottom.priceMode="practicalPrice",n.finalCalc()):0!=t.data.total_price&&n.totalPrice!=t.data.total_price&&(n.practicalPrice.val=1*t.data.total_price,n.practicalPrice.koef=n.practicalPrice.val/n.totalPrice,n.checkPracticalPriceKoef(!0),n.bottom.priceMode="practicalPrice",n.finalCalc())}n.document.currParam="",h();const r=new i.a;r.parseFromMyFactory(n),r.parseFromResponse(t.data),r.markAsLoaded(),await r.loadLink(),n.isLoading.hide(),delete n.isLoading},function(t){console.log(t)})},0)},this.loadCompanyProfile=async function(t){n.cameFrom={name:Object(a.getPathName)(u.$$path),path:u.$$path},n.companyObj.id=t,u.path("/profile")},this.loadCompany=function(t,i){const s={type:"load_company"};return s.id=t,e.post("php/search.php",s).then(async t=>{const s=t.data;n.newClientCard=Object(o.a)(s);const l=new r.a;if(n.companyObj=l,l.parseFromCompaniesResponse(s),l.card=n.newClientCard,l.markAsLoaded(),await(()=>{const t=t=>Object(a.isNumeric)(t)?t:"1",i={legal_id:t(n.companyObj.responses.card.Legal_address),real_id:t(n.companyObj.responses.card.Real_address)},r=t=>Object.values(t).slice(1).filter(t=>""!==t).map(t=>t.trim());return i.type="addresses",("1"!==i.legal_id||"1"!==i.real_id)&&e.post("php/load.php",i).then(t=>{if(!Array.isArray(t.data))return console.error(t.data),!1;const e=t.data;if(n.companyObj.responses.adresses=e,"1"!==e[0].id){"0"===e[0].PostalCode&&delete e[0].PostalCode;const t=r(e[0]).join(", ");n.newClientCard["Доп. информация"]["Юридический адрес"]=t}if("1"!==e[1].id){"0"===e[1].PostalCode&&delete e[1].PostalCode;const t=r(e[1]).join(", ");n.newClientCard["Доп. информация"]["Фактический адрес"]=t}},t=>{console.error(t)})})(),i||(n.loadClient="Форма собственности",u.path("/company")),h(),"/"===u.$$path){this.loadCompanyProfile(n.companyObj.id);const t=document.querySelector(".mi_selected");t&&t.click()}},function(t){console.error(t)})},this.updateCalculation=function(t,r){let s=[];n.parks.forEach(function(t){let e={};for(let i in t)"processes"!=i?e[i]=t[i]:(e[i]=[],t.processes.forEach(function(t){let r={};for(let e in t)"multi"!=e&&"park"!=e?r[e]=t[e]:"multi"==e&&(r[e]=n.multi.multies.indexOf(t.multi));e[i].push(r)}));s.push(e)});const o=[];n.multi.multies.length>0&&n.multi.multies.forEach(function(t){let e={};for(let n in t)"processes"!=n&&(e[n]=t[n]);o.push(e)});const a={};try{a.parks=JSON.stringify(s)}catch{let t=window.CircularJSON;a.parks=t.stringify(s)}try{a.mass=JSON.stringify(o)}catch{let t=window.CircularJSON;a.mass=t.stringify(o)}return a.payment=n.payment.val,a.agents=n.agents.val+";"+n.agents.mode,a.practicalPrice=n.practicalPrice.val+";"+n.practicalPrice.koef,a.a_limit=n.a_limit.value,a.a_limitType=n.a_limit.type,a.totalAmount=n.totalAmount,a.totalPrice=n.totalPrice,a.HIPname=n.HIPname,a.type="update_calc",a.name=r,a.id=t,e.post("php/save.php",a).then(async function(t){if(isNaN(Number(t.data)))return alert("Ошибка при пересохранении расчета. Пожалуйста, по возможности не закрывайте окно и обратитесь к разработчику"),console.error(t.data),!1;const e=new i.a(n);e.parseFromResponse(a),e.isSaved=!0,n.calcObj=e,await e.loadLink(),n.calculationName=e.name,alert("Успешно пересохранено")},function(t){console.log(t)})},this.setCalculationNameAs=(t=>{const e=new Date;let n=e.getHours();n=n<10?`0${n}`:`${n}`;let i=e.getMinutes();i=i<10?`0${i}`:`${i}`,document.querySelector("#inputSaveCalc").value=`${t} ${n}:${i}`})})},function(t,e){app.controller("searchCtrl",function(t,e,n,i,r){this.myFactory=r,t.cacheTemplate={};let s=this;this.makeSearch=(t=>{this.isEmptyQuery(t.values)?this.isEmptyObject(this.template)?this.search(t.values,t.url):this.checkTemplate(t.values)?this.searchFilter(t.values):this.search(t.values,t.url):this.clean()}),this.searchForPolis=(async({type:e,value:n})=>{(""==n||n.length<=2)&&this.clean(),0==t.search_result.length&&(s.template={}),this.isEmptyObject(this.template)?await this.search([{model:"name",name:"Название",val:n}],e):this.checkTemplate([{model:"name",name:"Название",val:n}])?this.searchFilter([{model:"name",name:"Название",val:n}]):await this.search([{model:"name",name:"Название",val:n}],e)}),this.isEmptyObject=(t=>{for(let e in t)if(t.hasOwnProperty(e))return!1;return!0}),this.searchFilter=function(e){for(let n=0;n<e.length;n++){let i=e[n];""==i.val?t.cacheTemplate[i.model]=void 0:"contact"==i.model?(t.cacheTemplate.contact={},isNaN(i.val)?t.cacheTemplate.contact.name=i.val:t.cacheTemplate.contact.phone=i.val):t.cacheTemplate[i.model]=i.val}},this.template={},this.checkTemplate=function(t){let e;for(let n=0;n<t.length;n++)t[n].model===s.template.model&&(e=t[n],n=t.length);return!!e&&0==e.val.search(s.template.txt)},this.search=function(i,r){let o={};"Компания"==r?(o.type="find_company",i[0].db="companies"):o.type="calculationActions"==r?"find_calculation":"Оговорки и условия"==r?"find_addition":r,s.abort&&s.abort.resolve(),s.abort=n.defer();let a=this.isEmptyQuery(i);return o.value=a,!!a&&(s.template.txt=a.val,s.template.model=a.model,e.post("./php/search.php",o,{timeout:s.abort.promise}).then(function(e){if(s.myFactory.matrixType=r,t.cacheTemplate={},Array.isArray(e.data)&&e.data.reverse(),"Оговорки и условия"===r)return t.search_result=function(t,e){if(!Array.isArray(t))return console.error("expected array "+t),null;return t.map(t=>(t[e]=t[e].split("/CBL/"),t[e].pop(),t))}(e.data,"text"),!0;t.search_result=e.data,"Компания"!==r&&"find_company"!==r&&t.search_result.forEach(t=>{if(-1!==t.fact_premia.indexOf(" ")){let e=t.fact_premia.split(" ");"undefined"==e[0]||0==e[0]?delete t.fact_premia:t.fact_premia=e[0]}else if(-1!==t.fact_premia.indexOf(";")){let e=t.fact_premia.split(";");""==e[0]||0==e[0]?delete t.fact_premia:t.fact_premia=e[0]}})},function(t){null!==t.data&&console.log(t)}))},this.clean=function(){t.search_result=[],s.template={}},this.isEmptyQuery=function(t){let e={};return e.values=t,e.values.find(function(t){return""!=t.val&&null!=t.val&&t.val.length>1})}})},function(t,e,n){"use strict";app.controller("HIP",function(t,e,n,i){if(n.cacheTemplate={},this.myFactory=e,this.delete=function(t){if(t.multi&&(t.multi.multi&&t.multi.multi.processes.splice(t.multi.multi.processes.indexOf(t.multi),1),t.multi.processes.splice(t.multi.processes.indexOf(t),1),t.multi.processes.length<2)){let n;if(t.multi.prevMulti?n=t.multi.prevMulti:t.multi.multi&&(n=t.multi.multi),n){if(t.multi.processes[0].multi=n,!n.processes)throw new Error("Верхний мульти с другой структурой. Нет .processes");n.processes.push(t.multi.processes[0])}e.multi.multies.splice(e.multi.multies.indexOf(t.multi),1)}t.park.processes.length>1?t.park.processes.splice(t.park.processes.indexOf(t),1):e.parks.splice(e.parks.indexOf(t.park),1),e.finalCalc()},this.copy=function(t){let n=new Process(t);t.park.processes.splice(t.park.processes.indexOf(t)+1,0,n);for(let t in n)-1==transportProp.indexOf(t)&&"park"!=t&&"totalPrice"!=t&&delete n[t];return e.fixHeight(),n},this.myFactory.currObj)for(let t=0;t<this.myFactory.currObj.length;t++){let n=e.currObj;for(let e=0;e<n[t].values.length;e++)"risk"==n[t].values[e].type&&(risks[n[t].values[e].name]=n[t].values[e].value)}i.$on("$destroy",function(){e.cleanProcess(),n.mode=""}),this.consolelog=function(t){console.log(t)},n.mode="calc"})},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);app.controller("companyCtrl",function(t,e,n,s,o){if("/company"!==s.$$path)return!1;function a(){t.loadCompany||n.post("./src/new_company.json").then(async function(n){const i=n.data;for(const t in i)if("Контакты"==i[t].name||"Связи"==i[t].name||e.isntEmpty(e.clientCard[i[t].name])){if("Контакты"==i[t].name)for(const n in i[t].values)e.contact[i[t].values[n].name]=""}else{e.clientCard[i[t].name]={};for(const n in i[t].values)e.clientCard[i[t].name][i[t].values[n].name]=""}delete e.clientCard.ID,e.currObj=[],e.setEmptyCardParam(),e.currObj=n.data,await Object(r.delay)(50),void 0!==t.loadClient?(e.loadToDashboard(t.loadClient),delete t.loadClient):e.newDashboard.setCurrentPage(0)},function(t){console.log(t)})}e.myFactory=t,e.clientCard={},Object.assign(e.clientCard,e.myFactory.newClientCard),t.document.selectedParam="",t.document.currParam="",t.config="new_company.json",e.actions=!1,e.cardNotEmpty=!1,a(),e.$on("$destroy",function(){let t=!1;for(let n in e.clientCard)e.isntEmpty(e.clientCard[n])&&(t=!0);t&&(e.myFactory.newClientCard={},Object.assign(e.myFactory.newClientCard,e.clientCard))}),e.newDashboard={currentPage:0,previousPage:-1,toLeft(t){return this.previousPage<this.currentPage&&this.previousPage==t},toRight(t){return this.previousPage>this.currentPage&&this.previousPage==t},fromLeft(t){return this.previousPage>this.currentPage&&this.currentPage==t},fromRight(t){return this.previousPage<this.currentPage&&this.currentPage==t},checkCurrentPage(t){return t===this.currentPage},setCurrentPage(t){this.previousPage=this.currentPage,this.currentPage=t,e.loadToDashboard(e.currObj[t].values[0].name)},getIndex(t){this.setCurrentPage(e.clientCard.indexOf(t))}},e.keydownHandler=((t,n,i,r)=>{if("Enter"===t.keyCode||9===t.keyCode||13===t.keyCode&&"Контакты"!==n.name){t.preventDefault();const r=e.currObj;let s=r.findIndex(t=>t.name===n.name),o=n.values.findIndex(t=>t.name===i.name);if(o===n.values.length-1?(s++,o=0):o++,s>r.length-1)return;const a=r[s].values[o].name;e.loadToDashboard(a),e.setEmptyCardParam()}}),e.returnMode="changing",e.tooltip="",e.clean=(()=>{t.document.selectedParam="",t.document.currParam="",e.returnMode="listener"}),e.confirm=(()=>{e.returnMode="confirmRefresh",o(()=>{e.returnMode="listener"},2e3)});let l="";function c(t){return{Communications:"",INN:t["Реквизиты компании"]["ИНН"],KPP:t["Реквизиты компании"]["КПП"],Legal_address:t["Доп. информация"]["Юридический адрес"],OGRN:t["Реквизиты компании"]["ОГРН"],OKPO:t["Реквизиты компании"]["ОКПО"],OKVED:t["Реквизиты компании"]["ОКВЭД"],OrganizationFormID:function(t){if(""===t||void 0===t)return"";return Number({"ЗАО":"1","ООО":"2","ОАО":"3","ИП":"4"}[t])}(t["Данные компании"]["Форма организации"]),Real_address:t["Доп. информация"]["Фактический адрес"],bank:t["Банковские реквизиты"]["Банк"],bik:t["Банковские реквизиты"]["БИК"],company_group:"",company_mail:t["Доп. информация"]["Эл. почта"],company_phone:t["Доп. информация"]["Телефон"],company_url:"",general_director_passport:t["Генеральный директор"]["Серия и номер паспорта"],director_name:t["Генеральный директор"]["ФИО директора"],give_date:t["Генеральный директор"]["Когда выдан"],director_authority:t["Генеральный директор"]["Кем выдан"],director_birth_place:t["Продолжение"]["Место рождения"],director_address:t["Продолжение"]["Адрес регистрации"],id:"",k_account:t["Банковские реквизиты"]["к/счет"],name:t["Данные компании"]["Наименование организации"],r_account:t["Банковские реквизиты"]["р/счет"],registration_date:t["Данные компании"]["Дата регистрации"],status:"",who_registrate:t["Данные компании"]["Наименование рег. органа"]}}e.appendTooltip=((t,n)=>{l=e.returnMode,e.returnMode="tooltip",e.tooltip=t}),e.removeTooltip=(t=>{e.tooltip="",e.returnMode=l,l=""}),e.contacts=[],e.contact={clean(){for(const t in e.contact)e.contact[t]=""},isFull(){for(const t in e.contact)if(""==e.contact[t])return!1;return!0}},e.chooseContactFromSearchResult=(t=>{t.FirstName&&(e.contact["Имя"]=t.FirstName),t.LastName&&(e.contact["Фамилия"]=t.LastName),t.PatronicName&&(e.contact["Отчество"]=t.PatronicName),t.email&&(e.contact["Почта"]=t.email),t.phones&&(e.contact["Телефон"]=t.phones),e.searchResults=void 0}),e.loadToDashboard=(t=>{e.currObj.forEach((n,i)=>{n.values.forEach(({name:n},r)=>{n==t&&(e.newDashboard.currentPage!=i&&e.newDashboard.setCurrentPage(i),Array.from(document.querySelectorAll(".company_dashboard_inputs")).forEach(t=>{t.classList.remove("selected")}),Array.from(document.querySelectorAll("div.clientCard td")).forEach(e=>{e.classList.remove("mi_selected"),e.title==t&&e.classList.add("mi_selected")}),setTimeout(()=>{const t=document.querySelector(".ul_current").firstElementChild.children[r].firstElementChild;t.classList.add("selected"),t.focus()},100))})}),e.setEmptyCardParam()}),e.changeLocation=(t=>{e.myFactory.cameFrom={name:Object(r.getPathName)(s.$$path),path:s.$$path},e.myFactory.companyObj.id||(e.myFactory.companyObj=new i.a),e.myFactory.companyObj.card=e.clientCard,s.path(t)}),e.inputHandler=(t=>{}),e.swap=(t=>{e.actions=t}),e.isNavLightRed=(t=>{const n=e.clientCard[t];return e.isntEmpty(n)&&!contact.isFull(n)}),e.isntEmpty=(t=>{for(let e in t)if(""!=t[e]&&"Форма организации"!=t[e]&&null!=t[e])return!0;return!1}),e.consolelog=(t=>{console.log(t)}),e.checkCardIsEmpty=(()=>{return!document.querySelectorAll(".company_matrix_header:not(.company_matrix_header--red)").length}),e.setEmptyCardParam=(()=>{e.cardNotEmpty=!e.checkCardIsEmpty()}),e.reload=(()=>{e.myFactory.removeCellSelection("dashboard_container"),e.clientCard={},e.myFactory.companyObj=new i.a,delete e.myFactory.newClientCard,a()}),e.saveCompany=(()=>{if(e.checkCardIsEmpty())return!1;if(e.myFactory.companyObj&&e.myFactory.companyObj.isSaved)return e.updateCompany(),!1;const t=e.clientCard;if(""===t["Данные компании"]["Наименование организации"])return alert('Перед сохранением необходимо заполнить поле "Наименование организации"'),!1;const r=c(t);r.type="save_company",n.post("php/save.php",r).then(t=>isNaN(Number(t.data))?(console.error(`Problem with saving: ${t.data}`),void alert("При сохранении возникли неполадки. Обратитесь пожалуйста к разработчику")):(console.log(`saved company id ${t.data}`),alert("Карточка компании сохранена"),t.data),t=>{console.log(t)}).then(n=>{if(void 0===n)return!1;const s=new i.a;s.savedAs({id:n,card:t,savedObj:r}),e.myFactory.companyObj=s,s.factory=e.myFactory,e.addNewConnection("company_id",n)})}),e.addNewConnection=((t,i)=>{const r={company_id:0,contact_id:0,status:"",email:"",phone:"",end_date:"0000-00-00"};r[t]=i,r.type="new_connection",n.post("php/save.php",r).then(t=>isNaN(Number(t.data))?(console.error(`Problem with saving: ${t.data}`),void alert("При сохранении связи возникли неполадки. Обратитесь пожалуйста к разработчику")):(console.log(`connection saved with id ${t.data}`),t.data),t=>{console.error(t)}).then(t=>{if(void 0===t)return!1;e.myFactory.companyObj.connectionID=t})}),e.updateCompany=(async()=>{const t=Object.assign({},e.myFactory.companyObj.responses.card),i=c(e.clientCard),r=function(t,e){const n=["id","date","type","Communications","company_group","company_url"];""!==t.give_date&&"0000-00-00"!==t.give_date||""!==e.give_date&&"0000-00-00"!==e.give_date||n.push("give_date");""!==t.registration_date&&"0000-00-00"!==t.registration_date||""!==e.registration_date&&"0000-00-00"!==e.registration_date||n.push("registration_date");n.forEach(n=>{t[n]&&delete t[n],e[n]&&delete e[n]});const i={};for(const n in t)if(t.hasOwnProperty(n)){const r=t[n],s=e[n];r!=s&&(i[n]=r||"")}return i}(t,i),s=e.myFactory.companyObj.id;!Object.keys(r).length?alert("В карточке нет изменений"):(await function(t,i){const r={type:"update_company"};return r.card=t,r.id=i,n.post("php/save.php",r).then(t=>{"1"==t.data?(alert("Изменения сохранены"),console.log(`company updated; id ${t.config.data.id}`),e.myFactory.companyObj.responses.card=Object.assign({},t.config.data.card)):(alert("Проблемы с обновлением данных карточки компании. Пожалуйста, по возможности не закрывайте окно и обратитесь к разработчику"),console.error(t.data))},t=>{console.error(t)})}(Object.assign({},i),s),await function(t,e){const i={type:"save_company_changes"};return i.company_id=e,i.prev=t,n.post("php/save.php",i).then(t=>{"1"==t.data?console.log(`changes saved; id ${t.config.data.company_id}`):(alert("Проблемы с обновлением данных карточки компании. Пожалуйста, по возможности не закрывайте окно и обратитесь к разработчику"),console.error(t.data))},t=>{console.error(t)})}(r,s))})})},function(t,e){app.controller("polisEditorCtrl",function(t,e,n,i){if(""===e.polisCurrent||void 0===e.polisCurrent)return void n.path("/dashboard");t.myFactory=e,t.currObj=e.polisCurrent.values,t.delete=(e=>{""===e.text?t.currObj.splice(t.currObj.indexOf(e),1):e.checked=!1}),t.newValue="",t.addNewValue=(n=>{13==n.keyCode&&""!==t.newValue&&(e.polisCurrent.values.push({text:t.newValue,checked:!0}),t.newValue="")}),t.inputHandler=((e,n)=>{13===e.keyCode&&t.newDashboard.setCurrentPage(t.newDashboard.next(n))}),t.$on("$destroy",()=>{const e=[];t.currObj.forEach(t=>{""===t.text&&e.push(t)}),e.length>0&&e.forEach(e=>{t.currObj.splice(t.currObj.indexOf(e),1)})});let r=1;t.addNew=(e=>{t.currObj.splice(t.currObj.indexOf(e)+1,0,{text:"",checked:!0,name:`Доп. пункт ${r}`}),r++}),t.returnToPolis=(async()=>{const e=t.myFactory,i=e.polisCurrent,r=e.polisObj.conditions.findIndex(t=>t.$$hashKey===i.$$hashKey);""!==i.name&&0!==i.values.length||r>=0&&e.polisObj.conditions.splice(r,1),t.saveAddition(r),t.myFactory.cameFrom={name:"Редактор полиса",path:n.$$path},n.path("/polis")}),t.saveAddition=(e=>{const n=t.myFactory.polisCurrent;if(!n.isNew&&n.startName===n.name)return!1;if(""===n.name||0===n.values.length)return!1;const i=n.values.reduce((t,e,n)=>`${t}${e.text}/CBL/`,"");if(0===i.length)return!1;t.saveToDB(n,i,e)}),t.saveToDB=((e,n,r)=>{const s={type:"addition_save"};s.name=e.name,s.text=n,e.isNew=!1,i.post("./php/save.php",s).then(e=>{const n=e.data;NaN===Number.isNaN(Number(n))?console.error("ошибка сохранения оговорок "+e.data):(t.myFactory.polisObj.conditions[r].id=e.data,alert("Дополнение сохранено"))},t=>console.error(resp))}),t.newDashboard={TITLE_INDEX:-1,ADD_INDEX:()=>t.currObj.length,currentPage:null,previousPage:-1,toLeft(t){return this.previousPage<this.currentPage&&this.previousPage==t},toRight(t){return this.previousPage>this.currentPage&&this.previousPage==t},fromLeft(t){return this.previousPage>this.currentPage&&this.currentPage==t},fromRight(t){return this.previousPage<this.currentPage&&this.currentPage==t},next(e){const n=e+1;return n>t.currObj.length?e:n===t.currObj.length?this.ADD_INDEX:n},checkCurrentPage(t){return"add"===t&&(t=this.ADD_INDEX),"title"===t&&(t=this.TITLE_INDEX),t===this.currentPage},setCurrentPage(e){""===t.myFactory.polisCurrent.name.trim()&&(e="title"),!t.myFactory.polisCurrent.isNew&&null!==this.currentPage&&Number(this.currentPage)>this.TITLE_INDEX&&Number(this.currentPage)<this.ADD_INDEX()&&""===t.myFactory.polisCurrent.values[this.currentPage].text&&t.myFactory.polisCurrent.startName===t.myFactory.polisCurrent.name&&(e=this.currentPage),"add"===e&&(e=this.ADD_INDEX),"title"===e&&(e=this.TITLE_INDEX),this.previousPage=this.currentPage,this.currentPage=e,setTimeout(()=>document.querySelector(".input_polisEditor").focus(),400)},alreadySelected(t){switch(t){case 0:return e.companyObj.isFull;case 1:return e.parks.length>0;default:return!1}}},t.init=(()=>{t.newDashboard.setCurrentPage("title"),t.myFactory.polisCurrent.isNew||(t.myFactory.polisCurrent.startName=t.myFactory.polisCurrent.name)}),t.getCheckedConditions=(()=>t.currObj.filter(t=>t.checked).length),t.applyAddition=(()=>{if(!t.myFactory.polisObj.conditions.every(e=>e.name!==t.myFactory.polisCurrent.name))return!1;t.myFactory.polisObj.conditions.push(t.myFactory.polisCurrent)}),t.init()})},function(t,e,n){"use strict";n.r(e);var i=n(0);app.controller("financeCtrl",function(t,e,n,r){t.myFactory=r,t.init=(async()=>{0===t.myFactory.parks.length&&t.returnToDashboard();t.myFactory.payment.totalPrice=Object(i.addSpaces)(Math.round(t.myFactory.payment.totalPrice).toString()),t.checkDebtEqual(),await t.loadDashboard()}),t.loadDashboard=(()=>e.post("./src/finance.json").then(e=>{t.currObj=e.data},t=>{})),t.newDashboard={mode:"new",currentPage:t.myFactory.polisObj&&t.myFactory.polisObj.isSaved?0:2,previousPage:-1,currPayment:null,toLeft(t){return this.previousPage<this.currentPage&&this.previousPage==t},toRight(t){return this.previousPage>this.currentPage&&this.previousPage==t},fromLeft(t){return this.previousPage>this.currentPage&&this.currentPage==t},fromRight(t){return this.previousPage<this.currentPage&&this.currentPage==t},checkCurrentPage(t){return t===this.currentPage},async setCurrentPage(e){this.previousPage=this.currentPage,this.currentPage=e,await Object(i.delay)(),t.inputFocus(e)}},t.returnToDashboard=(()=>{t.myFactory.cameFrom={name:"Редактирование финансов",path:n.$$path},n.path("/polis")}),t.loadPayment=((e,n)=>{const i=t.newDashboard,r=t.myFactory;r.payment;if(!r.polisObj.isSaved&&n<2)return!1;i.mode="change",i.setCurrentPage(n),i.currPayment&&(i.currPayment.changing=!1),i.currPayment=e,e.changing=!0}),t.inputFocus=(t=>{let e;switch(t){case 0:e=document.querySelector("#input_date");break;case 1:e=document.querySelector("#input_price");break;case 2:e=document.querySelector("#input_debtDate");break;case 3:e=document.querySelector("#input_debt");break;default:return!1}e.focus()}),t.recalculateDebt=(()=>{const e=t.myFactory.payment,n=Object(i.intFromStr)(e.leftPrice);let r=0;const s=e.array.filter(t=>{if(t.manual&&(r+=Object(i.intFromStr)(t.debt)),!t.manual&&!t.payed)return!0}).length;if(0===s){const e=n-r+Object(i.intFromStr)(t.newDashboard.currPayment.debt);return t.newDashboard.currPayment.debt=Object(i.addSpaces)(e),t.newDashboard.currPayment.manual=!1,!1}let o=Math.round((n-r)/s);o=Object(i.addSpaces)(o),e.array.forEach(t=>{t.manual||t.payed||(t.debt=o)}),e.calcDebt=o,t.checkDebtEqual()}),t.checkDebtEqual=(()=>!1),t.switchManual=(e=>{const n=Object(i.intFromStr)(t.myFactory.payment.calcDebt),r=Object(i.intFromStr)(e.debt);Math.abs(n-r)>1&&(e.manual=!0)}),t.applyDebt=(e=>{""===e.debt&&(e.debt=0),t.switchManual(e),e.debt=Object(i.addSpaces)(e.debt),t.recalculateDebt()}),t.endChange=((e,n)=>{t.myFactory.payment;const i=t.newDashboard.currPayment;if(!i)return!1;switch(n){case"debt":t.applyDebt(i);break;case"price":t.applyPayment(i),t.recalculateDebt();break;case"debtDate":case"date":t.applyDate(i,n)}}),t.applyDate=((t,e)=>{const n=t[e];if(""===n)return!1;if(/\d{2}.\d{2}.\d{4}/.test(n))return!1;if(/\d{4}-\d{2}-\d{2}/.test(n)){const i=n.replace(/(\d{4})-(\d{2})-(\d{2})/,"$3.$2.$1");t[e]=i}}),t.applyPayment=(e=>{if(""===e.price)return!1;if("0"===e.price&&"0"!==e.debt&&!e.payed)return!1;const n=t.myFactory.payment,r=Object(i.intFromStr)(e.debt)-Object(i.intFromStr)(e.price);if(e.payed)return e.debt="0",t.recalculateLeft(),!0;if(e.debt="0",e.payed=!0,r<0)n.array.find(t=>{if(!t.payed&&!t.manul){let e=Object(i.intFromStr)(t.debt);return e+=r,e=Object(i.addSpaces)(e),t.debt=e,!0}});else if(r>0){const t={price:"0",date:"",debt:Object(i.addSpaces)(r),debtDate:e.debtDate,manual:!0},s=n.array.indexOf(e);n.array.splice(s+1,0,t)}t.recalculateLeft()}),t.recalculateLeft=(()=>{const e=t.myFactory.payment,n=e.array.reduce((t,e)=>t+Object(i.intFromStr)(e.price),0),r=e.totalPrice;let s=Object(i.intFromStr)(r);intLeft=s-n,e.leftPrice=Object(i.addSpaces)(intLeft),e.payed=Object(i.addSpaces)(n)}),t.setAsDebt=(e=>{t.myFactory.payment;const n=t.newDashboard.currPayment;switch(e){case"price":n.price=n.debt,t.applyPayment(n),t.recalculateDebt();break;case"date":n.date=n.debtDate,t.applyDate(n,e)}}),t.init()})},function(t,e,n){"use strict";n.r(e);class i{constructor(t){this.isSaved=!1,this.companyName=null,this.calcName=null,this.isInited=!1,this.isRequested=!1,this.multi=!0,this.additionsSeen=!1,this.financeSeen=!1,this.type="Перевозчики",this.dates={start:null,startDate:null,end:null,endDate:null,changes:[],time:"Год"},t&&this.bindMyFactory(t)}bindMyFactory(t){this.factory=t,this.updateNames()}updateNames(){const t=this.factory;""!==t.calculationName&&void 0!==t.calculationName?this.calcName=t.calculationName:t.calcObj.isLinked&&(this.calcName="привязанный"),t.newClientCard&&(this.companyName=t.newClientCard["Данные компании"]["Наименование организации"])}async loadConditions(t,e){let n;switch(t){case"Экспедиторы":n="polisConditions-conf";break;case"Перевозчики":n="polisConditions";break;default:return console.error("Ошибка загрузки оговорок. Ожидался Перевозчики или Экспедиторы, пришел "+t),!1}const i=await fetch(`./src/${n}.json`);return this.conditions=await i.json(),this.conditions.forEach(t=>{t.name!==BASENAME||e||t.values.forEach(t=>t.checked=!1),t.included=!1}),this.conditions}updateConditionsCheck(){if(!this.conditions)return!1;this.conditions.forEach(t=>{let e=0;t.values.forEach(t=>{t.checked&&e++}),t.chechedCount=e,t.delete=(t=>this.deleteAddition(t))})}deleteAddition(t){if(t.name===BASENAME||"Страхование по полису не распространяется на следующие грузы"===t.name||t.const)return!1;this.conditions=this.conditions.filter(e=>e.name!==t.name)}applyStartAdditions(){this.additions={0:[],1:[],2:[]}}}class r{constructor(){this.id=null,this.park=null,this.group={id:null,obj:null},this.data={model:null,autNumber:null,VIN:null,prodYear:null,startYear:null,endYear:null,type:null,risks:null}}setData(t){this.data=t}}class s{constructor(){this.id=null,this.cars=[]}add(t){this.cars.push(t),t.group.obj=this}}var o=n(0),a=n(6);app.controller("polisCtrl",function(t,e,n,l,c,u){function h(t){let e=t.getDate(),n=t.getMonth()+1;return e<10&&(e=`0${e}`),n<10&&(n=`0${n}`),`${e}.${n}.${t.getFullYear()}`}this.myFactory=t,l.myFactory=t,l.init=(async()=>{(()=>{if(!t.polisObj){const e=new i(t);t.polisObj=e}})(),t.polisObj.updateNames(),(()=>{""!==t.calculationName&&void 0!==t.calculationName?this.calculationName=t.calculationName:t.calcObj.isLinked?this.calculationName="привязанный":t.calcObj.isInited||(this.calculationName="не выбран"),t.newClientCard&&(this.companyName=t.newClientCard["Данные компании"]["Наименование организации"]),t.parks.forEach(t=>{t.processes.forEach(t=>{t.showCars=!1})})})(),(()=>{if(!1!==t.makingPolis)switch(t.makingPolis){case"Расчет":l.newDashboard.setCurrentPage(1);break;case"Компания":l.newDashboard.setCurrentPage(0)}t.makingPolis=!0})(),c.search_result||l.newDashboard.setCurrentPage(0),c.search_result&&(c.search_result=[]),t.polisObj.isInited=!0;const n=t.parks.some(t=>t.risks.includes(BASENAME));if(!t.polisObj||!t.polisObj.isRequested||!l.currObj||0===l.currObj.length){if(!t.polisObj.conditions&&t.parks.length>0){const e=t.calcObj.factory?t.calcObj.factory.HIPname:"Перевозчики";await t.polisObj.loadConditions(e,n),t.polisObj.additionsSeen=!0}await(()=>(t.polisObj.isRequested=!0,e.post("./src/polis.json").then(t=>{!Array.isArray(t.data)||t.data.length<1?(alert("Возникла ошибка при загрузке данных. Пожалуйста, по возможности не закрывайте окно и обратитесь к разработчику"),console.error(t)):l.currObj=t.data},t=>{console.log(t)})))()}t.calcObj.factory&&t.polisObj.type!==t.calcObj.factory.HIPname&&(t.polisObj.conditions&&delete t.polisObj.conditions,await t.polisObj.loadConditions(t.calcObj.factory.HIPname,n),t.polisObj.type=t.calcObj.factory.HIPname,t.polisObj.additionsSeen=!0),l.myFactory.polisObj.dates.start||l.myFactory.polisObj.dates.end||(()=>{const t=new Date;l.myFactory.polisObj.dates.start=h(t),l.myFactory.polisObj.dates.startDate=t,l.setEndByTime(t,l.myFactory.polisObj.dates.time)})(),t.polisObj.updateConditionsCheck(),"/calculation"===t.cameFrom.path&&t.parks.length>0&&l.updateState(),(()=>{if(!l.currObj)return!1;let e=0;if("Редактор полиса"===t.cameFrom.name)e=l.currObj.findIndex(t=>"Оговорки и условия"===t.name);else if("Редактирование финансов"===t.cameFrom.name)e=l.currObj.findIndex(t=>"Финансы"===t.name);else if("Расчет"===t.cameFrom.name)e=l.currObj.findIndex(t=>"Расчет"===t.name);else if("Редактор карты клиента"===t.cameFrom.name||"Карту клиента"===t.cameFrom.name)e=l.currObj.findIndex(t=>"Компания"===t.name);else if(t.companyObj.card)if(t.companyObj.isFull){const t=l.currObj.filter(t=>t.name).length;for(let n=0;n<t;n++)if(!l.newDashboard.alreadySelected(n)){e=n;break}}else e=0;else e=0;l.newDashboard.setCurrentPage(e)})()}),l.createCars=(()=>{const t=l.myFactory;t.parks.forEach(t=>{if(t.carGroup)return!1;let e=-1/0;t.processes.forEach(t=>{e=Math.max(e,t.amount/24)});const n=new s;n.park=t,t.carGroup=n;for(let i=0;i<e;i++){const e=new r;e.park=t,n.add(e)}t.processes.forEach(t=>{t.cars=[],t.showCars=!1,t.amount/24===e&&(t.isFull=!0);for(let e=0;e<t.amount/24;e++){const n=t.park.carGroup.cars[e];t.cars.push(n),n.selectorAutNumber=n.data.autNumber}}),t.processes.forEach(t=>{t.isFull||(t.carSelector="")})}),t.setCarsFromExcel=(async(t,e,n,i)=>{e.carGroup.cars.forEach((e,n)=>{const i=t[n];for(let t in i)e.data[t]=i[t];e.selectorAutNumber=e.data.autNumber});const r=document.querySelectorAll(".park")[n].querySelectorAll("li")[i].querySelector(".input_cars");r.focus(),await Object(o.delay)(50),r.blur()})}),l.updateSelectorAutNumber=(t=>{t.selectorAutNumber=t.data.autNumber}),l.changeCar=((t,e,n)=>{if(!e.selectorAutNumber)return e.selectorAutNumber=e.data.autNumber,!1;const i=n.find(t=>t.data.autNumber===e.selectorAutNumber),r=t.cars.indexOf(e);if(e.selectorAutNumber=e.data.autNumber,t.cars.includes(i)){const e=t.cars.indexOf(i);[t.cars[r],t.cars[e]]=[t.cars[e],t.cars[r]]}else t.cars[r]=i}),l.calcFinances=(()=>{if(0===t.parks.length||!t.polisObj.dates.start&&!t.polisObj.dates.end)return!1;if(t.payment.array){let e=!1;("string"==typeof t.payment.totalPrice?t.payment.totalPrice:Object(o.addSpaces)(Math.round(t.payment.totalPrice)))!==Object(o.addSpaces)(Math.round(t.totalPrice))&&(e=!0),(()=>{const t=l.myFactory.polisObj.dates,e=l.myFactory.payment.datesWhenCreated;let n=!1;for(let i in e)e[i]!==t[i]&&(n=!0);return n})()&&(e=!0),e&&t.payment.makeArray(t.totalPrice,t.polisObj.dates)}else t.payment.makeArray(t.totalPrice,t.polisObj.dates)}),l.returnToDashboard=(()=>{n.path("/")}),l.clicking=((e,n)=>{e.stopImmediatePropagation(),t.parks.forEach(t=>{t.processes.forEach(t=>{t.showCars=!1})}),n.showCars=!n.showCars}),l.console=(t=>{console.dir(l.itemsList.items1)}),l.showFilepickModal=(t=>{t.currentTarget.nextElementSibling.classList.toggle("select--hidden")}),l.changeLocation=(t=>{switch(l.myFactory.cameFrom={name:Object(o.getPathName)(n.$$path),path:n.$$path},t){case"Компания":n.path("/company");break;case"Расчет":n.path("/calculation");break;case"Оговорки и условия":l.myFactory.addNewPolisProperty(),u(()=>n.path("/polisEditor"),0);default:n.path(t)}}),l.loadAddition=(t=>{l.myFactory.polisObj.conditions;const e=[];t.text.forEach(t=>{const n={checked:!0};n.text=t,e.push(n)});const i={name:t.name,values:e,id:t.id,isNew:!1};t.type&&(i.type=t.type),l.myFactory.polisCurrent=i,u(()=>n.path("/polisEditor"),0)}),l.newDashboard={currentPage:null,previousPage:-1,toLeft(t){return this.previousPage<this.currentPage&&this.previousPage==t},toRight(t){return this.previousPage>this.currentPage&&this.previousPage==t},fromLeft(t){return this.previousPage>this.currentPage&&this.currentPage==t},fromRight(t){return this.previousPage<this.currentPage&&this.currentPage==t},checkCurrentPage(t){return t===this.currentPage},setCurrentPage(t){if(this.previousPage=this.currentPage,this.currentPage=t,2===t&&(l.myFactory.polisObj.additionsSeen=!0),3===t&&(l.myFactory.polisObj.datesSeen=!0),4===t&&l.calcFinances(),4===t&&l.myFactory.payment.array&&l.myFactory.payment.array.length>0&&(l.myFactory.polisObj.financeSeen=!0),c.search_result=[],!l.currObj)return!1;l.currObj.forEach(t=>{"search/create"==t.type&&(t.values[0].name="")}),l.currObj[t].values.forEach(t=>{"btn-switch"===t.type&&(t.selected=t.values[0],t.switch=(()=>{const e=t.values.indexOf(t.selected),n=e===t.values.length-1?0:e+1;t.selected=t.values[n]}))})},alreadySelected(e){switch(e){case 0:return t.companyObj.isFull;case 1:return t.parks.length>0;case 2:return t.polisObj.additionsSeen;case 3:return t.polisObj.dates.start&&t.polisObj.dates.end&&t.polisObj.datesSeen;case 4:return t.polisObj.financeSeen&&t.payment.array&&t.payment.array.length>0;default:return!1}},allSelected(){for(let t=1;t<5;t++)if(!l.newDashboard.alreadySelected(t))return!1;return!0}},l.loadProcess=((e,i)=>{t.loadProcess={process:e,key:i},t.cameFrom={name:"Проект документа",path:"/polis"},n.path("/calculation")}),l.loadClient=(e=>{t.loadClient=e}),this.makePDF=(()=>{if(!l.newDashboard.allSelected())return!1;(()=>new Promise((t,e)=>{const n=new XMLHttpRequest;n.addEventListener("readystatechange",()=>{4==n.readyState&&t(JSON.parse(n.responseText))}),n.open("GET","./src/HIP.json",!0),n.send()}))().then(e=>{let n=[];return e.forEach(({model:t,values:e})=>{"risk"==t&&e.forEach(t=>{void 0===t.action&&"risk"===t.type&&n.push(t)})}),(new a.PolisMaker).makePDF(t,n),null},function(t){console.error(t)})}),l.multiClicked=(()=>{const t=l.myFactory.polisObj;t.multi=!t.multi}),l.deleteAdditionFromDB=(t=>{if(t<3)return!1;const n={type:"addition_delete"};n.id=t,e.post("./php/save.php",n).then(e=>{"success"!==e.data?(alert("Ошибка удаления. Пожалуйста, по возможности не закрывайте окно и обратитесь к разработчику"),console.error(e.data)):c.search_result=c.search_result.filter(e=>e.id!==t)},t=>{console.error(t)})}),l.endChange=(t=>{const e=l.myFactory.polisObj.dates,n=t=>{return/(2[01][012][0-9])-(0?[1-9]|1[0-2])-(0?[1-9]|[12][0-9]|3[01])/.test(t)},i=t=>{return t.replace(/(\d+)-(\d+)-(\d+)/,"$3.$2.$1")},r=t=>{const e=t.match(/(\d+).(\d+).(\d+)/);return new Date(e[3],Number(e[2])-1,e[1])},s=l.currObj[l.newDashboard.currentPage].values.filter(t=>"btn-switch"===t.type&&"today"===t.control)[0],o=l.currObj[l.newDashboard.currentPage].values.filter(t=>"btn-switch"===t.type&&"time"===t.control)[0];switch(t){case"start":n(e.start)?(e.start=i(e.start),e.startDate=r(e.start),l.setEndByTime(e.startDate,e.time),s.selected=" "):(e.start=null,e.startDate=null);break;case"end":if(n(e.end)){if(e.end=i(e.end),e.endDate=r(e.end),e.endDate<e.startDate)return e.end=null,e.endDate=null,!1;o.selected=" ",o.name="Дата окончания: ",e.time="Вручную"}else e.end=null,e.endDate=null;break;default:return!1}}),l.setEndByTime=((t,e)=>{if(!t)return!1;const n=e=>{const n=new Date(t.getFullYear(),t.getMonth()+e,t.getDate()-1);l.myFactory.polisObj.dates.endDate=n,l.myFactory.polisObj.dates.end=h(n)};switch(e){case"Год":n(12);break;case"6 месяцев":n(6);break;case"Вручную":l.myFactory.polisObj.dates.time="Вручную";break;default:console.log(e)}}),l.keyHandler=((t,e,n)=>{if(13!==t.keyCode)return!1;if("dates"===e.type){const t=`#input_${n.control}`;document.querySelector(t).blur()}}),l.switchBtnClick=(t=>{const e=l.myFactory.polisObj.dates;t.switch(),"today"===t.control&&function(t){const e=t.values.indexOf(t.selected);let n=new Date;const i=n.getDate();n.setDate(i+e),l.myFactory.polisObj.dates.start=h(n),l.myFactory.polisObj.dates.startDate=n,l.setEndByTime(n,l.myFactory.polisObj.dates.time)}(t),"time"===t.control&&(e.time=t.selected,t.name="Срок: ",l.setEndByTime(e.startDate,e.time))}),l.loadCompanyProfile=async function(e){t.cameFrom={name:Object(o.getPathName)(n.$$path),path:n.$$path},t.companyObj&&t.companyObj.id?(t.companyObj.id=e,n.path("/profile")):l.changeLocation("Компания")},l.updateState=(async()=>{const e=t.parks.some(t=>t.risks.includes(BASENAME));await(async()=>{return new Promise(e=>{const n=setInterval(()=>{t.parks.length>0&&t.calcObj.isInited&&(clearInterval(n),e())},100)})})(),t.polisObj.conditions=[],await t.polisObj.loadConditions(t.calcObj.factory.HIPname,e),t.polisObj.type=t.calcObj.factory.HIPname,t.polisObj.additionsSeen=!0,t.polisObj.updateConditionsCheck(),t.parks.length>0&&l.createCars(),t.polisObj.datesSeen=!0,l.calcFinances(),t.polisObj.financeSeen=!0,t.polisObj.dates=t.polisObj.dates,console.log("state updated"),document.querySelector(".mi_selected").click()}),l.init()})},function(t,e,n){"use strict";n.r(e);var i=n(2);class r{constructor(){this.store={},this.factory=null}bindFactory(t){t.profileObj=this,this.factory=t}deleteCalc(t){this.store.calcLinks=this.store.calcLinks.filter(e=>e.calc_id!==t),this.store.calculations=this.store.calculations.filter(e=>e.id!==t)}}var s=n(3),o=n(5),a=n(0);app.controller("profileCtrl",function(t,e,n,l,c,u){t.myFactory=u;t.loadCalcLinks=function(t){const e={type:"company_calculations",model:"company_id"};return e.id=t,n.post("php/load.php",e).then(t=>{if(Array.isArray(t.data)){const e={},n=t.data.filter(t=>!e[t.calc_id]&&(e[t.calc_id]=!0,!0));return n.reverse(),n}alert("Возникли проблемы с загрузкой привязанных расчетов. Обратитесь к разработчику")},t=>{console.error(t)})},t.loadCompany=function(t){const r={type:"load_company"};return r.id=t,n.post("php/search.php",r).then(async t=>{const n=t.data;u.newClientCard=Object(o.a)(n);const r=new i.a;u.companyObj=r,r.parseFromCompaniesResponse(n),r.card=u.newClientCard,r.markAsLoaded(),function(){try{e.search_result=[]}catch(t){console.error(`Clear search results problem: ${t}`)}}()},function(t){console.error(t)})},t.loadCalculations=function(t){if(!Array.isArray(t))return console.error(`Ошибка формата:${typeof t} должкен быть array`),!1;if(0===t.length)return console.log("Нет расчетов"),!1;const e={type:"load_linked_calcs"};return e.ids=t.map(t=>t.calc_id),n.post("php/load.php",e).then(e=>Array.isArray(e.data)?(e.data.length!==t.length&&console.warn("Размер полученных данных не совпадает с запрошенными"),e.data):(alert("Проблема с загрузкой расчетов. Пожалуйста, по возможности не закрывайте это окно и обратитесь к разработчику"),console.error(e.data),null),t=>{console.error(t)})},t.loadAddresses=(()=>{const t=t=>Object(a.isNumeric)(t)?t:"1",e={legal_id:t(u.companyObj.responses.card.Legal_address),real_id:t(u.companyObj.responses.card.Real_address)},i=t=>Object.values(t).slice(1).filter(t=>""!==t).map(t=>t.trim());return("1"!==e.legal_id||"1"!==e.real_id)&&(e.type="addresses",n.post("php/load.php",e).then(t=>{if(!Array.isArray(t.data))return console.error(t.data),!1;const e=t.data;if(u.companyObj.responses.adresses=e,"1"!==e[0].id){"0"===e[0].PostalCode&&delete e[0].PostalCode;const t=i(e[0]).join(", ");u.newClientCard["Доп. информация"]["Юридический адрес"]=t}if("1"!==e[1].id){"0"===e[1].PostalCode&&delete e[1].PostalCode;const t=i(e[1]).join(", ");u.newClientCard["Доп. информация"]["Фактический адрес"]=t}},t=>{console.error(t)}))}),t.newDashboard={currentPage:0,previousPage:-1,toLeft(t){return this.previousPage<this.currentPage&&this.previousPage==t},toRight(t){return this.previousPage>this.currentPage&&this.previousPage==t},fromLeft(t){return this.previousPage>this.currentPage&&this.currentPage==t},fromRight(t){return this.previousPage<this.currentPage&&this.currentPage==t},checkCurrentPage(t){return t===this.currentPage},async setCurrentPage(e){t.myFactory;this.previousPage=this.currentPage,this.currentPage=e}},t.loadToDashboard=(e=>{t.currObj.forEach((n,i)=>{n.values.forEach(({name:n},r)=>{n==e&&(Array.from(document.querySelectorAll(".company_dashboard_inputs")).forEach(t=>{t.classList.remove("selected")}),Array.from(document.querySelectorAll("div.clientCard td")).forEach(t=>{t.classList.remove("mi_selected"),t.title==e&&t.classList.add("mi_selected")}),t.newDashboard.currentPage!=i&&t.newDashboard.setCurrentPage(i),setTimeout(()=>{const t=document.querySelector(".ul_current").firstElementChild.children[r].firstElementChild;t.classList.add("selected"),t.focus()},100))})})}),t.isntEmpty=(t=>{for(let e in t)if(""!=t[e]&&"Форма организации"!=t[e]&&null!=t[e])return!0;return!1}),t.relocate=(e=>{t.myFactory.cameFrom={name:Object(a.getPathName)(c.$$path),path:c.$$path},c.path(e)}),t.$on("$destroy",function(){t.myFactory.removeCellSelection("dashboard_container",!0)}),t.tooltip={title:"",fadeIn(t){""===t&&(t="Без названия"),this.title=t},fadeOut(){this.title=""}},t.myFactory.companyObj.id?async function(){const e=t.myFactory.companyObj.id;if(!e)return alert("Ошибка открытия клиента. Пожалуйста обратиетсь к разработчику"),!1;const i=new r;i.bindFactory(t.myFactory),await n.post("./src/profile-dashboard.json").then(e=>{t.currObj=e.data},t=>{console.error(t)});const o=new s.a;o.show(),await t.loadCompany(e),i.store.calcLinks=await t.loadCalcLinks(e);const a=await t.loadCalculations(i.store.calcLinks);a&&(a.sort((t,e)=>t.date<e.date?1:-1),i.store.calculations=(l=a,l?l.map(t=>{const e=t.fact_premia;let n=null;if(e&&";1"!==e){const t=e.search(";");t>=1&&(n=e.slice(0,t))}else n=t.total_price;return t.fact_premia=n,t}):[])),await t.loadAddresses(),o.hide();var l}():t.relocate("/")})}]);